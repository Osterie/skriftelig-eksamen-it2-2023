var debug=!1;function int(e){return parseInt(e)}function float(e){return parseFloat(e)}function random(){return Math.random()}function randint(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function randfloat(e,t){return Math.random()*(t-e)+e}function choice(e){return e[randint(0,len(e)-1)]}function range(e,t,n){for(var i=[],a=0,r=e;r<t;r+=n)i[a]=r,a+=1;return i}function sum(e){return sumListe(e)}function zeros(e){for(var t=[],n=0;n<e;n++)t[n]=0;return t}function ones(e){for(var t=[],n=0;n<e;n++)t[n]=1;return t}function values(e,t){for(var n=[],i=0;i<e;i++)n[i]=t;return n}function len(e){return e.length}function mean(e){return sum(e)/len(e)}function std(e,t=1){for(var n=mean(e),i=0,a=0;a<e.length;a++)i+=(n-Number(e[a]))**2;return sqrt(1==t?i/(e.length-1):i/e.length)}function linspace(e,t,n){for(var i=[],a=(t-e)/(n-1),r=0;r<n;r++)i[r]=e+r*a;return i}function abs(e){return Math.abs(e)}function min(e,t){var n=1e15;for(i=0;i<arguments.length;i++){var a=arguments[i];n=a.length>0?Math.min(n,minsteverdiListe(a)):Math.min(n,a)}return n}function max(e,t){var n=-1e15;for(i=0;i<arguments.length;i++){var a=arguments[i];n=a.length>0?Math.max(n,størsteverdiListe(a)):Math.max(n,a)}return n}function floor(e){return Math.floor(e)}function ceil(e){return Math.ceil(e)}function round(e,t=0){return Number(toFixed(e,t))}function toFixed(e,t=0){return parseFloat(e).toFixed(t)}function toExpo(e,t=2){return parseFloat(e).toExponential(t)}function partall(e){var t=int(e)/2,n=!1;return t==Math.round(t)&&(n=!0),n}function oddetall(e){return!partall(e)}function sqrt(e){return yverdi(e,function(e){return Math.sqrt(e)})}function qbrt(e){return yverdi(e,function(e){return Math.pow(e,1/3)})}function nrot(e,t){return yverdi(e,function(e){return Math.pow(e,1/t)})}function pow(e,t){return e**t}function pow10(e){return 10**e}function exp(e){return yverdi(e,function(e){return Math.pow(Math.E,e)})}function log10(e){if(e>0)return yverdi(e,Math.log10);if(e<=0){return yverdi(e,function(e){return-99999})}}function lg(e){return yverdi(e,Math.log10)}function ln(e){if(e>0)return yverdi(e,Math.log);if(e<=0){return yverdi(e,function(e){return-99999})}}function modulus(e,t){return e%t}function radians(e){return e*(Math.PI/180)}function degrees(e){return e*(180/Math.PI)}function sin(e){return yverdi(e,Math.sin)}function sinD(e){if(Number(e.length)){for(var t=[],n=0;n<e.length;n++)t[n]=radians(e[n]);return yr=yverdi(t,Math.sin),yr}return Math.sin(radians(e))}function cos(e){return yverdi(e,Math.cos)}function cosD(e){if(Number(e.length)){for(var t=[],n=0;n<e.length;n++)t[n]=radians(e[n]);return yr=[],yr=yverdi(t,Math.cos),yr}return Math.cos(radians(e))}function asin(e){return yverdi(e,Math.asin)}function asinD(e){if(Number(e.length)){yr=[],yr=yverdi(e,Math.asin),yd=[];for(var t=0;t<yr.length;t++)yd[t]=degrees(yr[t]);return yd}return degrees(Math.asin(e))}function acos(e){return yverdi(e,Math.acos)}function acosD(e){if(Number(e.length)){yr=[],yr=yverdi(e,Math.acos),yd=[];for(var t=0;t<yr.length;t++)yd[t]=degrees(yr[t]);return yd}return degrees(Math.acos(e))}function tan(e){return yverdi(e,Math.tan)}function tanD(e){if(Number(e.length)){for(var t=[],n=0;n<e.length;n++)t[n]=radians(e[n]);return yr=[],yr=yverdi(t,Math.tan),yr}return Math.tan(radians(e))}function atan(e){return yverdi(e,Math.atan)}function atanD(e){if(Number(e.length)){xr=[],xr=yverdi(e,Math.atan),yr=[];for(var t=0;t<e.length;t++)yr[t]=degrees(xr[t]);return yr}return degrees(Math.atan(e))}function PI(){return Math.PI}function E(){return Math.E}function fakultet(e){var t=1;if(e<0)return alert("fakultet: n kan ikke være negativ!"),-9999;if(0==e)return 1;for(var n=1;n<=e;n++)t*=n;return t}function nPr(e,t){var n=e;if(e<1||t<1||t>e)return alert("nPr - sjekk n og r i kallet"),-9999;for(var i=1;i<t;i++)n*=e-i;return n}function nCr(e,t){for(var n=1,i=e,a=t,r=1;r<=t;r++)n=n*i/a,i-=1,a-=1;return n}function regnut(uttrykk){try{return eval(uttrykk)}catch(e){return alert("Kunne ikke regne ut: "+uttrykk),-99999}}function yverdi(xverdi,f){var x;if(Number(xverdi.length)){for(var y=[],i=0;i<xverdi.length;i++)x=xverdi[i],y[i]=_f(xverdi[i]);return y}return _f(xverdi);function _f(x){return"string"==typeof f?eval(f):f(x)}}var _regOpt={precision:7};function regLineær(e,t){for(var n=[],i=0;i<e.length;i++)n.push([e[i],t[i]]);return regression.linear(n,_regOpt).equation}function regPolynom(e,t,n){for(var i=[],a=0;a<e.length;a++)i.push([e[a],t[a]]);return regression.polynomial(i,{precision:7,order:n}).equation}function regEksponential10(e,t){for(var n=[],i=0;i<e.length;i++)n.push([e[i],t[i]]);var a=regression.exponential(n,_regOpt).equation;return[a[0],a[1]*lg(Math.E)]}function regEksponential(e,t){var n;return[(n=regEksponentialE(e,t))[0],E()**n[1]]}function regEksponentialE(e,t){for(var n=[],i=0;i<e.length;i++)n.push([e[i],t[i]]);return regression.exponential(n,_regOpt).equation}function regPotens(e,t){for(var n=[],i=0;i<e.length;i++)n.push([e[i],t[i]]);return regression.pow(n,_regOpt).equation}function regLn(e,t){for(var n=[],i=0;i<e.length;i++)n.push([e[i],t[i]]);return regression.logarithmic(n,_regOpt).equation}function sorter(e){return sorterListe(e)}function gjennomsnitt(e){return gjennomsnittListe(e)}function median(e){var t,n;return(t=(n=sorterListe(e)).length/2)==Math.round(t)?(n[t-1]+n[t])/2:n[Math.floor(t)]}function typetall(e){for(var t=sorter(e),n=[t[0]],i=[],a=1;a<t.length;a++)t[a]!=n[n.length-1]&&n.push(t[a]);var r=[],o=0;i=zeros(n.length);for(var l=0;l<n.length;l++)o=tellTreffListe(e,n[l]),i[l]=o;for(var s=max(i),g=0;g<i.length;g++)i[g]==s&&r.push(n[g]);return 1==r.length?r[0]:r}function variasjonsbredde(e){return max(e)-min(e)}function varians(e,t=!1){var n,i;n=gjennomsnitt(e),i=0;for(var a=0;a<e.length;a++)i+=(e[a]-n)*(e[a]-n);return t?i/(e.length-1):i/e.length}function standardavvik(e,t=!1){return stdAvvik=Math.sqrt(varians(e,t)),stdAvvik}function kvartilbredde(e){var t,n,i,a,r=sorterListe(e,0),o=r.length,l=[],s=[];if(oddetall(o)){for(i=(o+1)/2-1,t=0;t<i;t++)l[t]=r[t];for(t=0,n=i+1;n<o;n++)s[t]=r[n],t+=1;return a=median(l),median(s)-a}for(i=o/2,t=0;t<i;t++)l[t]=r[t];for(t=0,n=i;n<o;n++)s[t]=r[n],t+=1;return a=median(l),median(s)-a}function v2dAdder(e,t){return[e[0]+t[0],e[1]+t[1]]}function v2dSubtraher(e,t){return[e[0]-t[0],e[1]-t[1]]}function v2dMultipliser(e,t){return[t*e[0],t*e[1]]}function v2dLengde(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function v2dNormaliser(e){var t=v2dLengde(e);return[e[0]/t,e[1]/t]}function v2dOrtogonal(e,t=!0){var n=[];return n=[e[1],-e[0]],t&&(n=v2dNormaliser(n)),n}function v2dSkalarprodukt(e,t){return e[0]*t[0]+e[1]*t[1]}function v2dVinkel(e,t){var n,i,a;return n=v2dLengde(e),i=v2dLengde(t),abs(n)<1e-6||abs(i)<1e-6?(print("v2dVinkel: En av vektorene er nullvektor"),-99999):(a=v2dSkalarprodukt(e,t)/(n*i),vinkel=degrees(acos(a)),vinkel)}function v2dRoter(e,t){var n=v2dVinkel(e,[1,0]),i=v2dLengde(e),a=[];return a[0]=i*cosD(n+t),a[1]=i*sinD(n+t),a}function v2dPrint(e,t,n=2){print(e,"["+avrund(t[0],n)+","+avrund(t[1],n)+"]")}function input(e,t=""){return prompt(e,t)}function print(){for(var e="",t=0;t<arguments.length;t++)e=e+" "+arguments[t];htmlMelding(e)}function printListe(e,t,n=2){for(var i=e+" { ",a=0;a<t.length;a++)Number(t[a])?i+=round(t[a],n):i+=t[a],a<t.length-1&&(i+=",");print(i+=" }")}function clearprint(){htmlMeldingSlett()}function bekreftboks(e){return confirm(e)}function meldingsboks(e){return alert(e)}function inputboks(e,t=""){return prompt(e,t)}var mpAutox=!0,mpAutoy=!0,pyjs={xlim:[99999,-99999],ylim:[99999,-99999],title:"",xtekst:"x-akse",ytekst:"y-akse",label:"",legend:"",x:[],y:[]},pyplot={num:-1,grafx:[],grafy:[],label:[],farge:["red","blue","green","orange","yellow","magenta"]},pysplot=-1;function _mpreset(){mpAutox=!0,mpAutoy=!0,pyjs={xlim:[99999,-99999],ylim:[99999,-99999],title:"",xtekst:"x-akse",ytekst:"y-akse",label:"",legend:"",x:[],y:[]},pyplot={num:-1,grafx:[],grafy:[],label:[],farge:["red","blue","green","orange","yellow","magenta"]}}function xlim(e,t){tegnBrukXområde(e,t),pyplot.num=-1,mpAutox=!1,pyjs.xlim[0]=e,pyjs.xlim[1]=t}function ylim(e,t){tegnBrukYområde(e,t),mpAutoy=!1,pyjs.ylim[0]=e,pyjs.ylim[1]=t}function plot(e,t,n="graf"){pyjs.x=e,pyjs.y=t,pyplot.num=pyplot.num+1,pyplot.grafx[pyplot.num]=e,pyplot.grafy[pyplot.num]=t,pyplot.label[pyplot.num]=n,mpAutox&&(xmin=tegnFinnMinste(e),xmax=tegnFinnStørste(e),pyjs.xlim[0]=min(xmin,pyjs.xlim[0]),pyjs.xlim[1]=max(xmax,pyjs.xlim[1])),mpAutoy&&(ymin=tegnFinnMinste(t),ymax=tegnFinnStørste(t),pyjs.ylim[0]=min(ymin,pyjs.ylim[0]),pyjs.ylim[1]=max(ymax,pyjs.ylim[1]))}function show(){0==pysplot&&tegnBrukBakgrunn(),tegnBrukXområde(pyjs.xlim[0],pyjs.xlim[1]),tegnBrukYområde(pyjs.ylim[0],pyjs.ylim[1]),tegnAkser(pyjs.xtekst,pyjs.ytekst);for(var e=0;e<=pyplot.num;e++){tegnKurve(pyplot.grafx[e],pyplot.grafy[e],pyplot.farge[e]),tegnTekst(pyplot.label[e],pyplot.grafx[e][pyplot.grafx[e].length-1],pyplot.grafy[e][pyplot.grafy[e].length-1],pyplot.farge[e],0,"right")}pyplot.num=0,tegnTittel(pyjs.title),pyplot.num=-1,_mpreset()}function title(e){pyjs.title=e}function xlabel(e){pyjs.xtekst=e}function ylabel(e){pyjs.ytekst=e}function legend(){pyjs.legend=pyjs.label}function axhline(e,t){tegnYlinje(e,t)}function axvline(e,t){tegnXlinje(e,t)}function grid(){tegnRutenett()}function subplot(e,t,n){var i,a,r=e,o=t,l=1/o,s=1/r;pysplot+=1,index=n,ind=0;for(var g=1;g<r+1;g++)for(var d=1;d<o+1;d++)ind++,ind==index&&(i=g,a=d);var u=l*(a-1),f=1-s*i;tegnBrukSynsfelt(u+.1,u+l-.1,f+.1*.8,f+s-.1*.8);tegnHentXY()}function savefig(){print("Matplotlib savefig foreløpig ikke støtta i Fusion")}function rc(){print("Matplotlib rc foreløpig ikke støtta i Fusion")}function skriv(){for(var e="",t=0;t<arguments.length;t++)e=e+" "+arguments[t];htmlMelding(e),console.log(e)}function slettmeldinger(){htmlMeldingSlett()}function tabellrad(){for(var e="",t=1;t<arguments.length;t++)e=e+" "+String(arguments[t]).padStart(arguments[0][t-1]," ");htmlMelding(e)}function lesinn(e,t=""){input(e,t)}function lesheltall(e,t=""){return int(input(e,t))}function lesflyttall(e,t=""){return float(input(e,t))}function lagliste(e){for(var t=[],n=0;n<e;n++)t[n]=0;return t}function listelengde(e){return e.length}function heltall(e){return int(e)}function desimaltall(e){return float(e)}function tekst(e){return String(e)}function avrund(e,t=0){return Number(e.toFixed(t))}function avrundNed(e){return Math.floor(e)}function avrundOpp(e){return Math.ceil(e)}function minstAv(e,t){return Math.min(e,t)}function størstAv(e,t){return Math.max(e,t)}function tilfeldigtall(e=0,t=10,n=0){var i;return 0===n?i=randint(e,t):1===n?i=randfloat(e,t):(console.log("Feil i tilfeldigtall: ulovlig type"),i=-9999),i}function listeTilfeldigtall(e,t=0,n=10,i=0){for(var a=[],r=1;r<=e;r++)a[r-1]=tilfeldigtall(t,n,i);return a}function minsteverdiListe(e){var t;t=Number(e[0]);for(var n=1;n<=e.length;n++)e[n-1]<t&&(t=Number(e[n-1]));return t}function størsteverdiListe(e){var t;t=Number(e[0]);for(var n=1;n<=e.length;n++)e[n-1]>t&&(t=Number(e[n-1]));return t}function sumListe(e){for(var t=0,n=1;n<=e.length;n++)t+=Number(e[n-1]);return t}function gjennomsnittListe(e){return sumListe(e)/e.length}function treffListe(e,t,n=1e-5){for(var i=0,a=1;a<=e.length;a++)Math.abs(t-e[a-1])<=n&&(i+=1);return i}function sorterListe(e,t=0){return 0==t&&e.sort(function(e,t){return e-t}),1==t&&e.sort(function(e,t){return t-e}),e}function finnIndeks(e,t,n=1e-5){for(var i=0;i<e.length;i++)if(Math.abs(t-e[i])<n)return i;return-1}function listGetIndex(e,t){for(var n=999999,i=-1,a=0;a<len(e);a+=1)n>abs(t-e[a])&&(n=abs(t-e[a]),i=a);return i}function listMerge(e,t){var n=[];numlists=arguments.length;for(var i=0;i<arguments.length;i++)for(var a=0;a<arguments[i].length;a++)n.push(arguments[i][a]);return n}function listMultiply(e,t){var n=[];elements=Math.min(e.length,t.length);for(var i=0;i<elements;i++)n.push(Number(e[i])*Number(t[i]));return n}function listDivide(e,t){var n=[];elements=Math.min(e.length,t.length);for(var i=0;i<elements;i++)n.push(Number(e[i])*Number(t[i]));return n}function listSummation(e,t){var n=[];elements=Math.min(e.length,t.length);for(var i=0;i<elements;i++)n.push(Number(e[i])+Number(t[i]));return n}function listSubtraction(e,t){var n=[];elements=Math.min(e.length,t.length);for(var i=0;i<elements;i++)n.push(Number(e[i])-Number(t[i]));return n}function listScale(e,t){for(var n=[],i=0;i<e.length;i++)n.push(Number(e[i])*t);return n}function listShift(e,t){for(var n=[],i=0;i<e.length;i++)n.push(Number(e[i])+t);return n}function listAddUnique(e,t){return e.includes(t)||e.push(t),e}function listReverse(e){for(var t=[],n=e.length-1;n>-1;n--)t.push(e[n]);return t}function listToNumber(e){for(var t=[],n=e.length-1;n>-1;n--)t.push(Number(e[n]));return t}function listSublist(e,t,n){var i=[];if(1==arguments.length)return i=e;2==arguments.length&&(endInd=e.length-1),3==arguments.length&&(endInd=n),endInd=max(endInd,t),endInd=min(endInd,e.length-1);for(var a=t;a<=endInd;a++)i.push(e[a]);return i}function listSortNumbUp(e){return e.sort(function(e,t){return e-t})}function listSortNumbDown(e){return e.sort(function(e,t){return t-e})}function arange(e,t,n){for(var i=[],a=0,r=e;r<t;r+=n)i[a]=r,a+=1;return i}function liste(e){return lagliste(e)}function array(e){return e}function dot(e,t){for(var n=0;n<e.length;n++)e[n]*t[n]}function str(e){return String(e)}function string(e){return String(e)}function sleep(e){for(var t=(new Date).getTime()/1e3,n=t;Math.abs(t-n)<e;)n=(new Date).getTime()/1e3}function uniform(e,t){return randfloat(e,t)}function vistegning(){id("tegneflate")&&(id("tegneflate").style.visibility="visible"),id("tegneflate")&&(id("tegneflate").style.display="inline"),id("cbTegneflate")&&(id("cbTegneflate").checked=!0)}function start(){skriv("Fusion starter...")}function avslutt(){skriv("Fusion avsluttet :-) !")}function literal(expression){var words=expression.split(":");if(!(words.length>=2))return eval(expression);if(words[1].indexOf("f")>=0){words[1]=words[1].replace("f",""),words[1]=words[1].replace(".","");var value=eval(words[0]),desimals=Number(words[1]);return toFixed(value,desimals)}if(words[1].indexOf("e")>=0){words[1]=words[1].replace("e",""),words[1]=words[1].replace(".","");var value=eval(words[0]),desimals=Number(words[1]);return toExpo(value,desimals)}}var konsollId="meldinger",tegn;function print(){for(var e="",t=0;t<arguments.length;t++)e=e+" "+arguments[t];htmlMelding(e)}function clearprint(){htmlMeldingSlett()}function htmlMelding(e){var t;document.getElementById(konsollId)?(t=document.getElementById(konsollId).value).length<2?document.getElementById(konsollId).value=e+"\n":document.getElementById(konsollId).value=t+e+"\n":console.log(e)}function htmlMeldingSlett(){document.getElementById(konsollId)&&(document.getElementById(konsollId).value="")}function format(e,t){var n=t;return t.indexOf("f")>=0||t.indexOf("F")>=0?(n=(n=(n=n.replace("f","")).replace("F","")).replace(".",""),toFixed(e,parseInt(n))):t.indexOf("e")>=0||t.indexOf("E")>=0?(n=(n=(n=n.replace("e","")).replace("E","")).replace(".",""),toExpo(e,parseInt(n))):e}function tellTreffListe(e,t,n=.001){for(var i=0,a=0;a<e.length;a++)Math.abs(e[a]-t)<n&&(i+=1);return i}var dialog={};function tegnTilbakestill(){tegnBrukBakgrunn("white"),tegnBrukSynsfelt(.1,.9,.1,.9),tegnBrukXY(-10,10,-10,10),tegn.modus=1,tegnFlyttTil(0,0)}function tegnBrukBakgrunn(e="white"){tegn.logg_tegne&&console.log("tegnBrukBakgrunn",e);var t=tegn.modus;tegn.modus=0,tegnBrukOmråde(tegn.nx1,tegn.nx2,tegn.ny1,tegn.ny2),tegnFyltRektangel(0,tegn.canvas.height,tegn.canvas.width,tegn.canvas.height,e),tegn.modus=t,tegn.fargeBakgrunn=e}function tegnBrukXY(e,t,n,i){tegnBrukXområde(e,t),tegnBrukYområde(n,i)}function tegnBrukXområde(e,t){tegn.logg_tegne&&console.log("tegnBrukXområde",e,t),tegn.Vx1=e,tegn.Vx2=t}function tegnBrukYområde(e,t){tegn.logg_tegne&&console.log("tegnBrukYområde",e,t),tegn.Vy1=e,tegn.Vy2=t}function tegnBrukVerdier(e,t,n,i=!1){for(var a=e(t+1e-6),r=e(n-1e-6),o=t+1e-6;o<=n-1e-6;o+=(n-t-2e-6)/200)a=min(a,e(o)),r=max(r,e(o));return tegnBrukYområde(a-=.05*(r-a),r+=.05*(r-a)),i&&tegnBrukXområde(t,n),[a,r]}function tegnBrukDatasett(e,t){tegnBrukXY(tegnFinnMinste(e),tegnFinnStørste(e),tegnFinnMinste(t),tegnFinnStørste(t))}function tegnBrukSynsfelt(e,t,n,i){tegn.logg_tegne&&console.log("tegnBrukOmråde",e,t,n,i);var a=tegn.canvas.width,r=tegn.canvas.height;tegn.Cx1=e*a,tegn.Cx2=t*a,tegn.Cy1=r-i*r,tegn.Cy2=r-n*r,tegn.nx1=e,tegn.nx2=t,tegn.ny1=n,tegn.ny2=i,tegn.pennFarge="green",tegn.pennType="strek",tegn.pennBredde=1,tegn.pennPosX=0,tegn.pennPosY=0}function tegnBrukPenn(e,t="strek",n=1){tegn.pennFarge=e,tegn.pennType=t,tegn.pennBredde=n}function tegnFlyttTil(e,t){tegn.pennPosX=e,tegn.pennPosY=t}function tegnStrekTil(e,t){tegnLinjestykke(tegn.pennPosX,tegn.pennPosY,e,t,tegn.pennFarge,tegn.pennType,tegn.pennBredde),tegn.pennPosX=e,tegn.pennPosY=t}function tegnFlyttRelativt(e,t){tegn.pennPosX=tegn.pennPosX+e,tegn.pennPosY=tegn.pennPosY+t}function tegnStrekRelativt(e,t){tegnLinjestykke(tegn.pennPosX,tegn.pennPosY,tegn.pennPosX+e,tegn.pennPosY+t,tegn.pennFarge,tegn.pennType,tegn.pennBredde),tegn.pennPosX=tegn.pennPosX+e,tegn.pennPosY=tegn.pennPosY+t}function tegnLinjestykke(e,t,n,i,a="black",r="strek",o=1){var l=[];"punkter"==r&&(l=[2,2]),"stiplet"==r&&(l=[9,3]),tegn.logg_tegne&&console.log("tegnLinjestykke",e,t,n,i),tegn.ctx.beginPath(),tegn.ctx.strokeStyle=brukFarge(a),tegn.ctx.setLineDash(l),tegn.ctx.lineWidth=o,tegn.ctx.moveTo(tegn.px(e),tegn.py(t)),tegn.ctx.lineTo(tegn.px(n),tegn.py(i)),tegn.ctx.stroke(),tegn.ctx.lineWidth=1,tegn.ctx.setLineDash([])}function tegnKurve(e,t,n="black",i="strek",a=1){var r=e.length-1,o=t.length-1;tegn.logg_tegne&&console.log("tegnKurve",e[0],t[0],"....",e[r],t[o]),tegn.ctx.beginPath(),tegn.ctx.strokeStyle=brukFarge(n);for(var l=1;l<e.length;l++)tegnLinjestykke(e[l-1],t[l-1],e[l],t[l],n,i,a)}function tegnTekst(e,t,n,i="black",a=0,r="left",o=16,l="Calibri",s="bottom"){tegn.logg_tegne&&console.log("tegnTekst",e,t,n,a,"grader"),tegn.ctx.font=o+"px "+l,tegn.ctx.fillStyle=brukFarge(i),tegn.ctx.textAlign=r,tegn.ctx.textBaseline=s,tegn.ctx.save();var g,d,u;d=(g=tegn.pxy(t,n))[0],u=g[1],tegn.ctx.translate(d,u),tegn.ctx.rotate(-a*Math.PI/180),tegn.ctx.translate(-d,-u),tegn.ctx.fillText(e,d,u),tegn.ctx.restore()}function tegnTall(e,t,n,i=0,a="black",r=0,o="left",l=16,s="Calibri",g="bottom"){tegn.logg_tegne&&console.log("tegnTall",e,t,n,i,r,"grader"),tegnTekst(String(e.toFixed(i)),t,n,a,r,o,l,s,g)}function tegnPolygon(e,t,n="black",i="strek",a=1){var r=e.length-1,o=t.length-1;tegn.logg_tegne&&console.log("tegnKurve",e[0],t[0],"....",e[r],t[o]),tegn.ctx.beginPath(),tegn.ctx.strokeStyle=brukFarge(n);for(var l=1;l<e.length;l++)tegnLinjestykke(e[l-1],t[l-1],e[l],t[l],n,i,a);var s=e.length-1;tegnLinjestykke(e[s],t[s],e[0],t[0],n,i,a)}function tegnFyltPolygon(e,t,n="red"){var i=e.length-1,a=t.length-1;tegn.logg_tegne&&console.log("tegnFyltPolygon",e[0],t[0],"....",e[i],t[a]),tegnFyltOmråde(e,t,n)}function tegnMarkør(e,t,n="x",i="red",a=14){var r=a;if(tegn.logg_tegne&&console.log("tegnMarkør",e,t,n,i,a),"sirkel"==n)tegnFyltSirkel(e,t,r/2,i);else if("kvadrat"==n){var o,l,s=[],g=[];s=tegn.vxy(0,0),g=tegn.vxy(r,0),o=Math.abs(g[0]-s[0]),s=tegn.vxy(0,0),g=tegn.vxy(0,r),tegnFyltRektangel(e-.5*o,t-.5*(l=Math.abs(g[1]-s[1])),o,l,i)}else tegnTekst(n,e,t,i,0,"center",a,"Arial","middle")}function tegnMarkørliste(e,t,n="x",i="red",a=14){for(var r=0;r<e.length;r++)tegnMarkør(e[r],t[r],n,i,a)}function tegnSpikerliste(e,t,n=0,i="green",a="red",r=2){for(var o=0;o<e.length;o++)t[o]>=n?farge=i:farge=a,tegnLinjestykke(e[o],n,e[o],t[o],farge,"strek",r)}function tegnPil(e,t,n,i,a="red"){tegnBrukPenn(a),tegnFlyttTil(e,t),tegnStrekTil(n,i);var r=i-t,o=v2dVinkel([n-e,i-t],[1,0]);r>=0&&(o+=90),r<0&&(o=90-o),tegnTekst("V",n,i,a,o,"center",18,"Calibri","alphabetic"),tegnFlyttTil(n,i)}function tegnMelding(e,t="melding"){var n="#F4976C";"melding"===t&&(n="lightyellow"),"observer"===t&&(n="lightyellow"),"advarsel"===t&&(n="orange"),"feil"===t&&(n="red");var i,a,r=tegn.modus;tegn.modus=0,tegnKlipping(!1),tegnFyltRektangel(0,i=tegn.canvas.height,a=tegn.canvas.width,20,n),tegnRektangel(0,i,a,20,"grey"),tegnLinjestykke(0,i,0+a,i,"black"),tegnLinjestykke(0+a,i,0+a,i-20,"black"),tegnTekst(e,3,tegn.canvas.height-2,"black",0,"left",16,"Calibri"),tegn.modus=r}function tegnHentXY(){return[tegn.Vx1,tegn.Vx2,tegn.Vy1,tegn.Vy2]}function tegnHentXYN(){return[tegn.nx1,tegn.nx2,tegn.ny1,tegn.ny2]}function tegnFinnStørste(e){for(var t=-9999999,n=0;n<e.length;n++)t<Number(e[n])&&(t=Number(e[n]));return t}function tegnFinnMinste(e){for(var t=9999999,n=0;n<e.length;n++)t>Number(e[n])&&(t=Number(e[n]));return t}function tegnVisLogg(e){tegn.logg_tegne=e}var bildenavn=[],bildeobj=[],bildeklar=[];function tegnBildeFraFil(e,t,n,i=1,a=1,r=0){for(var o,l,s=!1,g=0;g<bildenavn.length;g++)if(e==bildenavn[g]){s=!0,o=bildeobj[g],l=g;break}function d(){var e=tegn.px(t),s=tegn.py(n),g=e-.5*o.width,d=s-.5*o.height;o.style.visibility="hidden",bildeklar[l]=!0,tegn.ctx.save(),tegn.ctx.translate(e,s),tegn.ctx.rotate(-r*Math.PI/180),tegn.ctx.scale(i,a),tegn.ctx.translate(-e,-s),tegn.ctx.drawImage(o,g,d),tegn.ctx.restore()}return s?d():(o=new Image,bildenavn.push(e),bildeobj.push(o),bildeklar.push(!1),bildeindex=bildenavn.length-1,tegn.logg_tegne&&console.log("tegnBildeFraFil",t,n,i,a,r),o.src=e,o.style.visibility="hidden",document.body.appendChild(o),o.onload=d),o}function tegnRektangel(e,t,n,i,a="blue"){tegn.logg_tegne&&console.log("tegnRektangel",e,t,n,i),tegn.ctx.beginPath(),tegn.ctx.strokeStyle=brukFarge(a),tegn.ctx.lineWidth=1,0===tegn.modus?(tegn.ctx.moveTo(e,t),tegn.ctx.lineTo(e+n,t),tegn.ctx.lineTo(e+n,t-i),tegn.ctx.lineTo(e,t-i),tegn.ctx.lineTo(e,t)):(tegn.ctx.moveTo(tegn.px(e),tegn.py(t)),tegn.ctx.lineTo(tegn.px(e+n),tegn.py(t)),tegn.ctx.lineTo(tegn.px(e+n),tegn.py(t+i)),tegn.ctx.lineTo(tegn.px(e),tegn.py(t+i)),tegn.ctx.lineTo(tegn.px(e),tegn.py(t))),tegn.ctx.stroke()}function tegnFyltRektangel(e,t,n,i,a="blue"){tegn.logg_tegne&&console.log("tegnFyltRektangel",e,t,n,i),tegn.ctx.beginPath(),tegn.ctx.fillStyle=brukFarge(a),0===tegn.modus?(tegn.ctx.moveTo(e,t),tegn.ctx.lineTo(e+n,t),tegn.ctx.lineTo(e+n,t-i),tegn.ctx.lineTo(e,t-i),tegn.ctx.lineTo(e,t)):(tegn.ctx.moveTo(tegn.px(e),tegn.py(t)),tegn.ctx.lineTo(tegn.px(e+n),tegn.py(t)),tegn.ctx.lineTo(tegn.px(e+n),tegn.py(t+i)),tegn.ctx.lineTo(tegn.px(e),tegn.py(t+i)),tegn.ctx.lineTo(tegn.px(e),tegn.py(t))),tegn.ctx.fill()}function tegnFirkant(e,t,n,i,a="blue",r=!0){tegn.logg_tegne&&console.log("tegnFyltRektangel",x,y,bredde,høyde),tegn.ctx.beginPath(),r?tegn.ctx.fillStyle=brukFarge(a):tegn.ctx.strokeStyle=brukFarge(a),0===tegn.modus?(tegn.ctx.moveTo(e,t),tegn.ctx.lineTo(n,t),tegn.ctx.lineTo(n,i),tegn.ctx.lineTo(e,i),tegn.ctx.lineTo(e,t)):(tegn.ctx.moveTo(tegn.px(e),tegn.py(t)),tegn.ctx.lineTo(tegn.px(n),tegn.py(t)),tegn.ctx.lineTo(tegn.px(n),tegn.py(i)),tegn.ctx.lineTo(tegn.px(e),tegn.py(i)),tegn.ctx.lineTo(tegn.px(e),tegn.py(t))),r?tegn.ctx.fill():tegn.ctx.stroke()}function tegnKvadrat(e,t,n,i="green"){tegn.logg_tegne&&console.log("tegnKvadrat",e,t,n),tegnRektangel(e-.5*n,t-.5*n,n,n,i)}function tegnFyltKvadrat(e,t,n,i="green"){tegn.logg_tegne&&console.log("tegnFyltKvadrat",e,t,n),tegnFyltRektangel(e-.5*n,t-.5*n,n,n,i)}function tegnFyltTrekant(e,t,n,i,a="green"){var r=[],o=[];r[0]=e-.5*n,o[0]=t,r[1]=e+.5*n,o[1]=t,r[2]=e,o[2]=t+i,tegn.logg_tegne&&console.log("tegnFyltTrekant",e,t,n,i),tegnFyltOmråde(r,o,a)}function tegnTrekant(e,t,n,i,a="grey"){var r=[],o=[];r[0]=e-.5*n,o[0]=t,r[1]=e+.5*n,o[1]=t,r[2]=e,o[2]=t+i,r[3]=r[0],o[3]=o[0],tegn.logg_tegne&&console.log("tegnTrekant",e,t,n,i),tegnKurve(r,o,a)}function tegnSirkel(e,t,n,i="blue",a=!0){if(tegn.logg_tegne&&console.log("tegnSirkel",e,t,n),a){tegn.ctx.beginPath(),tegn.ctx.strokeStyle=brukFarge(i);var r=tegn.pxy(e,t);tegn.ctx.arc(r[0],r[1],n,0,2*Math.PI),tegn.ctx.stroke()}else{for(var o=[],l=[],s=0,g=0;g<=2*Math.PI;g+=Math.PI/20)o[s]=e+n*Math.cos(g),l[s]=t+n*Math.sin(g),s+=1;tegnKurve(o,l,brukFarge(i))}}function tegnFyltSirkel(e,t,n,i="yellow",a=!0){if(tegn.logg_tegne&&console.log("tegnFyltSirkel",e,t,n),a){tegn.ctx.beginPath(),tegn.ctx.fillStyle=brukFarge(i);var r=tegn.pxy(e,t);tegn.ctx.arc(r[0],r[1],n,0,2*Math.PI),tegn.ctx.fill()}else{for(var o=[],l=[],s=0,g=0;g<=2*Math.PI;g+=Math.PI/20)o[s]=e+n*Math.cos(g),l[s]=t+n*Math.sin(g),s+=1;tegnFyltOmråde(o,l,brukFarge(i))}}function tegnSirkelsektor(e,t,n,i,a,r="yellow"){tegn.logg_tegne&&console.log("tegnSirkelSektor",e,t,n,i,a);var o=[];if(yarr=[],0==tegn.modus)tegn.ctx.beginPath(),tegn.ctx.fillStyle=brukFarge(r),tegn.ctx.moveTo(e,t),tegn.ctx.arc(e,t,n,-a/360*2*Math.PI,-i/360*2*Math.PI),tegn.ctx.lineTo(e,t),tegn.ctx.stroke();else{o=[];yarr=[],o[0]=e,yarr[0]=t;for(var l=(a-i)/179,s=1;s<180;s++)o[s]=e+n*cosD(i+(s-1)*l),yarr[s]=t+n*sinD(i+(s-1)*l);o.push(e),yarr.push(t),tegnKurve(o,yarr,r)}}function tegnFyltSirkelsektor(e,t,n,i,a,r="yellow"){tegn.logg_tegne&&console.log("tegnFyltSirkelSektor",e,t,n,i,a);var o=[];if(yarr=[],0==tegn.modus)tegn.ctx.beginPath(),tegn.ctx.fillStyle=brukFarge(r),tegn.ctx.moveTo(e,t),tegn.ctx.arc(e,t,n,-a/360*2*Math.PI,-i/360*2*Math.PI),tegn.ctx.lineTo(e,t),tegn.ctx.fill();else{o=[];yarr=[],o[0]=e,yarr[0]=t;for(var l=(a-i)/179,s=1;s<180;s++)o[s]=e+n*cosD(i+(s-1)*l),yarr[s]=t+n*sinD(i+(s-1)*l);o.push(e),yarr.push(t),tegnFyltPolygon(o,yarr,r)}}function tegnHentMusposisjon(e){return tegn.xKlikk=e.clientX-tegn.canvas.offsetLeft,tegn.yKlikk=e.clientY-tegn.canvas.offsetTop,tegn.xKlikk=e.offsetX,tegn.yKlikk=e.offsetY,[tegn.xKlikk,tegn.yKlikk]}function tegnHentSistePosisjon(){return tegn.logg_tegne&&console.log("tegnHentSistePosisjon",tegn.xKlikk,tegn.yKlikk),[tegn.xKlikk,tegn.yKlikk]}function tegnBrukRotasjon(e,t,n){tegn.logg_tegne&&console.log("tegnBrukRotasjon",e,t,n),tegn.ctx.translate(tegn.px(e),tegn.py(t)),tegn.ctx.rotate(-n*Math.PI/180),tegn.ctx.translate(tegn.px(-e),tegn.py(-t))}function tegnBrukKlippeRektangel(e,t,n,i){tegn.logg_tegne&&console.log("tegnBrukKlippeRektangel",e,t,n,i),tegnRektangel(e,t,n,i,"black"),tegn.ctx.clip()}function tegnKlipping(e){tegn.logg_tegne&&console.log("tegnKlipping",e),e?(tegn.ctx.save(),tegnBrukKlippeRektangel(tegn.Vx1,tegn.Vy1,tegn.Vx2-tegn.Vx1,tegn.Vy2-tegn.Vy1)):tegn.ctx.restore()}function tegnStolpediagram(e,t,n,i,a,r,o=" ",l="antall",s="lightgrey",g="lightblue",d="black"){for(var u,f,p=a/(2*e.length+1),c=i-21,h=-9999999,v=0,k=0;k<e.length;k++)e[k]>h&&(h=e[k]),v+=e[k];u=.6*r/h,tegnFyltRektangel(n,i,a,r,s);var m=n+p;for(k=0;k<e.length;k++)tegnFyltRektangel(m,c,p,f=e[k]*u,g),tegnRektangel(m,c,p,f,"black"),tegnTekst(t[k],m+.5*p,c+16.8,d,0,"Calibri",14,"center"),"antall"===l&&tegnTall(e[k],m+7,c-f,0,d,45),"prosent"===l&&tegnTall(100*e[k]/v,m+7,c-f,1,d,45),m+=2*p;tegnTekst(o,n+20,i-r+28,"black",0,"Calibri",20)}function tegnStolper(e,t,n,i,a,r,o=" ",l="antall",s="lightyellow",g="lightblue",d="black"){for(var u,f,p=a/(2*e.length+1),c=i,h=-9999999,v=0,k=0;k<e.length;k++)e[k]>h&&(h=e[k]),v+=e[k];u=.6*r/h,tegnFyltRektangel(n,i,a,r,s);var m=n+p;for(k=0;k<e.length;k++)tegnFyltRektangel(m,c+.05*(f=e[k]*u),p,f,g),tegnRektangel(m,c+.05*f,p,f,"black"),tegnTekst(t[k],m+.5*p,c,d,0,"center",14,"Calibri","top"),"antall"===l&&tegnTall(e[k],m,c+f,0,d,45,14),"prosent"===l&&tegnTall(100*e[k]/v,m+.25*p,c+f+.05*f,1,d,45,"left",14),m+=2*p;tegnTekst(o,.5*(n+a),r,"black",0,"center",16,"Calibri","bottom")}function tegnStolpeTestresultat(e,t,n){if(e+t+n!=0){var i=tegnHentXY(),a=tegnHentXYN();tegnBrukOmråde(0,.05,.1,.9),tegnBrukXY(0,1,0,max(e+t+n,1)),tegnFyltRektangel(0,0,1,e,"green"),tegnTall(e,.2,e/2,0,"white"),tegnFyltRektangel(0,e,1,t,"red"),tegnTall(t,.2,e+t/2,0,"white"),tegnFyltRektangel(0,e+t,1,n,"orange"),tegnTall(n,.2,e+t+n/2,0,"white"),prosent=avrund(100*e/(e+t+n),1),tegnTekst(prosent+"%",.1,e+t+n),tegnBrukOmråde(a[0],a[1],a[2],a[3]),tegnBrukXY(i[0],i[1],i[2],i[3])}}function tegnKnapp(e,t,n,i=100,a=22,r=!1){r?(tegnFyltRektangel(t,n,i,a,"lightyellow"),tegnRektangel(t,n,i,a,"grey"),tegnLinjestykke(t,n,t+i,n,"black"),tegnLinjestykke(t+i,n,t+i,n-a,"black"),tegnTekst(e,t+.5*i,n-2,"black",0,"center",a-4,"Calibri","bottom")):(tegnFyltRektangel(t,n,i,a,"lightgrey"),tegnRektangel(t,n,i,a,"grey"),tegnLinjestykke(t,n,t+i,n,"black"),tegnLinjestykke(t+i,n,t+i,n-a,"black"),tegnTekst(e,t+.5*i,n-2,"black",0,"center",a-4,"Calibri","bottom"))}function tegnKnappeMeny(e,t,n="vannrett",i=5,a=25,r=100,o=18,l=!0,s=!0){var g,d,u,f,p=tegn.modus;tegn.modus=0,tegnKlipping(!1),l&&(tegn.knappeliste.knapper=[]),"vannrett"===n?(g=i,d=a,u=r+3,f=0):(g=i,d=a,u=0,f=o+3);for(var c=-1;c<t.length;c++)-1===c&&!0===s?(tegnKnapp(e,g,d,r,o,!0),"vannrett"===n&&(d=d+o+3)):c>=0&&(tegnKnapp(t[c],g,d,r,o),tegn.knappeliste.nyKnapp(e,t[c],g,d-o,r,o),(g+=u)>tegn.canvas.width-u&&(g=i,d=d+o+3)),d+=f;tegn.modus=p}function tegnKnapperOppdater(){var e=tegn.modus;tegn.modus=0,tegnKlipping(!1),tegn.knappeliste.oppdater(),tegn.modus=e}function tegnKnapperGraftegner(e,t=tegn.Vx1,n=tegn.Vx2){tegn.Cx1=50,tegn.Cx2=tegn.canvas.width-100-30,tegn.Cy2=tegn.canvas.height-50,tegn.knappeliste.mattefunksjon=e,tegnMatteFunksjon(e,t,n,!0),tegnKnappeMeny("Graftegner",["Punkt","Zoom+","Zoom-","Skift V","Skift H","Skift O","Skift N","Tilbakestill","x-område","y-område"],"loddrett",tegn.canvas.width-100-20,30,100,22,!0,!0),tegnMelding("Klikk på gjeldende knapp og følg instruksjonene")}function tegnGraftegner(e=tegn.Vx1,t=tegn.Vx2){tegn.Cx1=80,tegn.Cx2=tegn.canvas.width-100-30,tegn.Cy1=80,tegn.Cy2=tegn.canvas.height-50,tegnMatteFunksjon(tegn.mattefunksjon,e,t,!0),tegnMineElementer(),tegnKnappeMeny("Graftegner",["Punkt","Zoom+","Zoom-","Skift V","Skift H","Skift O","Skift N","Tilbakestill","x-område","y-område"],"loddrett",tegn.canvas.width-100-20,30,100,22,!0,!0),tegnMelding("Klikk på gjeldende knapp og følg instruksjonene")}function F(e){return tegn.mattefunksjon(e)}function tegnHentKnappekommando(e,t){return tegn.knappeliste.finnKnapp(e,t)}function tegnFinnKnapp(e,t){return tegn.xKlikk=e,tegn.yKlikk=t,tegn.knappeliste.finnKnapp(e,t)}function tegnUtførKnappekommando(e,t){var n,i,a,r,o=tegnHentSistePosisjon();if(n=o[0],i=o[1],"Canvas"===t){tegn.modus=1;var l=tegn.vxy(n,i);if(l[0]<tegn.Vx1||l[0]>tegn.Vx2||l[1]<tegn.Vy1||l[1]>tegn.Vy2)return;var s=tegn.mattefunksjon(l[0]);if(tegnMelding("Piksel:("+n.toFixed(0)+","+i.toFixed(0)+") "+("Punkt:("+l[0].toFixed(2)+","+l[1].toFixed(2)+") ")+("F("+l[0].toFixed(2)+")="+s.toFixed(5)),"observer"),"Zoom+@Graftegner"===tegn.knappeliste.sisteKommando){var g,d,u;tegn.modus=1,a=(g=tegn.vxy(n,i))[0],r=g[1],d=.25*(tegn.Vx2-tegn.Vx1),u=.25*(tegn.Vy2-tegn.Vy1),tegn.zoomInn([a-d,a+d,r-u,r+u]),tegnMatteFunksjon(tegn.mattefunksjon,tegn.Vx1,tegn.Vx2,!0),tegnMineElementer(),tegnKnapperOppdater()}}else if("Graftegner"===t){if("Zoom+"===e)tegn.knappeliste.sisteKommando="Zoom+@Graftegner";else if("Zoom-"===e)tegn.zoomUt(),tegnMatteFunksjon(tegn.mattefunksjon,tegn.Vx1,tegn.Vx2,!0),tegnMineElementer(),tegnKnapperOppdater();else if("Tilbakestill"===e)tegn.zoomTilbakestill(),tegnMatteFunksjon(tegn.mattefunksjon,tegn.Vx1,tegn.Vx2,!0),tegnMineElementer(),tegnKnapperOppdater(),tegn.knappeliste.sisteKommando="Punkt@Graftegner";else if("Punkt"===e)tegn.knappeliste.sisteKommando="Punkt@Graftegner";else if("Skift V"===e)tegn.panorer("venstre"),tegnMatteFunksjon(tegn.mattefunksjon,tegn.Vx1,tegn.Vx2,!0,!0),tegnMineElementer(),tegnKnapperOppdater();else if("Skift H"===e)tegn.panorer("høyre"),tegnMatteFunksjon(tegn.mattefunksjon,tegn.Vx1,tegn.Vx2,!0,!0),tegnMineElementer(),tegnKnapperOppdater();else if("Skift O"===e)tegn.panorer("opp"),tegnMatteFunksjon(tegn.mattefunksjon,tegn.Vx1,tegn.Vx2,!0,!1),tegnMineElementer(),tegnKnapperOppdater();else if("Skift N"===e)tegn.panorer("ned"),tegnMatteFunksjon(tegn.mattefunksjon,tegn.Vx1,tegn.Vx2,!0,!1),tegnMineElementer(),tegnKnapperOppdater();else if("x-område"===e){var f="Angi funksjonens definisjonsområde. \nLav x og så høy x med mellomrom mellom. \n",p=prompt(f,tegn.Vx1+" "+tegn.Vx2).split(" "),c=parseFloat(p[0]),h=parseFloat(p[1]);h>c?(tegn.Vx1=c,tegn.Vx2=h,tegnMatteFunksjon(tegn.mattefunksjon,tegn.Vx1,tegn.Vx2,!0),tegnMineElementer(),tegnKnapperOppdater()):alert("Feil verdier. Prøv igjen.")}else if("y-område"===e){f="Angi y-verdier for tegneområdet. \nLav y og så høy y med mellomrom mellom. \n",p=prompt(f,tegn.Vy1+" "+tegn.Vy2).split(" ");var v=parseInt(p[0]),k=parseInt(p[1]);k>v?(tegn.Vy1=v,tegn.Vy2=k,tegnMatteFunksjon(tegn.mattefunksjon,tegn.Vx1,tegn.Vx2,!0,!1),tegnMineElementer(),tegnKnapperOppdater()):alert("Feil verdier. Prøv igjen.")}tegnMelding(e+"@"+t,"observer")}}function tegnPunkt(e,t,n="sirkel",i="black",a=6,r=!0,o=3){var l,s=a,g=[],d=[];if(g=tegn.vxy(0,0),d=tegn.vxy(s,0),l=Math.abs(d[0]-g[0]),g=tegn.vxy(0,0),d=tegn.vxy(0,s),Math.abs(d[1]-g[1]),tegn.logg_tegne&&console.log("tegnPunkt",e,t,n),tegnMarkør(e,t,n,brukFarge(i),a),r){var u=a;a<12&&(u=16),tegnTekst("("+round(e,o)+","+round(t,o)+")",e+l,t,"black",0,"left",u,"Calibri","middle")}}function tegnXlinje(e,t="red",n="strek",i=1){tegn.logg_tegne&&console.log("tegnXlinje",e,t),tegnLinjestykke(e,tegn.Vy1,e,tegn.Vy2,t,n,i)}function tegnYlinje(e,t="red",n="strek",i=1){tegn.logg_tegne&&console.log("tegnYlinje",e,t),tegnLinjestykke(tegn.Vx1,e,tegn.Vx2,e,t,n,i)}function tegnLinje(e,t,n="red",i="strek",a=1){tegn.logg_tegne&&console.log("tegnLinje",e,t,n),tegnLinjestykke(tegn.Vx1,e*tegn.Vx1+t,tegn.Vx2,e*tegn.Vx2+t,n,i,a)}function tegnLinjeToPunkt(e,t,n,i,a="red"){var r;return tegn.logg_tegne&&console.log("tegnLinjeToPunkt",e,t,n,i,a),abs(n-e)>1e-5?(tegnLinje(r=(i-t)/(n-e),t-r*e,a),r):-99999}function tegnGraf(e,t="red",n="strek",i=1,a=200){var r,o,l;tegn.logg_tegne&&console.log("tegnGraf",t),"number"==typeof n?(r=200,o="stiplet",l=1):(r=a,o=n,l=i);for(var s,g=(tegn.Vx2-tegn.Vx1)/(r-1),d=[],u=[],f=tegn.Vx1;f<=tegn.Vx2;f+=g)d.push(f),s=e(f),u.push(s);tegnKurve(d,u,t,o,l)}function tegnPolyGraf(e,t=!0,n="X",i="Y"){var a=["orange","blue","red","green","black","yellow"],r=[],o=[];if(tegn.logg_tegne&&console.log("tegnPolyGraf"),t){if(6==arguments.length)tegnBrukXområde(l=arguments[4],s=arguments[5]);else var l=tegn.Vx1,s=tegn.Vx2;xs=(s-l)/250;for(var g=999999,d=-999999,u=l;u<s;u+=xs)for(c=0;c<e.length;c++){var f=e[c](u);Number(f)&&(g=min(g,f),d=max(d,f))}tegnBrukYområde(g,d),tegnBrukBakgrunn(),tegnAkser(n,i)}for(var p=0,c=0;c<e.length;c++){tegnGraf(e[c],a[p]);var h=String(e[c]),v=(u=tegn.Vx2,f=e[c](u),h.split(" ")[1].split("{"));r[c]=v[0],o[c]=a[p],(p+=1)==a.length&&(p=0)}tegnForklaring(r,o,!0)}function tegnGrafDerivert1(e,t="green",n=200){var i=tegn.Vx1,a=tegn.Vx2,r=[],o=[],l=(a-i)/n;for(x=i;x<a;x+=l)r.push(x),o.push(s(x));function s(t){return(e(t+1e-5)-e(t))/1e-5}r.push(a),o.push(s(a)),tegnKurve(r,o,t)}function tegnGrafDerivert2(e,t="blue",n=200){var i=tegn.Vx1,a=tegn.Vx2,r=[],o=[],l=(a-i)/n;for(x=i;x<a;x+=l)r.push(x),o.push(g(x));function s(t){return(e(t+1e-5)-e(t))/1e-5}function g(e){return(s(e+1e-5)-s(e))/1e-5}r.push(a),o.push(g(a)),tegnKurve(r,o,t)}function tegnGrafRektangler(e,t,n,i=100,a="lightgreen",r="black"){for(var o=(n-t)/i,l=t,s=0,g=1;g<=i;g++)l+=o,"usynlig"===a&&"ingen"===a||tegnFyltRektangel(l-o,0,o,e(l-o),a),s+=o*e(l-o);return"usynlig"===r&&"ingen"===r||tegnGraf(e,r),s}function tegnTangent(e,t,n="green"){return dx=1e-5,a=(t(e+dx)-t(e))/dx,b=t(e)-a*e,tegnLinje(a,b,n),a}function tegnStigning(e,t,n,i="brown",a=!0,r=1){var o;(o=30/(tegn.Cx2-tegn.Cx1)*(tegn.Vx2-tegn.Vx1))>=.5&&o<=1.5&&(o=1),tegnBrukPenn(i,"strek",2),tegnPunkt(e,t,"sirkel",i,6,!1),tegnFlyttTil(e,t),tegnStrekTil(e+o,t),tegnStrekTil(e+o,t+o*n);var l=t+o*n*.5;l>tegn.Vy2&&(l=tegn.Vy2),tegnTekst(" a="+avrund(n,r),e+o,t+o*n*.5,i,0,"left",16,"Calibri","top")}function tegnVektor(e,t="red"){return tegnPil(tegn.pennPosX,tegn.pennPosY,tegn.pennPosX+e[0],tegn.pennPosY+e[1],t),tegn.logg_tegne&&console.log("tegnVektor",e,"til posisjon",tegn.pennPosX,tegn.pennPosY),[tegn.pennPosX,tegn.pennPosY]}function tegnPosisjonsvektor(e,t="red"){tegnPil(0,0,e[0],e[1],t),tegn.logg_tegne&&console.log("tegnVektor",e,"til posisjon",tegn.pennPosX,tegn.pennPosY)}function tegnVektorfunksjon(e,t,n,i="black",a=2,r=200){var o=(n-t)/(r-1),l=[],s={f:tegn.pennFarge,t:tegn.pennType,b:tegn.pennBredde};tegnFlyttTil(e(t)),tegnBrukPenn(i,"strek",a);for(var g=t+o;g<=n;g+=o)tegnStrekTil((l=e(g))[0],l[1]);tegnBrukPenn(s.f,s.t,s.b)}function tegnRutenett(e=1,t=1,n=!0){tegn.aksetegnet=!0;for(var i=10/(tegn.Cy2-tegn.Cy1)*(tegn.Vx2-tegn.Vx1),a=Math.floor(tegn.Vx1);a<=Math.ceil(tegn.Vx2);a+=e)tegnLinjestykke(a,Math.floor(tegn.Vy1),a,Math.ceil(tegn.Vy2),"grey","punkter"),n&&tegnTall(a,a,Math.floor(tegn.Vy1)-i,0,"black",0,"center",12,"Calibri","top");for(var r=10/(tegn.Cx2-tegn.Cx1)*(tegn.Vx2-tegn.Vx1),o=Math.floor(tegn.Vy1);o<=Math.ceil(tegn.Vy2);o+=t)tegnLinjestykke(Math.floor(tegn.Vx1),o,Math.ceil(tegn.Vx2),o,"grey","punkter"),n&&tegnTall(o,Math.floor(tegn.Vx1)-r,o,0,"black",0,"right",12,"Calibri","middle")}function tegnRute(e,t,n="red"){tegnFyltRektangel(e,t,1,1,n)}function tegnAkser(e="X",t="Y",n=2,i=2,a=!0,r=!0,o=!1){var l=[];tegn.aksetegnet=!0,l[0]=tegn.Vx1,l[1]=tegn.Vx2,l[2]=tegn.Vy1,l[3]=tegn.Vy2;var s=finnPentIntervall(l[0],l[1]);dialog.tekstX=e,dialog.tekstY=t;for(var g=s[0];g<=s[1];g+=s[2])g>=tegn.Vx1&&g<=tegn.Vx2&&tegnLinjestykke(g,tegn.Vy1,g,tegn.Vy2,"grey","punkter",.5);for(var d=finnPentIntervall(l[2],l[3]),u=d[0];u<=d[1];u+=d[2])u>=tegn.Vy1&&u<=tegn.Vy2&&tegnLinjestykke(tegn.Vx1,u,tegn.Vx2,u,"grey","punkter",.5);if(a){var f=tegn.Vy1-.015*(tegn.Vy2-tegn.Vy1);s=finnPentIntervall(l[0],l[1]);var p=Math.round(Math.log10(s[2])),c=Math.abs(p)+1,h=Math.max(n,0);n<c&&p<0&&(h=c);for(g=s[0];g<=s[1];g+=s[2])g>=tegn.Vx1&&g<=tegn.Vx2&&(tegnLinjestykke(g,tegn.Vy1,g,f),tegnTekst(g.toFixed(h),g,f,"black",0,"center",12,"Arial","top"))}if(r){var v=tegn.Vx1-.012*(tegn.Vx2-tegn.Vx1);d=finnPentIntervall(l[2],l[3]);p=Math.round(Math.log10(d[2])),c=Math.abs(p)+1;var k=Math.max(i,0);i<c&&p<0&&(k=c);for(u=d[0];u<=d[1];u+=d[2])u>=tegn.Vy1&&u<=tegn.Vy2&&(tegnLinjestykke(tegn.Vx1,u,v,u),tegnTekst(u.toFixed(k)+" ",v,u,"black",0,"right",12,"Arial","middle"))}if(o){var m=tegn.Vx2+.012*(tegn.Vx2-tegn.Vx1);d=finnPentIntervall(l[2],l[3]);p=Math.round(Math.log10(d[2])),c=Math.abs(p)+1,k=Math.max(i,0);i<c&&p<0&&(k=c);for(u=d[0];u<=d[1];u+=d[2])u>=tegn.Vy1&&u<=tegn.Vy2&&(tegnLinjestykke(tegn.Vx2,u,m,u),tegnTekst(" "+u.toFixed(k),m,u,"black",0,"left",12,"Arial","middle"))}tegnRektangel(tegn.Vx1,tegn.Vy1,tegn.Vx2-tegn.Vx1,tegn.Vy2-tegn.Vy1,"grey");var y=!1;tegn.Vy1<0&&tegn.Vy2>0&&(tegnLinjestykke(tegn.Vx1,0,tegn.Vx2,0,"blue","punkter",1),!0),tegn.Vx1<0&&tegn.Vx2>0&&(tegnLinjestykke(0,tegn.Vy1,0,tegn.Vy2,"blue","punkter",1),y=!0),y=!1,!!1,tegnTekst(e+"  ",tegn.Vx2,tegn.Vy1,"red",0,"right",14,"Arial","bottom");y||tegnTekst("  "+t,tegn.Vx1,tegn.Vy2,"red",0,"left",14,"Arial","top")}function tegnTittel(e,t="red",n="18",i="Calibri"){tegn.logg_tegne&&console.log("tegnTittel",e,t,n,i),tegnTekst(e,.5*(tegn.Vx1+tegn.Vx2),tegn.Vy2,t,0,"center",n,i,"bottom")}function tegnForklaring(e,t,n=!0){for(var i=e.length,a=-1,r=0;r<e.length;r++)j=e[r].length,a=Math.max(a,j);var o=18*(tegn.Vy2-tegn.Vy1)/tegn.canvas.height,l=14.1*(tegn.Vx2-tegn.Vx1)/tegn.canvas.width,s=tegn.Vx2-a*l,g=tegn.Vy2-o,d=s+2*l;n&&tegnFyltRektangel(s,tegn.Vy2-(i+1)*o,tegn.Vx2-s,o*(i+1),tegn.fargeBakgrunn),tegnRektangel(s,tegn.Vy2-(i+1)*o,tegn.Vx2-s,o*(i+1),"black");for(r=0;r<i;r++)tegnLinjestykke(s,g,d,g,t[r]),tegnTekst(e[r],d+.3*l,g,t[r],0,"left",14,"Arial","middle"),g-=o}function tegnFortegnslinje(e,t=0,n=.01,i=3,a=tegn.Vx1,r=tegn.Vx2){var o,l,s,g;o=0,e(a)>0&&(o=1),e(a)<0&&(o=-1),s=a,tegn.logg_tegne&&console.log("tegnFortegnslinje",t,a,r);for(var d=a+n;d<=r;d+=n)g=d,l=0,e(d)>0&&(l=1),e(d)<0&&(l=-1),o*l>0?g=d:o*l<0&&(o>0&&(tegnLinjestykke(s,t,g,t,"green","strek"),i>=0&&tegnTall(g,g,t,i,"black",-90,"left",14,"Arial","middle")),o<0&&(tegnLinjestykke(s,t,g,t,"red","stiplet"),i>=0&&tegnTall(g,g,t,i,"black",-90,"left",14,"Arial","middle")),s=g,o=l);o>0&&tegnLinjestykke(s,t,r,t,"green","strek"),o<0&&tegnLinjestykke(s,t,r,t,"red","stiplet")}function tegnKilde(){tegnMelding("Kilde: fulab.no")}function tegnBrukOmråde(e,t,n,i){tegnBrukSynsfelt(e,t,n,i)}function tegnPilSirkel(e,t,n,i,a="red"){tegnBrukPenn(a),tegnFlyttTil(e,t),tegnStrekTil(n,i),tegnFyltSirkel(n,i,3,a),tegnFlyttTil(n,i)}function tegnPolynom(e,t="black",n=tegn.Vx1,i=tegn.Vx2,a=200){for(var r,o=[],l=[],s=(i-n)/(a-1),g=0,d=n;d<=i;d+=s){r=e[0];for(var u=1;u<e.length;u++)r+=e[u]*Math.pow(d,u);o[g]=d,l[g]=r,g+=1}tegn.logg_tegne&&console.log("tegnPolynom",e),tegnKurve(o,l,t)}function tegnFyltOmråde(e,t,n="red"){var i=e.length-1,a=t.length-1;tegn.logg_tegne&&console.log("tegnFyltOmråde",e[0],t[0],"....",e[i],t[a]),tegn.ctx.beginPath(),tegn.ctx.fillStyle=brukFarge(n);for(var r=0;r<e.length;r++)0===r?tegn.ctx.moveTo(tegn.px(e[r]),tegn.py(t[r])):tegn.ctx.lineTo(tegn.px(e[r]),tegn.py(t[r]));tegn.ctx.lineTo(tegn.px(e[0]),tegn.py(t[0])),tegn.ctx.fill()}function tegnMineElementer(){tegn.mineElementer()}function tegnLesBilde(e){for(var t,n,i=!1,a=0;a<bildenavn.length;a++)if(e==bildenavn[a]){i=!0,t=bildeobj[a],n=a;break}function r(){t.style.visibility="hidden",bildeklar[n]=!0}return i?r():(t=new Image,bildenavn.push(e),bildeobj.push(t),bildeklar.push(!1),bildeindex=bildenavn.length-1,tegn.logg_tegne&&console.log("tegnBildeFraFil",xSenter,ySenter,xSkala,ySkala,rotasjonsvinkel),t.src=e,t.style.visibility="hidden",document.body.appendChild(t),t.onload=r()),t}function tegnBildeFraHTML(e,t,n,i=1,a=1,r=0){var o=tegn.px(t),l=tegn.py(n),s=o-.5*e.width,g=l-.5*e.height;tegn.logg_tegne&&console.log("tegnBildeFraHTML",t,n,i,a,r,e.src),tegn.ctx.save(),tegn.ctx.translate(o,l),tegn.ctx.rotate(-r*Math.PI/180),tegn.ctx.scale(i,a),tegn.ctx.translate(-o,-l),tegn.ctx.drawImage(e,s,g),tegn.ctx.restore()}function tegnTekstlinjer(e,t,n,i="black",a=16,r="Calibri"){for(var o=0;o<e.length;o++)tegnTekst(e[o],t,n+a*o,i,0,"left",a,r)}function tegnTabellrad(e,t,n,i,a="black",r="left",o=16){var l=t,s=n,g=tegn.modus;tegn.modus=0;for(var d=0;d<e.length;d++)l+=i[d],tegnTekst(e[d],l,s,a,0,r,o);tegn.modus=g}function tegnMatteFunksjon(e,t=tegn.Vx1,n=tegn.Vx2,i=!1,a=!0,r=200){var o,l=[],s=[],g=9999,d=-9999;o=(n-t)/(r-1);for(var u,f=0,p=t;p<=n;p+=o)l[f]=p,u=e(p),s[f]=u,g=Math.min(g,u),d=Math.max(d,u),f++;l.push(n),s.push(e(n)),i&&(tegn.Vx1=t,tegn.Vx2=n,tegnBrukBakgrunn("#FBE8A6")),a&&(tegn.Vy1=g,tegn.Vy2=d,tegnBrukBakgrunn("#FBE8A6")),tegnKlipping(!1);var c=tegn.modus;tegn.modus=1,(i||a)&&(tegnFyltRektangel(tegn.Vx1,tegn.Vy1,tegn.Vx2-tegn.Vx1,tegn.Vy2-tegn.Vy1,"white"),tegnAkser()),tegnKlipping(!0),tegn.modus=1,tegnKurve(l,s,tegn.fargeGraf,"strek",1.5),tegn.fargeGraf="black",tegn.modus=c,tegnKlipping(!1)}function tegnPunktGraf(e,t="sirkel",n="black",i=6,a=!0,r=1){var o,l=F(e),s=i,g=[],d=[];if(g=tegn.vxy(0,0),d=tegn.vxy(s,0),o=Math.abs(d[0]-g[0]),g=tegn.vxy(0,0),d=tegn.vxy(0,s),Math.abs(d[1]-g[1]),tegnMarkør(e,l,t,brukFarge(n),i),a){var u=i;i<12&&(u=12),tegnTekst("("+e.toFixed(r)+","+l.toFixed(r)+")",e+o,l,"black",0,"left",u,"Calibri","middle")}}class tegneverktøy{constructor(){this.canvasID="",this.canvas="undefined",this.ctx="undefined",this.fargeBakgrunn="white",this.Vx1=-10,this.Vx2=10,this.Vy1=-10,this.Vy2=10,this.nx1=.1,this.nx2=.9,this.ny1=.1,this.ny2=.9,this.Cx1=80,this.Cx2=360,this.Cy1=40,this.Cy2=360,this.modus=0,this.modusliste=[],this.xKlikk=-999,this.yKlikk=-999,this.logg_tegne=!1,this.logg_gui=!1,this.knappeliste=new tegnemeny,this.fargeGraf="black",this.zoomliste=[],this.mattefunksjon=new Function("x","return 2*x+1"),this.mineElementer=new Function('console.log("Minelementer ikke aktivert")')}pxy(e,t){return 0===this.modus?[e,t]:[this.Cx1+(this.Cx2-this.Cx1)*(e-this.Vx1)/(this.Vx2-this.Vx1),this.Cy2-(this.Cy2-this.Cy1)*(t-this.Vy1)/(this.Vy2-this.Vy1)]}px(e){return 0===this.modus?e:this.Cx1+(this.Cx2-this.Cx1)*((e-this.Vx1)/(this.Vx2-this.Vx1))}py(e){return 0===this.modus?e:this.Cy2-(this.Cy2-this.Cy1)*((e-this.Vy1)/(this.Vy2-this.Vy1))}vxy(e,t){return[this.Vx1+(this.Vx2-this.Vx1)*(e-this.Cx1)/(this.Cx2-this.Cx1),this.Vy1+(this.Vy2-this.Vy1)*(this.Cy2-t)/(this.Cy2-this.Cy1)]}zoomInn(e){this.zoomliste.length<=0&&this.zoomliste.push([this.Vx1,this.Vx2,this.Vy1,this.Vy2]),this.zoomliste.push(e),tegn.Vx1=e[0],tegn.Vx2=e[1],tegn.Vy1=e[2],tegn.Vy2=e[3];this.zoomliste.length}panorer(e){var t=tegn.Vx2-tegn.Vx1,n=tegn.Vy2-tegn.Vy1,i=[],a=0,r=0;"venstre"===e&&(a=-.15),"høyre"===e&&(a=.15),"opp"===e&&(r=.15),"ned"===e&&(r=-.15),i[0]=tegn.Vx1+a*t,i[1]=tegn.Vx2+a*t,i[2]=tegn.Vy1+r*n,i[3]=tegn.Vy2+r*n,this.zoomliste.length<=0&&this.zoomliste.push([this.Vx1,this.Vx2,this.Vy1,this.Vy2]),this.zoomliste.push(i),tegn.Vx1=i[0],tegn.Vx2=i[1],tegn.Vy1=i[2],tegn.Vy2=i[3];this.zoomliste.length}zoomUt(){(e=this.zoomliste.length)>=2&&(this.zoomliste.pop(),this.Vx1=this.zoomliste[e-2][0],this.Vx2=this.zoomliste[e-2][1],this.Vy1=this.zoomliste[e-2][2],this.Vy2=this.zoomliste[e-2][3]);var e=this.zoomliste.length}zoomTilbakestill(){for(var e=this.zoomliste.length;e>=2;){this.zoomliste.pop(),this.Vx1=this.zoomliste[e-2][0],this.Vx2=this.zoomliste[e-2][1],this.Vy1=this.zoomliste[e-2][2],this.Vy2=this.zoomliste[e-2][3];e=this.zoomliste.length}}}class tegnemeny{constructor(){this.knapper=[],this.sisteKommando=""}menyKnapper(e,t="loddrett",n=5,i=25,a=80,r=18){tegnKommandoMeny(e,t,n,i,a,r,"lagknapp")}oppdater(){for(var e,t,n,i=0;i<this.knapper.length;i++)t=(e=this.knapper[i]).x2-e.x1,n=e.y2-e.y1,tegnKnapp(this.knapper[i].kommando,e.x1,e.y2,t,n)}nyKnapp(e,t,n,i,a,r){var o=this.knapper.length,l={galleri:e,kommando:t,x1:n,x2:n+a,y1:Math.min(i,i+r),y2:Math.max(i,i+r)};this.knapper[o]=l}finnKnapp(e,t){for(var n,i=0;i<this.knapper.length;i++)if(e>=(n=this.knapper[i]).x1&&e<=n.x2&&t>=n.y1&&t<=n.y2)return[n.kommando,n.galleri];return["Punkt","Canvas"]}slettAlle(){this.knapper=[]}}function id(e){return document.getElementById(e)}function brukFarge(e){for(var t=["hvit","grå","svart","rød","grønn","blå","gul","orange","brun"],n=["white","grey","black","red","green","blue","yellow","orange","brown"],i=0;i<t.length;i++)if(t[i]===e)return n[i];return e}function finnPentIntervall(e,t){var n,i,a,r=[1,2,2.5,5,7.5,10,12,15,20,25,50];n=Math.round(Math.log10(t-e)),a=Math.pow(10,n-1),i=Math.ceil((t-e)/a);for(var o=-1;i>10;)o+=1,i=Math.ceil((t-e)/(a*r[o]));return-1!==o&&(a*=r[o]),[Math.round((e-.1*a)/a)*a,Math.round((t+.1*a)/a)*a,a]}function tegnBrukPikselOmråde(e,t,n,i){tegn.Cx1=e*tegn.canvas.width,tegn.Cx2=t*tegn.canvas.width,tegn.Cy1=tegn.canvas.height-i*tegn.canvas.height,tegn.Cy2=tegn.canvas.height-n*tegn.canvas.height}function tegnBrukCanvas(e){return tegn.logg_tegne&&console.log("tegnBrukCanvas",e),tegn.canvasID=e,tegn.canvas=document.getElementById(e),tegn.ctx=tegn.canvas.getContext("2d"),tegnBrukOmråde(.1,.9,.1,.9),tegn.modus=1,tegn.logg_tegne&&(console.log("Canvas bredde",tegn.canvas.width,"høyde",tegn.canvas.height),console.log("Synsfelt",tegn.nx1,tegn.nx2,tegn.ny1,tegn.ny2)),tegn.canvas}function tegnHentCTX(){return document.getElementById(tegn.canvasID)}function tegnHentPixGeometri(){var e=document.getElementById(tegn.canvasID);return[e.width,e.height]}function tegnHentPixBredde(){return document.getElementById(tegn.canvasID).width}function tegnHentPixHøyde(){return document.getElementById(tegn.canvasID).height}function tegnSettPixGeometri(e,t){$("#konteinerTegning").width(e),$("#konteinerTegning").height(t)}function tegnV2Pix(e,t){return tegn.pxy(e,t)}function tegnPix2V(e,t){return tegn.vxy(e,t)}function tegnVedKlikk(e){tegn.canvas.onclick=e}tegn=new tegneverktøy;class DataManager{constructor(){this.dmv="datamanager v1",this.appname="undefined",this.dataname="undefined",this.data="undefined"}getAppList(){for(var e,t=[],n=0;n<localStorage.length;n++)3===(e=localStorage.key(n).split(";")).length&&e[0]==this.dmv&&-1==t.indexOf(e[1])&&t.push(e[1]);return t}getAppDataList(e){for(var t,n=[],i=0;i<localStorage.length;i++)3===(t=localStorage.key(i).split(";")).length&&t[0]==this.dmv&&t[1]==e&&n.push(t[2]);return n}readAppData(e,t,n){for(var i,a,r=0;r<localStorage.length;r++)if(3===(a=(i=localStorage.key(r)).split(";")).length&&a[0]==this.dmv&&a[1]==e&&a[2]==t)return this.appname=e,this.dataname=t,JSON.parse(localStorage.getItem(i));return!1}writeAppData(e,t,n){var i=this.dmv+";"+e+";"+t;localStorage.setItem(i,JSON.stringify(n))}removeAppData(e,t){for(var n,i,a=0;a<localStorage.length;a++)3===(i=(n=localStorage.key(a)).split(";")).length&&i[0]==this.dmv&&i[1]==e&&i[2]==t&&localStorage.removeItem(n);return!1}getCurrentData(){return{dm:this.dm,app:this.appname,dataname:this.dataname,data:this.data}}}var versjonIDE="1.0",dialog={matfunksjon:"f",editor:"undefined",viewer:"undefined",kildekode:"//undefined",sistefil:"fusionKode.fujs",turtle:!1,teacher:!0,language:"python"},debug=!1;function _init_dialog(){dialog.tegnefunksjon="fuWebDrawing",dialog.tegnekjerne="undefined",dialog.klikkfunksjon="undefined",dialog.movefunksjon="undefined",dialog.topp="FusionDialog",dialog.knappefarge="orange",dialog.inputfarge="lightyellow",dialog.tekstfarge="black",dialog.overskriftsfarge="black",dialog.lerretsfarge="white",dialog.lerret=[650,550],dialog.lerretsområde=[.1,.9,.1,.9],dialog.verdenskoordinater=[-10,10,-10,10],dialog.tekstX="x-akse",dialog.tekstY="y-akse",dialog.avrundingX=2,dialog.avrundingY=2,dialog.tekstlengde=15,dialog.knappebredde="65px",dialog.inputbredde="80px",dialog.label="",dialog.marg="2px",dialog.matfunksjon="undefined",dialog.kildekode="//undefined",dialog.manindeks=0,dialog.debug=!1,debug=dialog.debug}function graftegner(e,t=tegn.Vx1,n=tegn.Vx2,i=tegn.Vy1,a=tegn.Vy2,r="x-akse",o="y-akse"){settGraftegner(t,n,i,a,e,tegn.fargeBakgrunn,r,o)}function settGraftegner(e,t,n,i,a,r="white",o="X",l="Y"){dialog.verdenskoordinater[0]=e,dialog.verdenskoordinater[1]=t,dialog.verdenskoordinater[2]=n,dialog.verdenskoordinater[3]=i,tegnBrukXområde(e,t),tegnBrukYområde(n,i),dialog.lerretsfarge=r,dialog.tegnekjerne=a,dialog.tekstX=o,dialog.tekstY=l,finnesId("_tegnVx1")?(id("_tegnVx1").value=e.toFixed(dialog.avrundingX),id("_tegnVx2").value=t.toFixed(dialog.avrundingX),id("_tegnVy1").value=n.toFixed(dialog.avrundingY),id("_tegnVy2").value=i.toFixed(dialog.avrundingY),fuWebDrawing()):(print("plot+tegnakser"),a(),tegnAkser())}function settTegnefunksjon(e){dialog.tegnekjerne=e}function lagDialogOverskrift(e){lagDialogLinjeskift(1),lagDialogTekst(e,!0),lagDialogLinjeskift(1)}function lagDialogForklaring2(e,t=!1,n="udefinert"){var i=document.createElement("label");i.style.color=dialog.tekstfarge,t&&(i.innerHTML="<b>"+e+"</b>"),t||(i.innerHTML=e),i.size=dialog.tekstlengde,"udefinert"!=n&&(i.style.float="left",i.style.width=n+"px"),id(dialog.topp).appendChild(i)}function lagDialogForklaring(e,t=!1,n="udefinert"){dialog.label={tekst:e,uthevet:t,bredde:n}}function lagDialogLabel(e,t,n=!1,i="udefinert"){var a=document.createElement("label");a.style.color=dialog.tekstfarge,a.for=t,n&&(a.innerHTML="<b>"+e+"</b>"),n||(a.innerHTML=e),"udefinert"!=i&&(a.style.float="left",a.style.width=i+"px"),id(dialog.topp).appendChild(a)}function lagDialogTekst(e,t=!1,n="udefinert"){var i=document.createElement("span");i.style.color=dialog.tekstfarge,t&&(i.innerHTML="<b>"+e+"</b>"),t||(i.innerHTML=e),i.size=dialog.tekstlengde,"udefinert"!=n&&(i.style.float="left",i.style.width=n+"px"),id(dialog.topp).appendChild(i)}function lagDialogGruppe(e){var t;return dialog.debug&&console.log("lagDialogGruppe",e),(t=document.createElement("div")).id=e,id(dialog.topp).appendChild(t),dialog.topp=e,t}function lagDialogLinjeskift(e=1){for(var t=0;t<e;t++){var n=document.createElement("br");id(dialog.topp).appendChild(n)}}function lagDialogMellomrom(e){for(var t=document.createElement("&nbsp"),n=0;n<e;n++)id(dialog.topp).appendChild(t)}function lagDialogKnapp(e,t,n,i="udefinert"){var a=document.createElement("button");a.id=t,a.innerHTML=e,a.style.margin=dialog.marg,a.style.width="udefinert"==i||"standard"==i?dialog.knappebredde:"auto"==i?"auto":i,a.style.height="auto",a.onclick=n,id(dialog.topp).appendChild(a)}function lagDialogInput(e,t,n,i="udefinert"){dialog.label&&(lagDialogLabel(dialog.label.tekst,t,dialog.label.uthevet,dialog.label.bredde),dialog.label="");var a=document.createElement("input");a.id=t,a.type="text",a.value=e,a.style.width="udefinert"==i||"standard"==i?dialog.inputbredde:i,a.style.backgroundColor=dialog.inputfarge,a.size=dialog.tekstlengde,a.style.margin=dialog.marg,a.style.textAlign="center",a.onchange=n,id(dialog.topp).appendChild(a)}function lagDialogKommando(e,t,n="udefinert"){var i=document.createElement("input");i.id=e,i.type="text",i.value="kommando",i.style.width="udefinert"==n?dialog.inputbredde:n,i.style.backgroundColor=dialog.inputfarge,i.size=dialog.tekstlengde,i.style.margin=dialog.marg,i.onchange=t,lagDialogForklaring("Skriv inn kommand:"),id(dialog.topp).appendChild(i)}function lagDialogAvkryssing(e,t,n,i){for(var a=0;a<e.length;a++){var r=document.createElement("input");r.id=t+"_"+a,r.type="checkbox",r.name=n,r.value=a,0==a&&(r.checked=!0),r.onchange=i,id(dialog.topp).appendChild(r),lagDialogTekst(e[a])}}function lagDialogRadioknapp(e,t,n,i){for(var a=0;a<e.length;a++){var r=document.createElement("input");r.id=t,r.type="radio",r.name=n,r.value=a,0==a&&(r.checked=!0),r.onchange=i,id(dialog.topp).appendChild(r),lagDialogForklaring(e[a]),lagDialogTekst(e[a])}}function lagDialogGlider(e,t,n,i,a,r=.1,o="udefinert",l="udefinert"){var s=document.createElement("input"),g=abs(int(log10(r)));s.id=t,s.type="range",s.min=i.toFixed(g),s.max=a.toFixed(g),s.step=r,s.value=n.toFixed(g),"udefinert"!=o&&(s.onchange=o),"udefinert"!=l&&(s.oninput=l),lagTekst("<br>"+e+"<br>"),lagTekst(i.toFixed(g)),id(dialog.topp).appendChild(s),lagTekst(a.toFixed(g))}function lagDialogValgliste(e,t,n){var i;(i=document.createElement("select")).id=e,i.onchange=n;for(var a=0;a<t.length;a++){var r=document.createElement("option");r.value=t[a],r.innerHTML=t[a],i.appendChild(r)}id(dialog.topp).appendChild(i)}function lagDialogFil(e,t,n,i){var a=document.createElement("input");a.id=n,a.type="file",a.accept=t,a.style.backgroundColor=dialog.inputfarge,a.style.color=dialog.tekstfarge,a.style.margin=dialog.marg,a.style.width="250px",a.textIndent="2px",a.textAlign="center",a.style.textShadow="3px",a.onchange=function(){var e=this.files,t=e[0].name;dialog.debug&&console.log("Leste inn fila:",e[0].name);dialog.sistefil=e[0].name,function(e){var n=e[0],a=new FileReader;a.onload=function(e){var n=e.target.result;i(n,t)},a.readAsText(n)}(e)},e.length>0&&lagDialogTekst(e+"&nbsp"),id(dialog.topp).appendChild(a)}function lagDialogTegneflate(e,t,n,i="undefined"){var a=document.createElement("canvas");return a.id=e,a.style.color=dialog.lerretsfarge,a.width=t,a.height=n,a.onclick=_vedMusklikk,a.style.cursor="crosshair",id(dialog.topp).appendChild(a),a}function lagDialogMeldinger(e,t,n,i="undefined"){var a=document.createElement("textarea");return a.id=e,a.style.color=dialog.tekstfarge,a.cols=t,a.rows=n,a.style.margin=dialog.marg,id(dialog.topp).appendChild(a),a}function lagDialogRamme(e,t,n,i="500px",a="auto",r="text/html"){var o;(o=document.createElement("iframe")).id=e,o.title=t,o.width=i,o.height=a,o.src=n,o.allowfullscreen=!0,o.type=r,id(dialog.topp).appendChild(o),dialog.manualramme=e}function verdiH(e){return parseInt(id(e).value)}function verdiD(e){return parseFloat(id(e).value)}function verdiT(e){return id(e).value}function settVerdi(e,t){id(e).value=t}function lagVinduKonsoll(e,t=35,n=10){lagDialogGruppe("FusionKonsoll");var i=dialog.topp;dialog.topp="FusionKonsoll",lagDialogLinjeskift(),lagDialogOverskrift(e),lagDialogMeldinger("meldinger",t,n),lagDialogLinjeskift(),lagDialogKnapp("Slett","slettMeldinger",htmlMeldingSlett),htmlMelding("Her kommer meldinger:"),dialog_topp=i}function lagVinduGrafikk(e,t,n,i,a){dialog.debug&&console.log("VinduGrafikk-Anker=",dialog.topp),dialog.debug&&console.log("Vindusdimensjon=",n,i),lagDialogTegneflate(t,n,i,a),tegnBrukCanvas(t);var r=dialog.lerretsområde;tegnBrukOmråde(r[0],r[1],r[2],r[3]);var o=dialog.verdenskoordinater;tegnBrukXområde(o[0],o[1]),tegnBrukYområde(o[2],o[3])}function lagVinduGrafVerktøy(e){dialog.debug&&console.log("lagVinduGrafVerktøy-Anker=",dialog.topp),lagDialogTekst("Tegneverktøy",!0),lagDialogLinjeskift(),lagDialogLinjeskift(),lagDialogTekst("Plotteområde",!0),lagDialogLinjeskift(),lagDialogTekst(" x1 "),lagDialogInput(tegn.Vx1.toFixed(dialog.avrundingX),"_tegnVx1"),lagDialogTekst(" x2 "),lagDialogInput(tegn.Vx2.toFixed(dialog.avrundingX),"_tegnVx2"),lagDialogLinjeskift(),lagDialogTekst(" y1 "),lagDialogInput(tegn.Vy1.toFixed(dialog.avrundingY),"_tegnVy1"),lagDialogTekst(" y2 "),lagDialogInput(tegn.Vy2.toFixed(dialog.avrundingY),"_tegnVy2"),lagDialogLinjeskift(),lagDialogLinjeskift(),lagDialogTekst("Desimaler i avrunding",!0),lagDialogLinjeskift(),lagDialogTekst(" x "),lagDialogInput(dialog.avrundingX,"_tegnAvrundX","undefined","20px"),lagDialogTekst(" y "),lagDialogInput(dialog.avrundingY,"_tegnAvrundY","undefined","20px"),lagDialogLinjeskift(),lagDialogKnapp("Oppdater","tegn",function(){dialog.avrundingX=hentFeltH("_tegnAvrundX"),dialog.avrundingY=hentFeltH("_tegnAvrundY"),tegn.Vx1=Number(id("_tegnVx1").value),tegn.Vx2=Number(id("_tegnVx2").value),tegn.Vy1=Number(id("_tegnVy1").value),tegn.Vy2=Number(id("_tegnVy2").value),fuWebDrawing()},"80px"),lagDialogLinjeskift(),lagDialogTekst("Flytt synsfelt",!0),lagDialogLinjeskift(),lagDialogKnapp("V","venstre",function(){var e=(tegn.Vx2-tegn.Vx1)*t;dialog.avrundingX=hentFeltH("_tegnAvrundX"),dialog.avrundingY=hentFeltH("_tegnAvrundY"),tegn.Vx1=tegn.Vx1-e,tegn.Vx2=tegn.Vx2-e,id("_tegnVx1").value=tegn.Vx1.toFixed(dialog.avrundingX),id("_tegnVx2").value=tegn.Vx2.toFixed(dialog.avrundingX),fuWebDrawing()},"40px"),lagDialogKnapp("H","høyre",function(){var e=(tegn.Vx2-tegn.Vx1)*t;dialog.avrundingX=hentFeltH("_tegnAvrundX"),dialog.avrundingY=hentFeltH("_tegnAvrundY"),tegn.Vx1=tegn.Vx1+e,tegn.Vx2=tegn.Vx2+e,id("_tegnVx1").value=tegn.Vx1.toFixed(dialog.avrundingX),id("_tegnVx2").value=tegn.Vx2.toFixed(dialog.avrundingX),fuWebDrawing()},"40px"),lagDialogKnapp("O","opp",function(){var e=(tegn.Vy2-tegn.Vy1)*t;dialog.avrundingX=hentFeltH("_tegnAvrundX"),dialog.avrundingY=hentFeltH("_tegnAvrundY"),tegn.Vy1=tegn.Vy1+e,tegn.Vy2=tegn.Vy2+e,id("_tegnVy1").value=tegn.Vy1.toFixed(dialog.avrundingY),id("_tegnVy2").value=tegn.Vy2.toFixed(dialog.avrundingY),fuWebDrawing()},"40px"),lagDialogKnapp("N","ned",function(){var e=(tegn.Vy2-tegn.Vy1)*t;dialog.avrundingX=hentFeltH("_tegnAvrundX"),dialog.avrundingY=hentFeltH("_tegnAvrundY"),tegn.Vy1=tegn.Vy1-e,tegn.Vy2=tegn.Vy2-e,id("_tegnVy1").value=tegn.Vy1.toFixed(dialog.avrundingY),id("_tegnVy2").value=tegn.Vy2.toFixed(dialog.avrundingY),fuWebDrawing()},"40px"),lagDialogLinjeskift(),lagDialogKnapp("Zoom+","+",function(){var e=.5*(tegn.Vx2-tegn.Vx1),t=.5*(tegn.Vy2-tegn.Vy1),i=.5*(tegn.Vx1+tegn.Vx2),a=.5*(tegn.Vy1+tegn.Vy2);dialog.avrundingX=hentFeltH("_tegnAvrundX"),dialog.avrundingY=hentFeltH("_tegnAvrundY"),tegn.Vx1=i-(1-n)*e,tegn.Vx2=i+(1-n)*e,tegn.Vy1=a-(1-n)*t,tegn.Vy2=a+(1-n)*t,id("_tegnVx1").value=tegn.Vx1.toFixed(dialog.avrundingX),id("_tegnVx2").value=tegn.Vx2.toFixed(dialog.avrundingX),id("_tegnVy1").value=tegn.Vy1.toFixed(dialog.avrundingY),id("_tegnVy2").value=tegn.Vy2.toFixed(dialog.avrundingY),fuWebDrawing()},"60px"),lagDialogKnapp("Zoom-","-",function(){var e=.5*(tegn.Vx2-tegn.Vx1),t=.5*(tegn.Vy2-tegn.Vy1),i=.5*(tegn.Vx1+tegn.Vx2),a=.5*(tegn.Vy1+tegn.Vy2);dialog.avrundingX=hentFeltH("_tegnAvrundX"),dialog.avrundingY=hentFeltH("_tegnAvrundY"),tegn.Vx1=i-(1+n)*e,tegn.Vx2=i+(1+n)*e,tegn.Vy1=a-(1+n)*t,tegn.Vy2=a+(1+n)*t,id("_tegnVx1").value=tegn.Vx1.toFixed(dialog.avrundingX),id("_tegnVx2").value=tegn.Vx2.toFixed(dialog.avrundingX),id("_tegnVy1").value=tegn.Vy1.toFixed(dialog.avrundingY),id("_tegnVy2").value=tegn.Vy2.toFixed(dialog.avrundingY),fuWebDrawing()},"60px"),lagDialogLinjeskift(),lagDialogLinjeskift(),lagDialogTekst("Koden må inneholde kallet til <br><b>graftegner(mittplot,x1,x2,y1,y2)</b>"),dialog.tegnefunksjon=e;var t=.1,n=.1}function lagVinduKodeIO(e=!0,t=!0,n=!0){if(dialog.topp="FusionTopp",dialog.debug&&console.log("lagVinduKodeIO","Anker=",dialog.topp),lagDialogGruppe("FusionVisElementer"),lagDialogTekst("Vis",!0),lagDialogAvkryssing(["Editor","Kode IO","Tegning/Dialog","Auto"],"VisElementer","VisElementer",_vedValgtAvkryssing),id("VisElementer_3").checked=!0,lagDialogGruppe("FusionIO"),e){if(lagDialogGruppe("FusionKodelager"),lagDialogTekst("Kode fra",!0),lagDialogKnapp("Nettleser","fuw_getbrowser",_vedVisIO_NL,"auto"),lagTipsElement("fuw_getbrowser","Kode i nettlesers lager"),lagDialogKnapp("Fil","fuw_getfile",_vedVisIO_Fil,"45px"),lagTipsElement("fuw_getfile","Kode på lokal maskin"),lagDialogKnapp("Snap","fuw_getsnap",hentkodesnap,"50px"),lagTipsElement("fuw_getsnap","Kode fra pin-kode"),lagDialogKnapp("Strøm","fuw_getstream",_vedVisIO_Strøm,"60px"),lagTipsElement("fuw_getstream","Hent fra kodestrøm"),lagDialogKnapp("Skolefag","fuw_lastAktivitet",_vedPopupBibliotek,"80px"),lagTipsElement("fuw_lastAktivitet","Hent kode fra skolens fagmappe."),lagDialogKnapp("Ressurs","fuw_lastRessurs",_vedPopupRessurs,"80px"),lagTipsElement("fuw_lastRessurs","Hente kode fra fulabs ressursmappe."),t&&(dialog.topp="FusionKodelager",lagDialogGruppe("FusionNettleser"),lagDialogLinjeskift(),lagDialogForklaring("Kodenavn"),lagDialogInput("standard","kodesett","text","150px"),lagDialogKnapp("+","fuw_nestekode","undefined","25px"),lagTipsElement("fuw_nestekode","Hent neste kode i nettlageret."),lagDialogKnapp("Vis liste","fuw_visliste"),lagTipsElement("fuw_visliste","Viser innholdet i nettlageret."),lagDialogKnapp("Hent","fuw_hentkode","undefined","50px"),lagTipsElement("fuw_hentkode","Hent kode med gitt navn."),lagDialogKnapp("Lagre","fuw_lagrekode","undefined","50px"),lagTipsElement("fuw_lagrekode","Lagrer kode med gitt navn."),lagDialogKnapp("Slett","fuw_slettkode","undefined","50px"),lagTipsElement("fuw_slettkode","Sletter kode med gitt navn."),lagKjørSjekk("_kjørScript1")),n){dialog.topp="FusionKodelager",lagDialogGruppe("FusionFil"),lagDialogLinjeskift();lagDialogFil("Kodefil",".fupy,.fujs,.fualgo,.js,.py","fuw_valgtfil",_vedLestKode),lagTipsElement("fuw_valgtfil","Les inn kode fra egen maskin."),lagKjørSjekk("_kjørScript2"),lagDialogKnapp("Last ned","lastnedId",_vedLagreSom,"70px"),lagTipsElement("lastnedId","Lagrer kode på egen maskin.")}kodestrøm=!0,kodestrøm&&(dialog.topp="FusionKodelager",lagDialogGruppe("FusionStrøm"),lagLinjeskift(),lagDialogForklaring("Kodestrøm"),lagDialogInput("","fuw_kodestrøm","text"),lagDialogKnapp("Åpne","fuw_orstream",orstream,"50px"),lagTipsElement("fuw_orstream","Åpner kodestrøm fra pin (spør lærer)."),lagDialogKnapp("Pause","fuw_pausestream",pastream,"50px"),lagTipsElement("fuw_pausestream","Pauser kodestrøm midlertidig."),lagDialogKnapp("Spill","fuw_playstream",plstream,"50px"),lagTipsElement("fuw_playstream","Starter kodestrøm etter pause."),lagDialogKnapp("Lukk","fuw_cstream",cstream,"50px"),lagTipsElement("fuw_cstream","Lukker kodestrømmen"),lagKjørSjekk("_kjørScript3")),idSynlighet("FusionFil","av"),idSynlighet("FusionStrøm","av"),idSynlighet("kjernev","av"),idSynlighet("konteinerKjernekode","av"),idSynlighet("kjerneh","av")}}function lagVinduEditor(e,t,n){var i;return dialog.topp="FusionEditorButtons",dialog.debug&&console.log("lagVinduEditor",dialog.topp),lagKjørSjekk("_kjørScript"),lagDialogKnapp("Fjern kode","_kjørScript",_vedKjørScript,"auto"),i=createEditor(e,t,n),"editor"==t&&(dialog.editor=i),"viewer"==t&&(dialog.viewer=i),i.resize(),idSynlighet(e,"på"),i}function lagKjørSjekk(e){"2.0"==versjonIDE||(lagDialogKnapp("Kjør kode",e,_vedKjørScript,"auto"),lagTipsElement(e,"Kjører koden i editoren (med autosave)."))}function lagVinduEditorKommandoer(){dialog.topp="FusionEditorButtons",lagDialogLinjeskift(),lagDialogTekst("kodeSnap",!0),lagDialogLinjeskift(),lagDialogKnapp("Lagre","fuw_gsnap",delkodesnapJSON,"80px"),lagTipsElement("fuw_gsnap","Lagres på personlig<br>pin-kode."),lagDialogLinjeskift(),lagDialogTekst("konverter",!0),lagDialogLinjeskift(),lagDialogKnapp("Py2JS","fuw_pyjs",editorPy2JS,"80px"),lagTipsElement("fuw_pyjs","Konverter til JavaScript."),lagDialogLinjeskift(),lagDialogKnapp("Tilbakestill","fuw_jspy",editorPy2JSRestore,"80px"),lagTipsElement("fuw_jspy","Tilbakestill <br>konvertering."),lagDialogLinjeskift(),lagDialogGruppe("FusionStream"),dialog.topp="FusionStream",lagDialogLinjeskift(),lagDialogTekst("kodeStrøm lærer"),lagDialogLinjeskift(),lagDialogKnapp(" Åpne ","fuw_open_sstream",osstream,"50px"),lagDialogKnapp(" Pause ","fuw_pause_sstream",passtream,"50px"),lagLinjeskift(),lagDialogKnapp(" Spill ","fuw_play_sstream",plsstream,"50px"),lagDialogKnapp(" Lukk ","fuw_close_sstream",csstream,"50px"),lagLinjeskift(),lagFeltT("fuw_pin_sstream","(ingen)",85),lagTipsElement("fuw_open_sstream","Kodestrøm for <br>skriving åpnes."),lagTipsElement("fuw_close_sstream","Lukkes <br>permanent."),lagTipsElement("fuw_pause_sstream","Settes <br>på pause."),lagTipsElement("fuw_play_sstream","Fortsetter<br> avspilling."),skjulKST(),hasP()}function lagVinduManual(){manual=dialog.manualer[dialog.manindeks],dialog.topp="FusionManual",lagDialogLinjeskift(),lagDialogTekst("Velg manual &nbsp &nbsp"),lagDialogValgliste("FusionManualValgliste",dialog.manualtekst,_vedValgliste),lagDialogLinjeskift(),lagDialogLinjeskift(),lagDialogRamme("FusionReferanseManual","Dokumentasjon",dialog.url+manual,"auto","auto"),dialog.manualramme="FusionReferanseManual",id("FusionManualValgliste").selectedIndex=dialog.manindeks}function lagDialogvindu(){id(dialog.topp).innerHTML="",idSynlighet(dialog.topp,"på")}function lagTegneflate(e="std",t="std"){var n=dialog.lerret,i=n[0],a=n[1];"std"!=e&&(i=e),"std"!=t&&(a=t),"undefined"==tegn.canvas?(dialog.topp="FusionTegning",lagVinduGrafikk("Grafikk","tegneflate",i,a,_vedMusklikk),canvas=tegnBrukCanvas("tegneflate")):(id("tegneflate").style.width=i,id("tegneflate").style.height=a),idSynlighet("FusionTegning","på"),tegnBrukBakgrunn("lightyellow"),no=dialog.lerretsområde,tegnBrukOmråde(no[0],no[1],no[2],no[3]),tegnAkser(),tegnTekst("Her er tegneflata til programmet",-6,-2)}function lagRammeverk(e){dialog.topp="FusionDialog",lagDialogOverskrift("Matematisk Funksjon"),lagDialogForklaring("f(x)="),lagDialogInput("0.5*x**2-5","matfunksjon","","200px"),lagDialogLinjeskift(),lagVinduGrafVerktøy(vedTegn),lagDialogLinjeskift(),lagDialogOverskrift("CSV-fil"),lagDialogFil("",".csv,.csvXY, .csvXYZ","fil",vedData),dialog.topp="FusionTegning";var t=dialog.lerret;lagVinduGrafikk("Grafikk","tegneflate",t[0],t[1],vedMusklikk),vedTegn&&vedTegn(),lagDialogLinjeskift(),lagDialogKommando("kommando",_vedKommando,"250px"),dialog.topp="FusionTegning",lagDialogKnapp("Rediger","script",_vedVisScript),lagDialogLinjeskift(),dialog.topp="FusionIDE",lagDialogLinjeskift(),dialog.editor=lagVinduEditor("FusionEditor","editor","python"),lagVinduKodeIO(!1,!1,!1),dialog.topp="FusionMeldinger",lagVinduKonsoll("Konsoll")}function lagRammeverkLesKjør(e){dialog.topp="FusionTopp",lagVinduKodeIO(!1,!1,!0),lagDialogKnapp("Editor","script",_vedVisScript),lagKjørSjekk("script"),dialog.topp="FusionMeldinger",lagVinduKonsoll("Meldingsvindu"),dialog.topp="FusionIDE",lagDialogLinjeskift(),dialog.editor=lagVinduEditor("FusionEditor","editor","python"),lagDialogLinjeskift(),idSynlighet("FusionIDE","av")}function id(e){return document.getElementById(e)}function idSynlighet(e,t){id(e)?"på"==t?(id(e).style.visibility="visible",id(e).style.display="inline",dialog.debug&&console.log(e,"på")):(id(e).style.visibility="hidden",id(e).style.display="none",dialog.debug&&console.log(e,"av")):dialog.debug&&console.log("idSynlighet: Ukjent idNavn=",e)}function visPopup(e){var t=event.clientX,n=event.clientY+20,i=id(e);i.style.left=t+"px",i.style.top=n+"px",i.style.display="block"}function skjulPopup(e){id(e).style.display="none"}function elementSynlighet(e,t){for(var n=0;n<e.length;n++){var i=e[n];id(i)?"på"==t?(id(i).style.visibility="visible",id(i).style.display="inline",dialog.debug&&dialog.debug&&console.log(i,"på")):(id(i).style.visibility="hidden",id(i).style.display="none",dialog.debug&&console.log(i,"av")):dialog.debug&&console.log("idSynlighet: Ukjent idNavn=",i)}}function _vedLukkIO(){idSynlighet("FusionNettleser","av"),idSynlighet("FusionFil","av"),idSynlighet("FusionStrøm","av")}function _vedVisIO_NL(){_vedLukkIO(),idSynlighet("FusionNettleser","på")}function _vedVisIO_Fil(){_vedLukkIO(),idSynlighet("FusionFil","på")}function _vedVisIO_Strøm(){_vedLukkIO(),idSynlighet("FusionStrøm","på")}function _vedLukkIDE(){idSynlighet("FusionIDE","av"),idSynlighet("FusionKjørKommando","av"),idSynlighet("FusionEditor","av"),idSynlighet("FusionKodeLagring","av")}function _vedKommando(){htmlMelding(">>"+id("kommando").value),eval(id("kommando").value)}function _vedVisScript(){idSynlighet("FusionIDE","på"),idSynlighet("FusionKjørKommando","på"),idSynlighet("FusionEditor","på"),idSynlighet("FusionKodeLagring","på"),dialog.editor.resize(),console.log("_vedVisScript","resize editor")}function _vedKjørScript(){dialog.debug&&console.log("Kjører koden.");var e=editor.session.getValue(),t={content:e};(new DataManager).writeAppData(appnavn,autosave,t),_reset_all(),e.startsWith("\x3c!--Fusion:fuhtml --\x3e")?createPageHTML():(isGraphics(e),runEditorCode(dialog.editor))}var classurl="<skole>/<mappe>",runFusionCode;function _vedPopupBibliotek(e=0){visPopup("popupBibliotek"),"undefined"!=resmappe1&&1!=e||updateResourcefolder(1)}function _vedPopupRessurs(){visPopup("popupRessurs"),"undefined"==resmappe0&&updateResourcefolder(0)}function _vedLastAktivitet(){var e=id("schoolId").value,t=resmappe1,n=id("ressursId_fag").value;classurl=e+"/"+t;var i="../skolemappe/"+e+"/kodestarter/"+t+"/"+n;sjekkFilServer(i)?(lesTekstfilServer(i,_vedLestKode),skjulPopup("popupBibliotek")):alert("Finner ikke "+e+"/"+t+"/"+n)}function _vedLastRessurs(){var e="../skolemappe/fusion/kodestarter/"+resmappe0+"/"+id("ressursId").value;sjekkFilServer(e)?(lesTekstfilServer(e,_vedLestKode),skjulPopup("popupRessurs")):alert("Finner ikke ressursen.")}function _vedLastAktivitet2(){visPopup("popupBibliotek")}function _vedLestKode(e){e.split("\n")[0].indexOf(":fujs")>0?setEditorMode("javascript"):setEditorMode("python"),dialog.kildekode=e,dialog.editor.session.setValue(e),dialog.editor.resize()}function _vedValgtAvkryssing(){var e=event.target.id,t=event.target.value;if(dialog.debug&&console.log("Knapp ",event.target.id,event.target.name,event.target.value),"LagerType"==e)0==t&&(dialog.debug&&console.log("Lokalt nettlager"),_vedLukkIO(),idSynlighet("FusionKodelager","på")),1==t&&(dialog.debug&&console.log("Lokal fil"),idSynlighet("FusionNettleser","av"),idSynlighet("FusionFil","på"),idSynlighet("FusionStrøm","av")),2==t&&(dialog.debug&&console.log("Kodestrøm"),idSynlighet("FusionNettleser","av"),idSynlighet("FusionFil","av"),idSynlighet("FusionStrøm","på"));else if("VisElementer"==e.split("_")[0]){t=e.split("_")[1];var n=id(e).checked;0==t?(n&&(dialog.debug&&console.log("Vis editor"),elementSynlighet(["konsoll","kodeeditor","kommandoer"],"på"),dialog.editor.resize()),n||(dialog.debug&&console.log("Skjul editor"),elementSynlighet(["konsoll","kodeeditor","kommandoer"],"av"))):2==t?(n&&(dialog.debug&&console.log("Vis tegneflate"),elementSynlighet(["dialog","canvas"],"på"),tegn.canvas.width=$("#konteinerTegning").width(),tegn.canvas.height=$("#konteinerTegning").height()),n||(dialog.debug&&console.log("Skjul tegneflate"),elementSynlighet(["dialog","canvas","funksjoner"],"av"))):1==t?(n&&(dialog.debug&&console.log("Vis IO"),_vedLukkIO(),elementSynlighet(["FusionIO"],"på")),n||(dialog.debug&&console.log("Skjul IO"),_vedLukkIO(),elementSynlighet(["FusionIO"],"av"))):4==t&&(n&&(dialog.debug&&console.log("Vis IO"),elementSynlighet(["FusionHTMLkonteiner"],"på")),n||(dialog.debug&&console.log("Skjul IO"),elementSynlighet(["FusionHTMLkonteiner"],"av")))}}function _vedLagreSom(){for(var e=dialog.editor.session.getValue(),t=dialog.sistefil.split("."),n="",i=0;i<t.length-1;i++)n+=t[i],i!=t.length-2&&(n+=".");""==n&&(n="fusion"),filtype="fupy",e.indexOf("Fusion:fualgo")>0&&(filtype="fualgo"),e.indexOf("Fusion:fujs")>0&&(filtype="fujs"),e.indexOf("Fusion:fupy")>0&&(filtype="fupy");var a=new Blob([e],{type:"text/plain;charset=utf-8"});if("??"==filtype)alert("Mangler du kodeordet Fusion:fujs eller tilsvarende ?");else{var r=prompt("Gi inn filnavn. Lagres i nedlastingsmappa di.",n+"."+filtype);r&&saveAs(a,r)}}function _vedValgliste(){"FusionManualValgliste"==event.target.id&&visManualside(dialog.url+dialog.manualer[event.target.selectedIndex])}function _vedMusklikk(){dialog.debug&&console.log(":vedMusklikk er dummy")}function vedTegning(){var e=dialog.kildekode,t=!1;e.indexOf("plot(")>=0&&(t=!0),e.indexOf("xlim(")>=0&&(t=!0),e.indexOf("ylim(")>=0&&(t=!0),e.indexOf("show(")>=0&&(t=!0),e.indexOf("tegnBruk")>=0&&(t=!0),e.indexOf("tegnLinje")>=0&&(t=!0),e.indexOf("tegnTekst")>=0&&(t=!0),t&&dialog.debug&&console.log("Oppretter automatisk ei tegneflate"),t&&"undefined"==tegn.canvas&&(tegn=new tegneverktøy,lagTegneflate()),t&&idSynlighet("FusionTegning","på"),t&&idSynlighet("tegneflate","på")}function visManualside(e){id(dialog.manualramme).src=e}function visFormatertSide(e){htmlMeldingSlett();for(var t=e.split("\n"),n=[],i=0;i<t.length;i++)j=t[i].indexOf("function "),i<7?htmlMelding(t[i]):j>=0&&(t[i]=t[i].replace("{"," "),k=t[i].indexOf(" _"),k>=0||j<2&&(n=t[i].split("//"),funknavn=n[0],funktext=n[1],htmlMelding(funknavn.substr(9)),htmlMelding("         //"+funktext)))}var aceAtt={};function getEdTheme(){var e,t=(new DataManager).readAppData("FusionProfile","profile");return e=t?t.themeEdit.toLowerCase():"iplastic",debug&&console.log("Editor theme:",e),e}function getEdLang(){var e,t=(new DataManager).readAppData("FusionProfile","profile");return"algo"==(e=t?t.mode.toLowerCase():"python")&&(e="python"),debug&&console.log("Editor language:",e),dialog.language=e,e}function getEdFont(){var e,t=(new DataManager).readAppData("FusionProfile","profile");return e=t?t.fontSize.toLowerCase():"14px",debug&&console.log("Editor font:",e),e}function getEdHead(){var e,t=(new DataManager).readAppData("FusionProfile","profile");return t?e=t.header:("javascript"==getEdLang()&&(e="// Fusion:fujs [Språk JavaScript - Koden kjøres i plattformen fulab.no ]"),"python"==getEdLang()&&(e="# Fusion:fupy [Språk Python - Koden kjøres i plattformen fulab.no ]"),"algo"==getEdLang()&&(e="# Fusion:algo [Språk Algo - Koden kjøres i plattformen fulab.no ]")),debug&&console.log("Editor head:",e),e}function createEditor(e,t="editor",n="javascript"){var i;return debug&&console.log("creatEditor:",n),i=ace.edit(e),"viewer"==t?(setAceOption(i),i.setTheme(aceAtt.themeView),i.setReadOnly(!0)):(3==arguments.length&&(aceAtt.mode="ace/mode/"+n.toLowerCase()),setAceOption(i),i.session.setValue(aceAtt.header),i.setTheme(aceAtt.themeEdit)),i.setShowPrintMargin(!0),i.resize(),dialog.editor=i,i}function setEditorMode(e){if("undefined"!=dialog.editor){lang=e.toLowerCase(),"algo"==lang&&(lang="python"),"fualgo"==lang&&(lang="python"),aceAtt.tabSize=2,"javascript"==lang&&(aceAtt.tabSize=4);lang;dialog.editor.setOptions({mode:"ace/mode/"+lang,tabSize:aceAtt.tabSize})}}function toggleInvisible(){aceAtt.showInvisible?dialog.editor.setOptions({showInvisibles:!1}):dialog.editor.setOptions({showInvisibles:!0}),aceAtt.showInvisible=!aceAtt.showInvisible}function toggleFolding(){aceAtt.folding?dialog.editor.session.unfold():dialog.editor.session.foldAll(),aceAtt.folding=!aceAtt.folding}function setAceOption(e){e.setOptions({selectionStyle:"text",highlightActiveLine:!1,highlightSelectedWord:!0,readOnly:!1,cursorStyle:"ace",mergeUndoDeltas:!0,behavioursEnabled:!1,wrapBehavioursEnabled:!0,autoScrollEditorIntoView:!0,keyboardHandler:null,animatedScroll:!1,displayIndentGuides:!0,showInvisibles:aceAtt.showInvisible,showPrintMargin:!0,printMarginColumn:120,printMargin:!1,showGutter:aceAtt.showGutter,fadeFoldWidgets:!0,showFoldWidgets:!0,showLineNumbers:!0,highlightGutterLine:!1,hScrollBarAlwaysVisible:!1,vScrollBarAlwaysVisible:!1,fontSize:aceAtt.fontSize,fontFamily:void 0,maxLines:aceAtt.maxLines,minLines:aceAtt.maxLines,maxPixelHeight:0,scrollPastEnd:0,fixedWidthGutter:!1,theme:aceAtt.themeEdit,scrollSpeed:2,dragDelay:0,dragEnabled:!0,focusTimeout:0,tooltipFollowsMouse:!0,firstLineNumber:1,overwrite:!1,newLineMode:"auto",useWorker:!0,useSoftTabs:!0,tabSize:aceAtt.tabSize,wrap:!1,indentedSoftWrap:!0,foldStyle:"markbegin",mode:aceAtt.mode})}function editorPy2JS(){var e=editor.session.getValue();if(e.indexOf("Fusion:fujs")>0)print("Koden er allerede JavaScript");else{localStorage.setItem("fusion_pyJS_restore",JSON.stringify(e)),e+="\n//Py2JS";var t=new FusionJs,n=e.split("\n");t.addFusionCode(n);var i=t.convertLanguage();setEditorMode("javascript"),editor.session.setValue(i)}}function editorPy2JSRestore(){var e=localStorage.getItem("fusion_pyJS_restore");e&&(e=JSON.parse(e),setEditorMode("python"),editor.session.setValue(e),localStorage.removeItem("fusion_pyJS_restore"))}function runEditorCode(e,t="undefined"){var n=e.session.getValue()+"\n//Fusion kode avsluttet",i=new FusionJs,a=n.split("\n");i.addFusionCode(a),dialog.language=i.getLanguage();var r=i.convertLanguage(),o=i.loadLibs();function l(){dialog.turtle&&turtledefaults(),dialog.turtle=!1,"undefined"!=t?t.session.setValue(r):id("viewer").value=r;var e=i.createFunctionJS();if(!e)return print("Syntaks feil i koden."),console.log(i.errorObject),void(id("meldinger").style.backgroundColor="orange");if(!i.abort){lagDialog();try{document.getElementById("tegning").onclick=fuWebMouseClick,tegnBrukOmråde(.1,.9,.1,.9),dialog.tegnefunksjon=e,dialog.tegnekjerne=e,tegnBrukBakgrunn(),pyplots=-1,e(),filEndret&&"FusionKurs"==appnavn&&(lagreKodesnuttMin(),filEndret=!1),id("meldinger").style.backgroundColor="white",print("\nProgrammet er ferdig.")}catch(e){dialog.errstack=e;var n,a="\nFeil ved kjøring av "+dialog.language+" koden.";if(a=a+"  ["+e.name+"]\n","ReferenceError"==e.name){a=a+"\nUkjent funksjon eller variabel: "+(l=e.stack.split(" "))[1]+"\n";var o=errLineCol(e.stack);"javascript"==dialog.language&&(a=a+"Sjekk linje "+o[0]+" og kolonne "+o[1]+"\n"),n=a+="\nRett opp og prøv igjen :-) \n"}if("TypeError"==e.name){var l;"Cannot"==(l=e.stack.split(" "))[1]?(a+="\nFeil datatype ",a+=e.stack):a=a+"\nFeil datatype: "+l[1]+"\n";o=errLineCol(e.stack);"javascript"==dialog.language&&(a=a+"Sjekk linje "+o[0]+" og kolonne "+o[1]+"\n"),n=a}id("meldinger").style.backgroundColor="magenta",print(a),alert(n),console.error(e)}dialog.verdenskoordinater[0]=tegn.Vx1,dialog.verdenskoordinater[1]=tegn.Vx2,dialog.verdenskoordinater[2]=tegn.Vy1,dialog.verdenskoordinater[3]=tegn.Vy2,id("_tegnVx1")&&(id("_tegnVx1").value=tegn.Vx1.toFixed(dialog.avrundingX),id("_tegnVx2").value=tegn.Vx2.toFixed(dialog.avrundingX),id("_tegnVy1").value=tegn.Vy1.toFixed(dialog.avrundingY),id("_tegnVy2").value=tegn.Vy2.toFixed(dialog.avrundingY))}}htmlMeldingSlett(),skriv("\nKjører programmet  ==>\n"),o||dialog.csvloaded?(console.log("Venter litt på innlasting av serverdata..."),setTimeout(l,500)):l()}function errLineCol(e){var t=e.indexOf("<anonymous>:");if(t<0)return"";var n=e.substring(t+12,t+16),i=(n=(n=(n=n.replace(")"," ")).replace(":"," ")).trimStart()).split(" ");return[parseInt(i[0])-2,parseInt(i[1])]}async function runProgram(){var e="",t=dialog.editor.session.getValue()+"\n//Fusion kode avsluttet",n=new FusionJs,i=t.split("\n");n.addFusionCode(i);n.convertLanguage();e=n.createFunctionJS(),console.log(e);let a=new Promise((e,t)=>{n.loadLibs()&&e("libs_ok")});await a,e();let r=new Promise((t,n)=>{e()&&t("run_ok")});Promise.all([a,r]).then(e=>{alert(e)})}aceAtt.themeEdit="ace/theme/"+getEdTheme().toLowerCase(),aceAtt.themeView="ace/theme/twilight",aceAtt.header=getEdHead(),aceAtt.tabSize=2,aceAtt.showInvisible=!1,aceAtt.folding=!1,aceAtt.fontSize=getEdFont(),"javascript"==getEdLang().toLowerCase()&&(aceAtt.tabSize=4),aceAtt.mode="ace/mode/"+getEdLang().toLowerCase(),aceAtt.maxLines=500,aceAtt.minLines=25,aceAtt.showGutter=!0;var snapPath="../deltkode/";function delkodesnapJSON(){var e=snapPath+"lagreKodesnuttJSON.php",t=editor.session.getValue(),n=JSON.stringify(t);if(confirm("Dele kodesnap via anonym PIN-kode?")){var i={mappe:snapPath+"snap/",kode:t},a=(n=JSON.stringify(i),new XMLHttpRequest);a.onreadystatechange=function(){4===a.readyState&&200===a.status&&(pin=JSON.parse(a.responseText),print("PIN for kodesnap:",pin),alert("PIN for kodesnap:"+pin))},a.open("POST",e),a.setRequestHeader("Content-Type","application/json"),a.send(n)}}function hentkodesnap(){var e=snapPath+"/snap/",t=prompt("Laster inn kode fra en snap. \nHusk at innholdet i editoren blir sletta... Har du lagra? \nGi PIN-koden til kodesnappen (6 siffer) om du vil fortsette.");if(t){var n=e+"ksnap-"+t;sjekkFilServer(n)?(id("kodesett").value="ks-"+t,lesTekstfilServer(n,visKodesnutt)):alert("Finner ikke kodeSnap")}}var streamName="test",streamKey="",streamPlay=!1,streamFrames=5,streamOldCode="",streamOldCodeSend="";function _init_stream(){streamName="test",streamKey="",streamPlay=!1,streamFrames=5,streamOldCode="",streamOldCodeSend=""}function osstream(){if(streamKey&&!confirm("Dette lukker kodestrømmen permanent.\nFortsette?"))return;clearInterval(streamKey),streamName=randint(1e5,999999),streamKey=setInterval(sstream,1e3/streamFrames),print("Åpner kodestrøm med id",streamName),id("fuw_pin_sstream").value=streamName+" (sender)",streamPlay=!0,streamOldCode=""}function passtream(){""!=streamKey?(streamPlay=!1,print("Pauser kodestrømmen."),id("fuw_pin_sstream").value=streamName+" (pause)"):alert("Ingen kodestrøm er åpen.")}function plsstream(){""!=streamKey?(streamPlay=!0,print("Sender kodestrømmen igjen."),id("fuw_pin_sstream").value=streamName+" (sender)",streamOldCode=""):alert("Ingen kodestrøm er åpen.")}function csstream(){""!=streamKey?(clearInterval(streamKey),print("Lukker kodestrøm."),streamPlay=!1,streamKey="",id("fuw_pin_sstream").value=" (ingen)"):alert("Ingen kodestrøm er åpen.")}function sstream(){if(streamPlay){var e=snapPath+"lagreStreamJSON.php",t=editor.session.getValue();if(t!=streamOldCode){var n=JSON.stringify(t),i={stream:snapPath+"stream/gs-"+streamName,kode:t},a=(n=JSON.stringify(i),new XMLHttpRequest);a.onreadystatechange=function(){4===a.readyState&&200===a.status&&(pin=JSON.parse(a.responseText))},a.open("POST",e),a.setRequestHeader("Content-Type","application/json"),a.send(n),streamOldCode=t}}}function orstream(){(clearInterval(streamKey),streamName=id("fuw_kodestrøm").value,Number(streamName)<1e5||Number(streamName)>999999)?alert("Ulovlig verdi for kodestrøm-koden. Koden må du få av læreren."):confirm("Hvis du åpner kodestrømmen, overskrives alt du har i Kodeeditor. \nFortsette likevel?")&&(streamKey=setInterval(gstream,1e3/streamFrames),print("Åpner kodestrøm ",streamName),streamPlay=!0,streamOldCode="")}function cstream(){""!=streamKey?(clearInterval(streamKey),print("Lukker kodestrøm."),streamPlay=!1):print("Close:Ingen kodestrøm er åpen."),streamOldCode=""}function gstream(){streamPlay&&lesTekstfilServer(snapPath+"/stream/gs-"+streamName,visKodeStream)}function pastream(){""!=streamKey?(streamPlay=!1,print("Pauser kodestrømmen.")):print("Pause:Ingen kodestrøm er åpen.")}function plstream(){""!=streamKey?(streamPlay=!0,print("Spiller kodestrømmen igjen.")):print("Play:Ingen kodestrøm er åpen.")}function hasP(){var e=(new DataManager).readAppData("FusionProfile","aksess");2==e.length&&chkPre(e[0],e[1],visKST)}function chkPre(e,t,n){var i={school:e,pwd:t};debug&&console.log("chkAccess:",i.school);var a=JSON.stringify(i),r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState&&200===r.status){debug&&console.log("_chkAccess:"+r.responseText);var e=JSON.parse(r.responseText);access=e,e&&n()}},r.open("POST","../fulibs/php/sjekkAksess.php"),r.setRequestHeader("Content-Type","application/json"),r.send(a)}function visKST(){idSynlighet("FusionStream","på")}function skjulKST(){idSynlighet("FusionStream","av")}function turtledefaults(){}function _reset_all(){_init_dialog(),_init_stream()}function isGraphics(e){if(id("VisElementer_3").checked){var t=!1;e.indexOf("tegnGraf")>=0&&(t=!0),e.indexOf("tegnBruk")>=0&&(t=!0),e.indexOf("tegnKurve")>=0&&(t=!0),e.indexOf("tegnLinje")>=0&&(t=!0),e.indexOf("tegnTekst")>=0&&(t=!0),e.indexOf("plot(")>=0&&(t=!0),e.indexOf("show(")>=0&&(t=!0),e.indexOf("plotCSV")>=0&&(t=!0),e.indexOf("lagDialog")>=0&&(t=!0);for(var n=e.split("\n"),i=0;i<n.length;i++)n[i].startsWith("tegn")&&(t=!0);visDivCanvas(t)}}function visDivCanvas(e){e&&(dialog.debug&&console.log("Vis tegneflate"),elementSynlighet(["dialog","canvas"],"på"),tegn.canvas.width=$("#konteinerTegning").width(),tegn.canvas.height=$("#konteinerTegning").height(),id("VisElementer_2").checked=!0),e||(dialog.debug&&console.log("Skjul tegneflate"),elementSynlighet(["dialog","canvas","funksjoner"],"av"),id("VisElementer_2").checked=!1)}function lagDialog(){dialog.topp="FusionDialog",lagDialogvindu()}function lagOverskrift(e){lagDialogOverskrift(e)}function lagForklaring(e,t="200",n=!1){lagDialogForklaring(e,n,t)}function lagTekst(e,t=!1){lagDialogTekst(e,t)}function lagFeltH(e,t,n="standard"){lagDialogInput(t,e,"udefinert",n)}function lagFeltD(e,t,n="standard"){lagDialogInput(t,e,"udefinert",n)}function lagFeltT(e,t,n="standard"){lagDialogInput(t,e,"udefinert",n)}function lagKnapp(e,t,n,i="auto"){lagDialogKnapp(t,e,n,i)}function lagTipsElement(e,t){var n=e,i=id(n).innerHTML;id(n).className="tooltip",i=i+"<span class= 'tooltiptext'>"+t+"</span>",id(n).innerHTML=i}function lagGlider(e,t,n,i,a,r=.1,o="udefinert",l="udefinert"){lagDialogGlider(t,e,n,i,a,r,o,l)}_reset_all();var fuDialogMelding="dialogkonsoll";function lagMeldingsvindu(e,t){var n=document.createElement("textarea");return n.id=fuDialogMelding,n.style.color=dialog.tekstfarge,n.cols=e,n.rows=t,n.style.margin=dialog.marg,lagTekst("<br>Meldinger<br>",!0),id(dialog.topp).appendChild(n),lagLinjeskift(),lagKnapp(fuDialogMelding+"btn","Slett",clearMelding),lagLinjeskift(),n}function printMelding(e){for(var t="",n=0;n<arguments.length;n++)t=t+" "+arguments[n];document.getElementById(fuDialogMelding)&&(id(fuDialogMelding).innerHTML=id(fuDialogMelding).innerHTML+"\n"+t)}function clearMelding(){document.getElementById(fuDialogMelding)&&(id(fuDialogMelding).innerHTML="\n")}function lagLinjeskift(e=1){lagDialogLinjeskift(e)}function lagHTML(e,t){var n=document.createElement("span");n.id=e,n.style.color=dialog.tekstfarge,n.innerHTML=t,id(dialog.topp).appendChild(n)}function lagFraHTML(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){var e;if(4===t.readyState&&200===t.status){e=t.responseText;var n=document.createElement("span");n.innerHTML=e,id(dialog.topp).appendChild(n)}else 4===t.readyState&&404===t.status&&alert("Finner ikke innhold fra "+urlFusion)};var n="?rand="+Math.floor(1001*Math.random());urlFusion=libPath("html",e),t.open("GET",urlFusion+n,!0),404===t.status&&print("Finner ikke innhold fra "+urlFusion),t.send()}function lagLesFil(e,t,n,i="fuLesData"){lagTekst(e),lagLinjeskift(1),lagDialogFil("",t,i,n)}function lagLagreFil(e,t,n="fuLagreData"){lagLinjeskift(1),lagTekst(e),lagDialogKnapp("Last ned",n,function(){var e=t(),n=new Blob([e],{type:"text/plain;charset=utf-8"}),i=prompt("Gi inn navnet på fila du vil lagre. \nDen vil lagres i nedlastingsmappa di.","fil.txt");i&&saveAs(n,i)},"70px")}function hentFeltH(e){var t=document.getElementById(e);return t?parseInt(t.value):(fusionError("hentFeltH: Feil navn på skriv-inn-felt: "+e),-99999)}function hentFeltD(e){var t=document.getElementById(e);return t?parseFloat(t.value):(fusionError("hentFeltD: Feil navn på skriv-inn-felt: "+e),-99999)}function hentFeltT(e){var t=document.getElementById(e);return t?t.value:(fusionError("hentFeltT: Feil navn på skriv-inn-felt"+e),-99999)}function settVerdi(e,t){id(e).value=t}function settHTML(e,t){document.getElementById(e).innerHTML=t}function hentVerdi(e){var t=document.getElementById(e);return t?parseFloat(t.value):(fusionError("hentVerdi: Feil navn på skriv-inn-felt"+e),-99999)}function oppdaterFeltH(e,t){document.getElementById(e);if(!htmlkomponent)return fusionError("oppdaterFeltH: Feil navn på skriv-inn-felt"),-99999;htmlkomponent.value=int(t)}function oppdaterFeltD(e,t){document.getElementById(e);if(!htmlkomponent)return fusionError("oppdaterFeltD: Feil navn på skriv-inn-felt"),-99999;htmlkomponent.value=t}function oppdaterFeltT(e,t){document.getElementById(e);return htmlkomponent?htmlkomponent.value:(fusionError("oppdaterFeltT: Feil navn på skriv-inn-felt"),-99999)}function fusionError(e){console.log("Feil ",e),skriv("Feil ",e)}function createPageHTML(){id("FusionHTML").innerHTML=editor.session.getValue()}var _csvnavn=[],_csvdata=[],_csvcols=[],_csvrows=[],_csvseparator=";",_csvinfolinjer=2;_csvinfokolonner=0;var _csvindeks=0;async function lastTekstfil(e){var t=e,n=randint(1,1e3),i=finnFilnavnDatasett(t);let a=await fetch(i+"?version="+n),r=await a.text();return r.indexOf("<!DOCTYPE HTML")>=0?(print("Feil ved innlasting av serverfil "+i+"."),-99):(_csvnavn[_csvnavn.length]=t,_csvdata[_csvdata.length]=r,print(t+" lasta inn."),brukForslagSkilletegn(t),_csvdata.length-1)}async function lastDatafilCSV(e){_csvinfolinjer=2;let t=await lastTekstfil(e);for(var n,i=0;i<5;i++)if(sleep(.1),(n=_finnCSVindeks(e,!1))>=0)return n;return t}function hentDatasett(e){var t=_finnCSVindeks(e);return t>=0?_csvdata[t]:(print("Finner ikke data i datasettet",e+"."),[])}function slettDatalager(){_csvnavn=[],_csvdata=[]}function infolinjerCSV(e){_csvinfolinjer=e}function finnSkilletegnCSV(e){for(var t=hentInnholdCSV(e).split("\n"),n=t[Math.ceil(t.length/2)].trim(),i="?",a=0;a<n.length;a++)","==n[a]&&(i=","),":"==n[a]&&(i=":"),";"==n[a]&&(i=";"),"!"==n[a]&&(i="!"),"|"==n[a]&&(i="|");return i}function brukSkilletegnCSV(e){_csvseparator=e}function brukForslagSkilletegn(e){brukSkilletegnCSV(finnSkilletegnCSV(e))}function hentTittelCSV(e){var t=_finnCSVindeks(e);if(t>=0){_csvdata[t];return _csvdata[t].split("\n")[0].split(_csvseparator)[0]}return print("Finner ikke data i angitt fil."),[]}function hentKolonnetekstCSV(e){var t=_finnCSVindeks(e);if(t>=0){_csvdata[t];return trimArrayCSV(_csvdata[t].split("\n")[1].split(_csvseparator))}return print("Finner ikke data i angitt fil."),[]}function hentLinjerCSV(e){var t=_finnCSVindeks(e);if(startlinje=_csvinfolinjer,t<0)return print("Finner ikke data i angitt fil"),[];_csvdata[t];for(var n=_csvdata[t].split("\n"),i=[],a=0,r=startlinje;r<n.length;r++)i[a]=n[r],a+=1;return i}function hentTabelldataCSV(e){var t=_finnCSVindeks(e);if(startlinje=_csvinfolinjer,t<0)return print("Finner ikke data for angitt fil"),[];for(var n=_csvdata[t].split("\n"),i=[],a=0,r=startlinje;r<n.length;r++)n[r].length>0&&(n[r]=n[r].trim(),n[r]=n[r].replace(" ",""),i[a]=n[r],a++);for(var o=[],l=i[0].split(_csvseparator),s=0;s<l.length;s++){o[s]=[];for(var g=0;g<i.length;g++)o[s][g]=0}_csvcols[t]=l.length,_csvrows[t]=i.length,_csvindeks=t;for(var d=0;d<i.length;d++)for(l=i[d].split(_csvseparator),k=0;k<l.length;k++)o[k][d]=l[k];return o}function hentKolonneCSV(e,t,n=!0){for(var i=hentTabelldataCSV(e),a=[],r=_csvindeks,o=0;o<_csvrows[r];o++)a[o]=n?Number(i[t][o]):i[t][o];return a}function hentRadCSV(e,t,n=!0,i=0){for(var a=hentTabelldataCSV(e),r=[],o=_csvindeks,l=0,s=i;s<_csvcols[o];s++)r[l]=n?Number(a[s][t]):a[s][t],l++;return r}function hentXverdierCSV(e){return hentKolonneCSV(e,0,!0)}function hentYverdierCSV(e){return hentKolonneCSV(e,1,!0)}function hentZverdierCSV(e){return hentKolonneCSV(e,2,!0)}var _csv_desX=0,_csv_desY=1;function csvPlotOpsjoner(e,t){_csv_desX=e,_csv_desY=t}function plotCSVdataXY(e,t=!0,n="white",i="red",a="blue",r="x"){var o=e;if(_finnCSVindeks(o,!1)<0)print("Datasett",o,"ikke lasta inn.");else{var l=hentXverdierCSV(o),s=hentYverdierCSV(o);if(t){tegnBrukDatasett(l,s),""==n&&"ingen"!=n||tegnBrukBakgrunn(n),enheter=hentKolonnetekstCSV(o);var g=hentTittelCSV(o).split(_csvseparator)[0];tegnAkser(enheter[0],enheter[1],_csv_desX,_csv_desY),tegnTittel(g)}tegnKurve(l,s,i,"strek",2),l.length<50&&tegnMarkørliste(l,s,r,a)}}function plotCSVkurver(e,t=0,n=[1],i=!0,a="white"){var r=e,o=["red","green","blue","orange","yellow","brown","black","magenta"],l=hentXverdierCSV(r),s=hentKolonnetekstCSV(r),g=[];if(_finnCSVindeks(r,!1)<0)print("Datasett",r,"ikke lasta inn.");else{hentTabelldataCSV(r);if(i){for(var d=1e20,u=1e-20,f=min(l),p=max(l),c=0;c<n.length;c++)d=min(g=hentKolonneCSV(r,n[c]),d),u=max(g,u);tegnBrukXY(f,p,d,u+.2*abs(u-d)),""==a&&"ingen"!=a||tegnBrukBakgrunn(a);var h=s[1];n.length>1&&(h="");tegnHentXY();tegnAkser(s[0],h,_csv_desX,_csv_desY),tegnTittel(hentTittelCSV(r))}var v=[],k=[],m=0;for(c=0;c<n.length;c++)g=hentKolonneCSV(r,n[c]),m>=o.length&&(m=0),tegnKurve(l,g,o[m],"strek",2),v.push(s[n[c]]),k.push(o[m]),m+=1;n.length>0&&tegnForklaring(v,k,!0)}}function syntetiskCSVfunksjon(e,t,n,i,a=2,r=3,o=";",l="Testdata CSV-format"){var s=l+"\n",g="x "+o+" y \n",d="";for(x=t;x<=n;x+=i)y=e(x),d=x+i<=n?d+x.toFixed(a)+" "+o+" "+y.toFixed(r)+"\n":d+x.toFixed(a)+" "+o+" "+y.toFixed(r);return s+g+d}function adderDatasett(e,t){var n=_csvdata.length,i=_finnCSVindeks(t,!1);-1==i?(_csvdata[n]=e,_csvnavn[n]=t):confirm("Datasett eksisterer fra før. Vil du erstatte med nye data?")&&(_csvdata[i]=e)}function printDatasett(e){var t=_finnCSVindeks(e,!1);-1==t?print("Fant ikke datasett",e,"som  skulle skrives ut..."):print("\n"+_csvdata[t])}function printCSV(e){fil=e,print("ANALYSE AV CSVFIL: "+fil),print("Skilletegn:  "+finnSkilletegnCSV(fil)),print("Header:"),print(hentTittelCSV(fil)),print("Kolonner:");for(var t=hentKolonnetekstCSV(fil),n=0;n<t.length;n++)print(n,"\t",t[n]);print("Datalinjer (maks 50)");var i=hentLinjerCSV(fil);for(n=0;n<min(50,i.length);n++)print(i[n])}function lagreDatafilCSV(e,t,n="fuLagreCSVData"){lagLinjeskift(1),lagTekst(e,!0),lagLinjeskift(1),lagTekst("Datasett"),lagFeltT(n+"_datasett",t,"150px"),lagLinjeskift(1),lagTekst("Filnavn "),lagFeltT(n+"_filnavn",t+".csv","150px"),lagLinjeskift(1),lagDialogKnapp("Last ned",n,function(){fildata=hentDatasett(t);var e=new Blob([fildata],{type:"text/plain;charset=utf-8"}),i=hentFeltT(n+"_filnavn"),a=prompt("Gi inn navnet på fila du vil lagre. \nDen vil lagres i nedlastingsmappa di.",i);a&&saveAs(e,a)},"70px"),id(n+"_datasett").onchange=function(){var e=hentFeltT(n+"_datasett");settVerdi(n+"_filnavn",e+".csv")}}function lesDatafilCSV(e,t,n="*.*",i="fuLesCSVData"){lagLinjeskift(1),lagTekst(e,!0),lagLinjeskift(1),lagDialogFil("",n,i,function(e){adderDatasett(e,t),printMelding(hentTittelCSV(t)),brukForslagSkilletegn(t)}),lagLinjeskift(1),lagTekst("Datasett"),lagFeltT(i+"_datasett",t,"150px"),lagLinjeskift(1)}function getDataLS(e){return localStorage.getItem("fulab_data_LS/"+e+".dat")?localStorage.getItem("fulab_data_LS/"+e+".dat"):(print("Datasett",e,"finnes ikke."),"")}function saveDataLS(e,t){localStorage.setItem("fulab_data_LS/"+e+".dat",t)}function addLineLS(e,t){var n=getDataLS(e);saveDataLS(e,n=n+"\n"+t)}function removeDataLS(e){localStorage.removeItem("fulab_data_LS/"+e+".dat")}function isDataLS(e){return!!localStorage.getItem("fulab_data_LS/"+e)}function lagDataCSV(e,t,n,i,a=2,r=3,o=";"){var l="x "+o+" y \n",s="";for(x=t;x<=n;x+=i)y=e(x),s=s+x.toFixed(a)+" "+o+" "+y.toFixed(r)+"\n";return print("Følgende CSV-data er produsert:\n"),print("CSV Testdata \n"+l+s),"CSV Testdata \n"+l+s}function trimArrayCSV(e){for(var t=0;t<e.length;t++)e[t]=e[t].trim();return e}function _finnCSVindeks(e,t=!1){for(var n=0;n<_csvnavn.length;n++)if(e==_csvnavn[n])return n;return t&&print("Fant ikke CSV-data for:",e),-1}function finnFilnavnDatasett(e){var t;if(e.startsWith("https://")||e.startsWith("http://")||e.startsWith("./"))t=e,console.log("Laster inn",t);else if("fulibs/"==e.substr(0,7))t="../"+e,console.log("Laster dynamisk fra fulibs",t);else if(e.indexOf("../fulibs/")>=0)t="./"+e,console.log("Laster dynamisk fra fulibs",t);else{var n=e.split("/");3==n.length&&(t=libhome+n[0]+"/data/"+n[1]+"/"+n[2]),4==n.length&&(t=libhome+e),console.log("Laster inn fra skolebibliotek",t)}return t}function hentInfoCSV(e){var t=_finnCSVindeks(e);if(antallLinjer=_csvinfolinjer,t>=0){for(var n=_csvdata[t].split("\n"),i=[],a=0;a<antallLinjer;a++)i[a]=n[a];return i}return print("Finner ikke informasjonslinjer i angitt fil."),[]}function lesTekstfil(e,t){e.indexOf("https:")>=0?lesTekstfilServer(e,t):lesTekstfilLokal(e,t)}function getDataURL(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){var i;4===n.readyState&&200===n.status?(i=n.responseText,t(i)):4===n.readyState&&404===n.status&&print("Finner ikke data:",e)},n.open("GET",e,!0),404===n.status&&print("Ingen data returnert"),n.send()}var counter=1e4;function lesTekstfilServer(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){var i;4===n.readyState&&200===n.status?(i=n.responseText,t(i)):4===n.readyState&&404===n.status&&(""!=streamKey?(cstream(),alert("Fant ikke kodestrømmen...")):print("Finner ikke datafil",e))};var i="?count="+counter;counter+=1,n.open("GET",e+i,!0),404===n.status&&print("Fant ikke filen."),n.send()}function lesTekstfilLokal(e,t){var n=e[0],i=new FileReader;i.onload=function(e){var n=e.target.result;t(n)},i.readAsText(n)}function lagObjektXY(e,t=","){var n,i,a,r=[],o=[];i=(n=e.split("\n")).length;for(var l=0;l<i;l++){var s=n[l].split(t);0==l?a=n[l]:1==l?enheter=s:(r[l-2]=Number(s[0]),o[l-2]=Number(s[1]))}return{info:a,enheter:enheter,x:r,y:o}}function lagTekstlinjer(e){return e.split("\n")}function sjekkFilServer(e){return 404!=jQuery.ajax({type:"HEAD",url:e,async:!1}).status}function lagLagreCSV(e,t,n="fuLagreData"){lagLinjeskift(1),lagTekst(e),lagLinjeskift(1),lagDialogKnapp("Last ned",n,function(){var e=t(),i=new Blob([e],{type:"text/plain;charset=utf-8"}),a=hentFeltT(n+"navn"),r=prompt("Gi inn navnet på fila du vil lagre. \nDen vil lagres i nedlastingsmappa di.",a);r&&saveAs(i,r)},"70px"),lagFeltT(n+"navn","fil.csv","150px")}function hentInnholdCSV(e){var t=_finnCSVindeks(e);return t<0?(print("Finner ikke data i angitt fil"),""):_csvdata[t]}function plotCSVkurverTST(e,t=1,n=0,i=0,a=[1],r=!0,o="white"){var l,s=e,g=["red","green","blue","orange","yellow","brown","black","magenta"],d=[];if(1==t&&(d=hentKolonneCSV(s,n,!0),l=hentKolonnetekstCSV(s)),2==t&&(d=hentRadCSV(s,n,!0,i),l=hentKolonneCSV(s,0,!1,i)),1==t||2==t){var u=[];if(console.log("xdata",d),console.log("enheter",l),r){for(var f=1e20,p=1e-20,c=min(d),h=max(d),v=0;v<a.length;v++)1==t&&(u=hentKolonneCSV(s,a[v],!0)),2==t&&(u=hentRadCSV(s,a[v],!0,i)),f=min(u,f),p=max(u,p);tegnBrukXY(c,h,f,p+.2*abs(p-f)),""==o&&"ingen"!=o||tegnBrukBakgrunn(o);var k=l[1];a.length>1&&(k="");tegnHentXY();tegnAkser(l[n],k,_csv_desX,_csv_desY),tegnTittel(hentTittelCSV(s))}var m=[],y=[],x=0;for(v=0;v<a.length;v++)1==t&&(u=hentKolonneCSV(s,a[v],!0)),2==t&&(u=hentRadCSV(s,a[v],!0,i)),tegnKurve(d,u,g[x],"strek",2),m.push(l[a[v]]),y.push(g[x]),(x+=1)>=g.length&&(x=0);a.length>0&&tegnForklaring(m,y,!0)}else alert("Feil i plotCSVkurver. Sett colrow 0 for kolonne eller 1 for rad")}class FusionJs{constructor(){this.lang="python",this.tab=[],this.jsCode="",this.fuCode="",this.jsString,this.errorObject="",this.fulibs=[],this.spaces=4,this.debug=!1,this.mathJS=!1,this.error=!1,this.errmsg="",this.abort=!1}addFusionCode(e){this.fuCode=e,this.jsCode=e,this.spaceTabs(),this.createTabTable(),this.lang=this.getLanguage(),setEditorMode(this.lang)}showCode(e=""){if(this.debug&&"def"==e){console.log("Source Code after ",e);for(var t=0;t<this.fuCode.length;t++)console.log(t,this.fuCode[t]);console.log("Converted Code:");for(t=0;t<this.jsCode.length;t++)console.log(t,this.jsCode[t])}}getLanguage(){for(var e,t="python",n=0;n<this.fuCode.length;n++)(e=this.fuCode[n]).indexOf("Fusion:fualgo")>=0&&(t="fualgo"),e.indexOf("Fusion:fujs")>=0&&(t="javascript");return t}convertLanguage(){var e;return"python"==this.lang?e=this.convertPyJS():"algo"==this.lang||"fualgo"==this.lang?e=this.convertFualgoJS():"javascript"==this.lang?e=this.convertFujsJS():console.log("Error in convertLanguage:",this.lang),this.jsString=e,e}convertFujsJS(){this.replaceHeader(),this.replaceKaaresImport();for(var e="",t=0;t<this.fuCode.length;t++)this.jsCode[t]=this.fuCode[t],e=e+this.jsCode[t]+"\n";return this.jsString=e,e}convertPyJS(){this.pylint(),this.replaceFusionHead(),this.replaceIF(),this.replaceDEF(),this.replaceForInRange(),this.replaceForWithKeys(),this.replaceWhile(),this.replaceKaaresImport(),this.replacePackage(),this.replaceImport(),this.replaceLogicalThings(),this.replaceArrayMethods(),this.replaceImportAsPrefix(),this.replacePrintLiteral(),this.insertCloseBrackets(),this.replaceComments(),this.replaceHeader();for(var e="",t=0;t<this.jsCode.length;t++)e=e+this.jsCode[t]+"\n";return this.jsString=e,this.jslint(e,"pylint"),e}convertFualgoJS(){this.replaceFusionHead(),this.replaceLogicalThingsPseudo(),this.replaceHVIS(),this.replaceKaaresImport(),this.replacePROSEDYRE(),this.replaceRETUR(),this.replaceForInInterval(),this.replaceREPETER(),this.insertCloseBrackets(),this.replaceComments(),this.replaceHeader();for(var e="",t=0;t<this.jsCode.length;t++)e=e+this.jsCode[t]+"\n";return this.jsString=e,e}pylint(){var e,t;this.error=!1,this.abort=!1,this.errmsg="";for(var n=!1,i=0;i<this.fuCode.length;i++)(e=this.fuCode[i].trim()).startsWith("/*")&&(n=!0),e.startsWith("*/")&&(n=!1),n||(t=e.split("#")[0]).startsWith("#")||((t.startsWith("if ")||t.startsWith("for ")||t.startsWith("while ")||t.startsWith("def "))&&t.indexOf(":")<0&&(this.errmsg=this.errmsg+"Linje "+(i+1)+":   Mangler : (kolon) i kodelinje.\n",this.error=!0,this.abort=!0),this.balanceRB(t)||(this.errmsg=this.errmsg+"Linje "+(i+1)+":   Forskjellig antall av ( og ) i kodelinje.\n",this.error=!0),this.balanceSB(t)||(this.errmsg=this.errmsg+"Linje "+(i+1)+":   Forskjellig antall av [ og ] i kodelinje. \n",this.error=!0),this.balanceHT(t)||(this.errmsg=this.errmsg+"Linje "+(i+1)+":   Forskjellig antall hermetegn i kodelinje. \n",this.error=!0))}jslint(e,t){var n,i=!1,a=0,r=0,o=!1,l=e.split("\n");this.errmsg=this.errmsg+"\nPass - 2 Inspeksjon av JS-koden\nSyntaksfeil/advarsel funnet fra "+t+"@Fusion:\n\n";for(var s=0;s<l.length;s++)(n=(n=l[s].trim()).split("//")[0]).startsWith("/*")&&(o=!0),n.startsWith("*/")&&(o=!1),o||(this.balanceRB(n)||(this.errmsg=this.errmsg+"Linje "+(s+1)+":   Forskjellig antall av ( og ) i kodelinje.\n",i=!0),this.balanceSB(n)||(this.errmsg=this.errmsg+"Linje "+(s+1)+":   Forskjellig antall av [ og ] i kodelinje. \n",i=!0),n.indexOf("{")>=0&&(a+=1),n.indexOf("}")>=0&&(r+=1));a!=r&&("javascript"==this.lang?this.errmsg=this.errmsg+"Kodeblokk :   Forskjellig antall av { og } i kjernekoden. \n":this.errmsg=this.errmsg+"Feil med innrykk ?? \n\nSjekk at all innrykk av koden er riktig utført\nog at de er lagd med en tabulator.\nBruk knappen --\x3e for å sjekke koden din.",i=!0,this.abort=!0),(this.error||i)&&(this.error=!0,alert(this.errmsg))}printErrMessage(){print(this.errmsg)}balanceRB(e){for(var t=0,n=0,i=0;i<e.length;i++)"("==e.charAt(i)&&t++,")"==e.charAt(i)&&n++;return t==n}balanceSB(e){for(var t=0,n=0,i=0;i<e.length;i++)"["==e.charAt(i)&&t++,"]"==e.charAt(i)&&n++;return t==n}balanceHT(e){for(var t=0,n=0,i=0;i<e.length;i++)'"'==e.charAt(i)&&t++,"'"==e.charAt(i)&&n++;return oddetall(t)==oddetall(n)}replaceFusionHead(){for(var e=" ",t=0;t<this.fuCode.length;t++)(e=this.fuCode[t]).indexOf(":fupy")>0&&0==t&&(e=(e=e.replace("fupy","fujs")).replace("Python","JavaScript")),e.indexOf(":fualgo")>0&&0==t&&(e=(e=e.replace("fualgo","fujs")).replace("Algo","JavaScript fra Algo")),this.jsCode[t]=e;this.showCode()}replaceIF(){for(var e,t,n=0;n<this.fuCode.length;n++)(t=(e=this.copy(this.fuCode[n])).trimLeft()).startsWith("elif")?e.indexOf("elif ")>=0?e=(e=e.replace("elif","else if (")).replace(":","){"):e.indexOf("elif(")>=0&&(e=(e=e.replace("elif(","else if ((")).replace(":","){")):t.startsWith("else")?e.indexOf("else:")>=0?e=e.replace(":"," {"):e.indexOf("if(")>=0&&(e=(e=e.replace("if(","if ((")).replace(":","){")):t.startsWith("if")&&(e.indexOf("if(")>=0?e=(e=e.replace("if(","if ((")).replace(":","){"):e.indexOf("if ")>=0&&(e=(e=e.replace("if ","if (")).replace(":","){"))),this.jsCode[n]=e;this.showCode("if")}replaceHVIS(){for(var e,t=0;t<this.fuCode.length;t++)(e=this.fuCode[t]).indexOf("hvis ")>0&&e.indexOf("eller hvis")>=0?e=(e=e.replace("eller hvis ","else if (")).replace(":","){"):e.indexOf("hvis ")>=0?e=(e=e.replace("hvis ","if (")).replace(":","){"):e.indexOf("ellers:")>=0&&(e=(e=e.replace("ellers:","else {")).replace(":"," {")),this.jsCode[t]=e}replaceDEF(){for(var e,t=0;t<this.fuCode.length;t++)(e=this.fuCode[t]).trimLeft().startsWith("def")&&e.indexOf("def ")>=0&&e.indexOf(":")>=5&&(e=(e=e.replace("def","function")).replace(":","{")),this.jsCode[t]=e;this.showCode("def")}replacePROSEDYRE(){for(var e,t=0;t<this.fuCode.length;t++)(e=this.fuCode[t]).indexOf("prosedyre")>=0&&e.indexOf(":")>=10&&(e=(e=e.replace("prosedyre","function")).replace(":","{")),this.jsCode[t]=e}replaceRETUR(){for(var e,t=0;t<this.fuCode.length;t++)(e=this.fuCode[t]).indexOf("retur ")&&(e=e.replace("retur ","return ")),this.jsCode[t]=e}replaceAwait(){for(var e,t=0;t<this.fuCode.length;t++)(e=this.fuCode[t]).indexOf("lastDatafilCSV")>=0&&(e=e.replace("lastDatafilCSV","await lastDatafilCSV")),this.jsCode[t]=e}replaceWhile(){for(var e,t=0;t<this.fuCode.length;t++)(e=this.fuCode[t]).indexOf("while ")>=0&&e.indexOf(":")>=5&&(e=e.replace("while","while (").replace(":"," ){")),this.jsCode[t]=e;this.showCode("while")}replaceForInRange(){for(var e,t,n=0;n<this.fuCode.length;n++){if((e=this.fuCode[n]).trimLeft().startsWith("for "))if(0==(t=e.indexOf("for "))&&e.indexOf(":")>=5)e=this.replaceRangeToFor(e);else if(t>0&&e.indexOf(":")>=5){var i=e.substring(0,t),a=e.substring(t);e=i+this.replaceRangeToFor(a)}this.jsCode[n]=e}this.showCode("for-range")}replaceForWithKeys(){for(var e,t=0;t<this.fuCode.length;t++)(e=this.fuCode[t]).trimLeft().startsWith("for")&&e.indexOf("for ")>=0&&e.indexOf(":")>=5&&(e=(e=e.replace("for ","for (")).replace(":",") {")),this.jsCode[t]=e;this.showCode("def")}replaceForInInterval(){for(var e,t,n=0;n<this.fuCode.length;n++){if(0==(t=(e=this.fuCode[n]).indexOf("for "))&&e.indexOf(":")>=5)e=this.replaceRangeToFor(e);else if(t>0&&e.indexOf(":")>=5){var i=e.substring(0,t),a=e.substring(t);e=i+this.replaceRangeToFor(a)}this.jsCode[n]=e}}replaceRangeToFor(e){var t,n=[],i=[],a=[],r="";if(t=e,"for"!=e.split(" ")[0].trim())return e;if("python"==this.lang&&e.indexOf("range")<1)return e;if(("fualgo"==this.lang||"algo"==this.lang)&&e.indexOf("intervall")<1)return e;e=e.replace(/,/g," "),"fualgo"!=this.lang&&"algo"!=this.lang||(e=(e=e.replace("intervall(","range(")).replace("intervall (","range(")),(i=(e=(e=(e=(e=e.replace("range(","")).replace("range (","")).replace("):","")).replace(") :","")).split("#"))[0]=i[0].trim(),a=i[0].split(" ");for(var o=0,l=0;l<a.length;l++)""!=a[l].trim()&&(n[o]=a[l],o++);r="";if(2==i.length&&(r="# "+i[1]),4==n.length)e="for ( var "+n[1]+"=0; "+n[1]+"<"+n[3]+"; "+n[1]+"++){ "+r;else if(5==n.length)e="for ( var "+n[1]+"="+n[3]+" ; "+n[1]+"<"+n[4]+"; "+n[1]+"++){ "+r;else if(n.length>=6){(e="for ( var "+n[1]+"="+n[3]+" ; "+n[1]+"<"+n[4]+"; "+n[1]+"="+n[1]+"+"+n[5]+"){ "+r).indexOf("+-")>5&&(e=(e=e.replace("+-","-")).replace("<",">"))}else console.log("Feil i replaceRangeToFor"),console.log("   Num words:",n.length),console.log("   Tokens:",n),e=t;return e}replaceREPETER(){for(var e,t=0;t<this.fuCode.length;t++)(e=this.fuCode[t]).indexOf("repeter ")>=0&&e.indexOf(":")>=5&&(e=(e=e.replace("repeter ","while (")).replace(":"," ){")),this.jsCode[t]=e}replaceComments(){for(var e=0;e<this.jsCode.length;e++)this.jsCode[e]=this.jsCode[e].replace("#","//")}replacePackage(){for(var e=0;e<this.jsCode.length;e++)this.jsCode[e]=this.jsCode[e].replace("math.pi","Math.PI"),this.jsCode[e]=this.jsCode[e].replace("math.e","Math.E"),this.jsCode[e]=this.jsCode[e].replace("random.randint","randint")}replaceImport(){for(var e=0;e<this.jsCode.length;e++)this.jsCode[e]=this.jsCode[e].replace("import ","//import "),this.jsCode[e]=this.jsCode[e].replace("from ","//from ")}replaceKaaresImport(){dialog.turtle=!1;for(var e=0;e<this.jsCode.length;e++){this.jsCode[e]=this.jsCode[e].replace("from turtle import *","include('../fulibs/turtle.js')"),dialog.turtle=!0}}replaceLogicalThings(){for(var e=0;e<this.jsCode.length;e++)this.jsCode[e]=this.jsCode[e].replace(/ and /g," && "),this.jsCode[e]=this.jsCode[e].replace(/ or /g," || "),this.jsCode[e]=this.jsCode[e].replace(/ not /g," ! "),this.jsCode[e]=this.jsCode[e].replace("True","true"),this.jsCode[e]=this.jsCode[e].replace("False","false")}replaceLogicalThingsPseudo(){for(var e=0;e<this.jsCode.length;e++){var t=this.jsCode[e].indexOf("hvis "),n=this.jsCode[e].indexOf(":");t>=0&&n>=10&&(this.jsCode[e]=this.jsCode[e].replace(/ og /g," && "),this.jsCode[e]=this.jsCode[e].replace(/ eller /g," || "),this.jsCode[e]=this.jsCode[e].replace(/ ikke /g," ! "),this.jsCode[e]=this.jsCode[e].replace("Sant","true"),this.jsCode[e]=this.jsCode[e].replace("Usant","false"))}}replaceArrayMethods(){for(var e=0;e<this.jsCode.length;e++)this.jsCode[e]=this.jsCode[e].replace(".append(",".push(")}replaceImportAsPrefix(){for(var e=0;e<this.jsCode.length;e++)this.jsCode[e].startsWith("include")&&this.jsCode[e].indexOf("math.js")>0&&(this.mathJS=!0),this.mathJS||(this.jsCode[e]=this.jsCode[e].replace("math.","")),this.jsCode[e]=this.jsCode[e].replace("random.",""),this.jsCode[e]=this.jsCode[e].replace("np.",""),this.jsCode[e]=this.jsCode[e].replace("plt.",""),this.jsCode[e]=this.jsCode[e].replace("plot.","")}replacePrintLiteral(){for(var e=0;e<this.jsCode.length;e++)if(this.jsCode[e].indexOf("print(f'")>=0)for(;this.jsCode[e].indexOf("{")>=0;)this.jsCode[e]=this.jsCode[e].replace("print(f","print("),this.jsCode[e]=this.jsCode[e].replace("{","' +literal('"),this.jsCode[e]=this.jsCode[e].replace("}","') + '");else if(this.jsCode[e].indexOf('print(f"')>=0)for(;this.jsCode[e].indexOf("{")>=0;)this.jsCode[e]=this.jsCode[e].replace("print(f","print("),this.jsCode[e]=this.jsCode[e].replace("{",'" +literal("'),this.jsCode[e]=this.jsCode[e].replace("}",'") + "')}replaceHeader(){for(var e=0;e<this.jsCode.length;e++)this.jsCode[e]=this.jsCode[e].replace("#Fusion:fujs","//Fusion:fujs"),this.jsCode[e]=this.jsCode[e].replace("#Fusion:fupy","//Fusion:fujs"),this.jsCode[e]=this.jsCode[e].replace("#Fusion:fualgo","//Fusion:fujs")}findLibs(){this.replaceKaaresImport();for(var e=0;e<this.jsCode.length;e++){var t=this.jsCode[e];if(0==t.indexOf("include(")){var n=(t=(t=(t=(t=t.replace("("," ")).replace(")"," ")).replace("'","")).replace("'","")).split(" ");this.fulibs[this.fulibs.length]=n[1],this.jsCode[e]="//"+this.jsCode[e]}}}loadLibs(){var e=!1;if(this.findLibs(),this.fulibs.length>0){for(var t="\n",n=0;n<this.fulibs.length;n++){include(this.fulibs[n])&&(e=!0,t=t+this.fulibs[n]+"\n",console.log("Laster",this.fulibs[n]))}e&&print("Skolebiblioteker lastet inn ved kjøring:\n"+t+"\nTrykk Kjør kode på nytt!")}return e}checkLoadingCSV(){dialog.csvloading=!1;for(var e=0;e<this.jsCode.length;e++){0==this.jsCode[e].indexOf("lastDatafilCSV(")&&(dialog.csvloading=!0)}}insertCloseBrackets(){for(var e=this.fuCode.length-1;e>0;e--)if(this.tab[e-1]>this.tab[e])for(var t=this.tab[e-1]-this.tab[e],n=0;n<t;n++){var i="}",a=4*this.tab[e]+1+4*n;i=i.padStart(a," "),this.jsCode.splice(e,0,i)}}countTabs(e){var t=0;if(0==e.trim().length)return 0;for(var n=0;n<e.length;n++)if(32==e.charCodeAt(n))t+=1;else{if(9!=e.charCodeAt(n))break;t+=this.spaces}return round(t/this.spaces,0)}spaceTabs(){for(var e=[],t=0;t<this.fuCode.length;t++){var n=0,i=this.fuCode[t];if(i.trim().length>0){for(var a=0;a<i.length&&" "==i[a];a++)n+=1;n>0&&this.addSpaceTab(e,n)}}e.sort((e,t)=>e-t),e.length>0&&(this.spaces=e[0])}addSpaceTab(e,t){for(var n=0;n<e.length;n++)if(t==e[n])return;t>=2&&e.push(t)}createTabTable(){for(var e=0;e<this.fuCode.length;e++)this.tab[e]=this.countTabs(this.fuCode[e]),e>0&&this.notCode(this.fuCode[e])&&(this.tab[e]=this.tab[e-1])}printTabTable(){console.log("printTabTable");for(var e=0;e<this.tab.length;e++)console.log(e+1,this.tab[e].toFixed(1),this.fuCode[e])}createFunctionJS(){var e;try{return e=new Function(this.jsString),this.errorObject="Kode OK",e}catch(e){return print("Syntaks feil: \n"+e),console.error(e),this.errorObject=e,!1}}notCode(e){for(var t=0;t<e.length;t++)if(e.charCodeAt(t)>=36)return!1;return!0}copy(e){new String;return e}}function htmlHentObjekt(e){return document.getElementById(e)}function htmlVisElement(e){document.getElementById(e).style.visibility="visible"}function htmlLukkElement(e){document.getElementById(e).style.visibility="hidden"}function htmlSkrivTall(e,t,n=3,i="50px"){document.getElementById(e).value=t.toFixed(n),document.getElementById(e).style.width=i}function htmlSkrivTekst(e,t){document.getElementById(e).value=t}function htmlSkrivParagraf(e,t){document.getElementById(e).innerHTML=tekst}function htmlSkrivTabell(e,t,n,i){var a="",r="";if(t.length>0){a="<tr>";for(var o=t.length,l=0;l<o;l++)a=a+"<th>"+t[l]+"</th>";a+="</tr>"}if(n.length>0){r="<tr>";for(var s=n.length,g=n[0].length,d=0;d<s;d++){for(var u=0;u<g;u++)r=r+"<td onclick="+i+"("+d+","+u+")>"+n[d][u]+"</td>";r+="</tr>"}}id(e).innerHTML=a+r}function htmlSkrivValgliste(e,t){var n;n=id(e);for(var i=0;i<t.length;i++){var a=document.createElement("option");a.value=t[i],a.innerHTML=t[i],n.appendChild(a)}}function htmlHentTall(e){return Number(document.getElementById(e).value)}function htmlHentTekst(e){return document.getElementById(e).value}function htmlHentValglisteOpsjon(e){var t,n;return n=(t=document.getElementById(e)).selectedIndex,t.options[n].value}function htmlHentValglisteIndeks(e){return document.getElementById(e).selectedIndex}function htmlSettValglisteOpsjon(e,t){var n;n=document.getElementById(e);for(var i=0;i<n.options.length;i++)n.options[i].value===t&&(n.selectedIndex=i)}function htmlHentTallGlider(e){return glideTall=Number(document.getElementById(e).value),glideTall}function htmlSettEgenskaperGlider(e,t,n,i,a=.01){var r;(r=document.getElementById(e)).min=t,r.max=n,r.value=i,r.step=a}function htmlSkrivMelding(e,t){var n;n=document.getElementById(e).value,document.getElementById(e).value=n+t+"\n"}function htmlMelding(e){var t;document.getElementById("meldinger")?(t=document.getElementById("meldinger").value).length<2?document.getElementById("meldinger").value=e+"\n":document.getElementById("meldinger").value=t+e+"\n":console.log("Print til konsoll: "+e)}function htmlMeldingSlett(){document.getElementById("meldinger").value=""}function htmlMeldingTallListe(e,t,n=3){var i,a="{"+t[0].toFixed(n);i=document.getElementById("meldinger").value;for(var r=1;r<t.length;r++)a=a+","+t[r].toFixed(n);document.getElementById("meldinger").value=i+e+a+"} \n"}function htmlTranslate(e,t,n){document.getElementById(e).style.transform="translate("+t+"px,"+n+"px)"}function htmlTranslateRel(e,t,n){document.getElementById(e).style.transform="translate("+t+"%,"+n+"%)"}function htmlRotate(e,t){document.getElementById(e).style.transform="rotate("+t+"deg)"}function htmlScale(e,t,n=t){document.getElementById(e).style.transform="scale("+t+","+n+")"}function htmlTransform(e,t,n,i,a,r=a){var o="translate("+t+"px,"+n+"px) rotate("+i+"deg)scale("+a+","+r+")";document.getElementById(e).style.transform=o}var debug=!1,fulib=[],fuload=[],numlibs=0,fulibCode="",libhome="../skolemappe/",selectfolder="",serverlibs=[],serverfiles=[],resfolders0=[],resfolders1=[],resfiles0=[],resfiles1=[],resfilFiltrert0=[],resfilFiltrert1=[],resmappe0="undefined",resmappe1="undefined",editor,viewer,runcode;function hasMathJS(){for(var e=!1,t=0;t<fulib.length;t++)fulib[t].endsWith("math.js")&&(e=!0);return e}function include(e){var t;if(e.startsWith("https://")||e.startsWith("http://")||e.startsWith("./")||e.startsWith("localhost"))t=e,console.log("Laster inn",t);else if("fulibs/"==e.substr(0,7))t="../"+e,console.log("Laster dynamisk fra fulibs",t);else if(e.indexOf("../fulibs/")>=0)t="./"+e,console.log("Laster dynamisk fra fulibs",t);else if(e.indexOf("regression.js")>=0)t="https://cdnjs.cloudflare.com/ajax/libs/regression/2.0.1/regression.min.js",console.log("Laster dynamisk:",t);else if(e.indexOf("regresjon")>=0)t="https://cdnjs.cloudflare.com/ajax/libs/regression/2.0.1/regression.min.js",console.log("Laster dynamisk:",t);else if(e.indexOf("math.js")>=0)t="https://cdnjs.cloudflare.com/ajax/libs/mathjs/10.1.1/math.js",console.log("Laster dynamisk:",t);else if(e.indexOf("three.js")>=0)t="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js",console.log("Laster dynamisk fra https://cdnjs.cloudflare.com",t);else if(e.indexOf("plotly.js")>=0)t="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.8.3/plotly.min.js",console.log("Laster dynamisk:",t);else if(e.indexOf("numbers.js")>=0)t="https://cdnjs.cloudflare.com/ajax/libs/numbers.js/0.7.0/numbers.min.js",console.log("Laster dynamisk:",t);else{var n=e.split("/");3==n.length&&(t=libhome+n[0]+"/bibliotek/"+n[1]+"/"+n[2]),4==n.length&&(t=libhome+e),console.log("Laster inn fra skolemappe",t)}for(var i=!1,a=0;a<fulib.length;a++)e==fulib[a]&&(i=!0);if(!i){print("Laster inn kodebibliotek:\n"+t);var r=document.createElement("script");return r.src=t+"?version="+randint(1,1e3),fulib[fulib.length]=e,fuload[fulib.length-1]=!1,r.onload=_libloaded(fulib.length-1),document.head.appendChild(r),numlibs=fulib.length,!0}return!1}function libPath(e,t){var n;if(t.indexOf("https://")>=0)n=t,console.log("Laster inn",n);else if("fulibs/"==t.substr(0,7))n="../"+t,console.log("Laster dynamisk fra fulibs",n);else if(t.indexOf("../fulibs/")>=0)n="./"+t,console.log("Laster dynamisk fra fulibs",n);else{var i=t.split("/");3==i.length&&(n=libhome+i[0]+"/"+e+"/"+i[1]+"/"+i[2]),4==i.length&&(n=libhome+t),console.log("Laster inn fra skolemappe",n)}return n}function createServerObjektWrite(){var e=createServerObjektGet();return e.content=editor.session.getValue(),debug&&console.log("createServerwriteObjWrite",obj),e}function createServerObjektGet(){var e,t=id("schoolId").value,n=id("pwdId").value,i=urlParams.get("type"),a=htmlHentValglisteOpsjon("servermapper");return e={school:t,pwd:n,category:i,folder:a,file:id("fileId").value,content:""},debug&&alert("Folder "+a),e}function buildFname(){var e=createServerObjektGet();return libhome+"/"+e.school+"/"+e.category+"/"+e.folder+"/"+e.file}function saveServerfile(){if(access){var e=createServerObjektWrite();if(debug&&console.log("saveServerfile:",e.school,e.pwd,e.file),e.file.length<5||e.school.length<4)alert("Ulovlig inndata.");else confirm("Vil du oppdatere fila "+e.file+"?")&&saveServerObj(e,updateServerlist)}else alert("Ingen tilgang foreløpig.")}function deleteServerfile(){if(access){var e=createServerObjektGet();if(debug&&console.log("deleteServerfile:",e.school,e.pwd,e.file),e.file.length<5||e.school.length<4)alert("Ulovlig inndata.");else confirm("Vil du slette serverfila "+e.file+"?")&&slettServerfil(e,updateServerlist),debug&&console.log("Delete file ",e.file)}else alert("Ingen tilgang foreløpig.")}function readServerfile(){if(access){var e=createServerObjektGet();if(debug&&console.log("readServerfile:",e.school,e.pwd,e.file),(t=e.file).length<5||t.endsWith(".php")||e.school.length<4)alert("Ulovlig inndata.");else{debug&&console.log("readServerfile",libhome+"/"+e.file),lesTekstfilServer(buildFname(),function(e){confirm("Har du huska å lagre innholdet i editoren? \n Velg AVBRYT om du må lagre først.")&&(editor.session.setValue(e),t.endsWith(".js")&&setEditorMode("javascript"),t.endsWith(".fujs")&&setEditorMode("javascript"),t.endsWith(".py")&&setEditorMode("python"),t.endsWith(".fupy")&&setEditorMode("python"),t.endsWith(".html")&&setEditorMode("html"),t.endsWith(".css")&&setEditorMode("html"))});var t=e.file}}else alert("Ingen tilgang foreløpig.")}function updateServerlist(){writeObj=createServerObjektGet(),debug&&console.log("updateServerlist",writeObj),hentListeServer(writeObj,function(e){for(var t=[],n=0;n<e.length;n++)t[n]=[e[n]];e.length>0&&htmlSkrivTabell("tableServerfiles",[],t,"selectLibrary")}),htmlSkrivTabell("tableServerfiles",[],[],"selectLibrary")}function updateResourcefolder(e){hentRessursmapper(function(t){for(var n=[],i=0;i<t.length;i++)n[i]=[t[i]];t.length>0&&(0==e&&(id("ressursmappeId").innerHTML="<option>Velg ressursmappe</option>",htmlSkrivValgliste("ressursmappeId",t)),1==e&&(id("ressursmappeId_fag").innerHTML="<option>Velg ressursmappe</option>",htmlSkrivValgliste("ressursmappeId_fag",t)))},e),0==e&&htmlSkrivTabell("ressurslisteId_fag",[""],[],"selectResource0"),1==e&&htmlSkrivTabell("ressurslisteId_fag",[""],[],"selectResource1")}function updateResourcelist(e){if(0==e&&id("ressursmappeId").selectedIndex<=0)return htmlSkrivTabell("ressurslisteId",[""],[],"selectResource0"),void(resmappe0=resfolders0[id("ressursmappeId").selectedIndex]);if(1==e&&id("ressursmappeId_fag").selectedIndex<0)return htmlSkrivTabell("ressurslisteId_fag",[""],[],"selectResource1"),void(resmappe1=resfolders1[id("ressursmappeId_fag").selectedIndex]);function t(t){var n=[];if(1==e){var i,a,r=id("ressursfilterId_fag").selectedIndex,o=id("ressurstypeId_fag").selectedIndex;resfilFiltrert0=[],resfilFiltrert1=[];for(var l=0;l<t.length;l++)i=!1,a=!1,1==r&&t[l].endsWith(".fupy")&&(i=!0),2==r&&t[l].endsWith(".fujs")&&(i=!0),3==r&&t[l].endsWith(".fualgo")&&(i=!0),0==r&&(i=!0),1==o&&t[l].startsWith("eks_")&&(a=!0),2==o&&t[l].startsWith("utf_")&&(a=!0),3==o&&t[l].startsWith("opg_")&&(a=!0),4==o&&t[l].startsWith("los_")&&(a=!0),5==o&&t[l].startsWith("tst_")&&(a=!0),0==o&&(a=!0),t[l].endsWith(".lck")&&(i=!1,a=!1),i&&a&&n.push([t[l]])}if(0==e)for(l=0;l<t.length;l++)n[l]=[t[l]];n.length>=0&&(0==e&&htmlSkrivTabell("ressurslisteId",[" "],n,"selectResource0"),1==e&&htmlSkrivTabell("ressurslisteId_fag",[" "],resfilFiltrert1=n,"selectResource1"))}0==e&&hentRessursliste(resmappe0=resfolders0[id("ressursmappeId").selectedIndex-1],t,e),1==e&&hentRessursliste(resmappe1=resfolders1[id("ressursmappeId_fag").selectedIndex-1],t,e)}function selectResource0(e,t){id("ressursId").value=resfiles0[e]}function selectResource1(e,t){id("ressursId_fag").value=resfilFiltrert1[e]}function updateFolderlist(){writeObj=createServerObjektGet(),debug&&console.log("updateFolderlist",writeObj),hentMapperServer(writeObj,function(e){for(var t=[],n=0;n<e.length;n++)t[n]=[e[n]];e.length>0&&(id("servermapper").innerHTML="<option>Velg mappe</option>",htmlSkrivValgliste("servermapper",e))})}function selectLibrary(e,t){id("fileId").value=serverlibs[e]}function chkAccess(){var e={school:id("schoolId").value,pwd:id("pwdId").value};debug&&console.log("chkAccess:",e.school);var t=JSON.stringify(e),n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){debug&&console.log("_chkAccess:"+n.responseText);var e=JSON.parse(n.responseText);access=e,e?(alert("Tilgangskode kontrollert.\nDu kan nå endre innholdet på fellesområdet."),saveAccessLS(),btnActivation(!1),onload=!1,updateFolderlist(),idSynlighet("header","av"),idSynlighet("aksess","av"),idSynlighet("premium","av")):(btnActivation(!0),htmlSkrivTabell("tableServerfiles",[],[],"selectLibrary"),alert("Ingen tilgang.\n\nFeil kode eller ingen tilgang for skolen din."))}},n.open("POST","../fulibs/php/sjekkAksess.php"),n.setRequestHeader("Content-Type","application/json"),n.send(t)}function btnActivation(e){id("getServer").disabled=e,id("saveServer").disabled=e,id("delServer").disabled=e,id("kodesnap")&&(id("kodesnap").disabled=e)}function saveAccessLS(){var e=id("schoolId").value,t=id("pwdId").value;(new DataManager).writeAppData("FusionProfile","aksess",[e,t])}function getAccessLS(){var e=(new DataManager).readAppData("FusionProfile","aksess");2==e.length&&(id("schoolId").value=e[0],id("pwdId").value=e[1])}function saveProfileLS(){var e=id("languageId").selectedIndex,t=id("languageId").options[e].value,n=id("edThemeId").selectedIndex,i=id("edThemeId").options[n].value,a=id("edFontId").selectedIndex,r=id("edFontId").options[a].value,o=new DataManager;debug&&console.log("Save profile",[t,i,r]);var l={};l.themeEdit=i,l.themeIndex=n,"JavaScript"==t&&(l.header="//Fusion:fujs [javascript]"),"Python"==t&&(l.header="#Fusion:fupy [python]"),"Algo"==t&&(l.header="#Fusion:fualgo [algo]"),l.fontSize=r,l.fontIndex=a,l.mode=t.toLowerCase(),l.modeIndex=e,l.schoolId=id("schoolId").value,l.courseId=id("courseId").value,l.pwdId=id("pwdId").value,"algo"==t&&(l.mode="ace/mode/python"),o.writeAppData("FusionProfile","profile",l),saveAccessLS()}function getProfileLS(){var e;(e=(new DataManager).readAppData("FusionProfile","profile"))?("FusionProg"!=appnavn&&(debug&&console.log("Get profile",e),id("languageId")&&(id("languageId").selectedIndex=e.modeIndex),id("edThemeId")&&(id("edThemeId").selectedIndex=e.themeIndex),id("edFontId")&&(id("edFontId").selectedIndex=e.fontIndex),id("pwdId")&&"undefined"!=e.pwdId&&(id("pwdId").value=e.pwdId)),id("schoolId")&&"undefined"!=e.schoolId&&(id("schoolId").value=e.schoolId),id("courseId")&&"undefined"!=e.courseId&&(id("courseId").value=e.courseId)):(id("schoolId")&&(id("schoolId").value=""),id("courseId")&&(id("courseId").value=""),"FusionProg"!=appnavn&&(id("pwdId").value="")),"FusionProg"!=appnavn&&getAccessLS()}function hentListeServer(e,t="undefined"){var n="../fulibs/php/hentFilliste.php";debug&&console.log("Liste skolebibliotek",e.school);var i=JSON.stringify(e),a=new XMLHttpRequest;a.onreadystatechange=function(){4===a.readyState&&200===a.status&&(serverlibs=JSON.parse(a.responseText),debug&&console.log("Filer funnet",serverlibs),"undefined"!=t&&t(serverlibs))},a.open("POST",n),a.setRequestHeader("Content-Type","application/json"),a.send(i),debug&&console.log("hentListeServer:",n),debug&&console.log(e)}function hentRessursliste(e,t,n){if(1==n){var i=id("schoolId").value,a=e;if("undefined"==i||i.length<4)return void console.log("Feil skolenavn",i);if("undefined"==a||a.length<2)return void console.log("Feil skolemappe",a)}var r="../fulibs/php/hentRessursfiler.php?school=fusion&&course="+e;1==n&&(r="../fulibs/php/hentRessursfiler.php?school="+id("schoolId").value+"&&course="+e);var o=new XMLHttpRequest;o.onreadystatechange=function(){4===o.readyState&&200===o.status&&(0==n&&(resfiles0=JSON.parse(o.responseText),t(resfiles0),debug&&console.log("Ressursfiler funnet",resfiles0)),1==n&&(resfiles1=JSON.parse(o.responseText),t(resfiles1),debug&&console.log("Ressursfiler funnet",resfiles1)))},o.open("POST",r),o.setRequestHeader("Content-Type","application/json"),o.send(),debug&&console.log("hentRessursliste:",r)}function hentMapperServer(e,t="undefined"){var n="../fulibs/php/hentMappeliste.php";debug&&console.log("Liste skolebibliotek",e.school);var i=JSON.stringify(e),a=new XMLHttpRequest;a.onreadystatechange=function(){4===a.readyState&&200===a.status&&(serverlibs=JSON.parse(a.responseText),debug&&console.log("Mapper funnet",serverlibs),"undefined"!=t&&t(serverlibs))},a.open("POST",n),a.setRequestHeader("Content-Type","application/json"),a.send(i),debug&&console.log("hentMapperServer:",n),debug&&console.log(e)}function hentRessursmapper(e,t){var n="../fulibs/php/hentRessursmapper.php",i=new XMLHttpRequest;1==t&&(n="../fulibs/php/hentRessursmapper.php"),i.onreadystatechange=function(){4===i.readyState&&200===i.status&&(0==t&&(resfolders0=JSON.parse(i.responseText),debug&&console.log("Ressursmapper funnet",resfolders0),"undefined"!=e&&e(resfolders0)),1==t&&(resfolders1=JSON.parse(i.responseText),debug&&console.log("Ressursmapper funnet",resfolders1),"undefined"!=e&&e(resfolders1)))},i.open("POST",n),i.setRequestHeader("Content-Type","application/json");var a={school:"fusion"};if(1==t){if("undefined"==id("schoolId").value)return;if(id("schoolId").value.length<4)return;a={school:id("schoolId").value}}i.send(JSON.stringify(a)),debug&&console.log("hentRessursmapper:",n)}function hentBildeliste(e="undefined"){var t="../fulibs/php/hentBildeliste.php",n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&200===n.status&&(serverlibs=JSON.parse(n.responseText),"undefined"!=e&&e(serverlibs))},n.open("POST",t),n.setRequestHeader("Content-Type","application/json"),n.send(),debug&&console.log("hentBildelisteServer:",t)}function saveServerObj(e,t="undefined"){debug&&console.log("saveServerObj",e);var n=JSON.stringify(e);alert("Lagrer fil: "+e.school+"/"+e.category+"/"+e.folder+"/"+e.file);var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4===i.readyState&&200===i.status){var e=JSON.parse(i.responseText);e?"undefined"!=t&&t():alert("Feil ved opplasting.")}},i.open("POST","../fulibs/php/lagreServerfil.php"),i.setRequestHeader("Content-Type","application/json"),i.send(n)}function lagServermappe(){var e=createServerObjektGet();if(e.folder=id("nyServermappe").value,""!=e.folder){if(confirm("Ønsker du å opprette mappa "+e.folder+"?")){debug&&console.log("lageServermappe",e);var t=JSON.stringify(e),n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){var e=JSON.parse(n.responseText);e?updateFolderlist():alert("Feil ved oppretting av ny mappe")}},n.open("POST","../fulibs/php/lagServermappe.php"),n.setRequestHeader("Content-Type","application/json"),n.send(t)}}else alert("Må gi inn navnet på mappa du skal lage")}function slettServerfil(e,t="undefined"){console.log("Sletter bibliotek",e.school,e.libname);var n=JSON.stringify(e),i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&200===i.status&&"undefined"!=t&&t()},i.open("POST","../fulibs/php/slettServerfil.php"),i.setRequestHeader("Content-Type","application/json"),i.send(n)}function includeNEW(e){liburl=libhome+orghome+"/"+e;for(var t=!1,n=0;n<fulib.length;n++)e==fulib[n]&&(t=!0);if(!t){let e=loadScript(liburl+"?version="+randint(1,1e3));e.then(e=>alert(`${e.src} is loaded!`),e=>alert(`Error: ${e.message}`)),e.then(e=>alert("Another handler..."))}}function include1(e){liburl=libhome+orghome+"/bibliotek/"+e;for(var t=!1,n=0;n<fulib.length;n++)e==fulib[n]&&(t=!0);if(!t){print("Include",e),lesTekstfilServer(liburl,function(t){fulibCode+=t,fulib[fulib.length]=e})}}function loadScript(e){return new Promise(function(t,n){let i=document.createElement("script");i.src=e,i.onload=(()=>t(i)),i.onerror=(()=>n(new Error(`Script load error for ${e}`))),document.head.append(i)})}function _libloaded(e){print("Bibliotek "+fulib[e]+" importert !"),fuload[e]=!0}async function include3(e){liburl=libhome+orghome+"/"+e;new Promise(function(e,t){let n=new XMLHttpRequest;n.open("GET",liburl),n.onload=function(){200==n.status?(e(n.response),fulibCode+=n.response):e("File not Found")},n.send()})}function showlibs(){console.clear();var e=fulibCode.split("\n");print("Antall kodelinjer lest",e.length),console.log(fulibCode)}function clearlibs(){fulib=[],fuload=[!1,!1,!1,!1],fulibCode=""}var appnavn="FusionProg",autosave="autosave",fuhead="// Fusion:fujs [fupy=Python,fujs=JavaScript,fualgo=Algo]",fileContent,kodesettIndeks=-1,canvas;function getFagmappe(){var e,t,n=(new DataManager).readAppData("FusionProfile","profile");return n?(e=n.schoolId,t=n.courseId,id("mfag_smappe")&&(id("mfag_smappe").value=e),id("mfag_fmappe")&&(id("mfag_fmappe").value=t)):(e="",t=""),[e,t]}function visFagside(e,t,n){var i;i="localhost"==window.location.hostname?"http://localhost/fusion/page.php?skolemappe="+e+"&&fagmappe="+t+"&&side="+n:"https://fulab.no/page.php?skolemappe="+e+"&&fagmappe="+t+"&&side="+n,console.log("Fagside ",i),window.open(i,"_self")}function onResize(e){dialog.tegnekjerne=e}function onClick(e){dialog.klikkfunksjon=e}function onMove(e){dialog.movefunksjon=e}function fuWebInnData(){tegn.musData=!1,tegn.musKnapp=0,tegn.musDra=!1,tegn.musNed=!1,tegn.musOpp=!1,tegn.musPosX=0,tegn.musPosY=0,tegn.tastNr=0,tegn.tast="",tegn.tastNed=!1,tegn.tastOpp=!1,tegn.tastData=!1}function fuWebInitGUI(){var e=new DataManager;lagVinduKodeIO(!0,!0,!0),dialog.topp="funksjoner",lagVinduGrafVerktøy(fuWebDrawing),editor=createEditor("editor","editor"),dialog.editor=editor,lagVinduEditorKommandoer(),$("#konteinerTegning").resizable();var t=$("#konteinerTegning").width(),n=$("#konteinerTegning").height();tegnBrukCanvas("tegning"),tegn.canvas.width=t,tegn.canvas.height=n,elementSynlighet(["dialog","canvas","funksjoner"],"av"),elementSynlighet(["kjernev","konteinerKjernekode","kjerneh"],"av"),fuWebActions(),fuWebInnData(),setEditorMode("python");var i=e.readAppData(appnavn,autosave);if(i){var a=i.content;fuWebEditorInsert(editor,a),id("kodesett").value=autosave;var r=a.split("\n")[0];r.indexOf(":fupy")>0&&setEditorMode("python"),r.indexOf(":fujs")>0&&setEditorMode("javascript"),r.indexOf(":fualgo")>0&&setEditorMode("python")}}function fuWebInitEditorGUI(){var e=new DataManager;lagVinduKodeIO(!0,!0,!0),dialog.topp="funksjoner",lagVinduGrafVerktøy(fuWebDrawing),editor=createEditor("editor","editor"),dialog.editor=editor,lagVinduEditorKommandoer(),$("#konteinerTegning").resizable();var t=$("#konteinerTegning").width(),n=$("#konteinerTegning").height();tegnBrukCanvas("tegning"),tegn.canvas.width=t,tegn.canvas.height=n,elementSynlighet(["dialog","canvas","funksjoner"],"av"),elementSynlighet(["kjernev","konteinerKjernekode","kjerneh"],"av"),elementSynlighet(["header","snarveier","infotekst","konsoll"],"av"),fuWebActions(),fuWebInnData(),setEditorMode("python");var i=e.readAppData(appnavn,autosave);if(i){var a=i.content;fuWebEditorInsert(editor,a),id("kodesett").value=autosave;var r=a.split("\n")[0];r.indexOf(":fupy")>0&&setEditorMode("python"),r.indexOf(":fujs")>0&&setEditorMode("javascript"),r.indexOf(":fualgo")>0&&setEditorMode("python")}}function fuWebInitGUICoderun(){new DataManager;lagVinduKodeIO(!0,!0,!0),dialog.topp="funksjoner",lagVinduGrafVerktøy(fuWebDrawing),editor=createEditor("editor","editor"),dialog.editor=editor,$("#konteinerTegning").resizable();var e=$("#konteinerTegning").width(),t=$("#konteinerTegning").height();tegnBrukCanvas("tegning"),tegn.canvas.width=e,tegn.canvas.height=t,elementSynlighet(["snarveier","verktøy","infotekst"],"av"),elementSynlighet(["kommandoer","tegnefunksjoner"],"av"),elementSynlighet(["dialog","canvas"],"på"),elementSynlighet(["kjernev","konteinerKjernekode","kjerneh"],"av"),fuWebActions(),fuWebInnData()}function fuWebActions(){"FusionProg"==appnavn&&(id("fuw_hentkode").onclick=hentKode,id("fuw_lagrekode").onclick=lagreKodesnuttIDE,id("fuw_sletteditorkode").onclick=slettEditorkode,id("fuw_tegnemal").onclick=kodemalTegning,id("fuw_grafmal").onclick=kodemalGraftegner,id("fuw_nestekode").onclick=nesteKode,id("fuw_visliste").onclick=visListe,id("fuw_slettkode").onclick=slettKodeNettlager),"FusionKurs"==appnavn&&(id("hentKodesnutt").onclick=hentKodesnutt,id("instruksjon").onclick=visTemainfo,id("nesteKodesnutt").onclick=nesteKodesnutt,id("forrigeKodesnutt").onclick=forrigeKodesnutt,id("resettKodesnutt").onclick=tilbakestillKodesnutt,id("kursvelger").onclick=velgKurs,id("temavelger").onchange=velgKurstema),id("editor").onchange=fuWebEditorInput,id("body").resize=fuWebResize,id("tegning").onclick=fuWebMouseClick,id("tegning").onmousedown=fuWebMouseDown,id("tegning").onmouseup=fuWebMouseUp,id("tegning").onmousemove=fuWebMouseMove,document.addEventListener("keydown",fuWebKeyDown,!1)}function fuWebMouseClick(e){var t=fuWebGetMouseXY(e),n=(t[2],t[3],t[0]),i=t[1];"undefined"==dialog.movefunksjon&&tegnMelding("Punkt("+n+","+i+")","observer"),tegn.musData=!0,tegn.musKnapp=t[4],tegn.musPosX=t[0],tegn.musPosY=t[1];var a={};a.x=t[0],a.y=t[1],a.xPixel=t[2],a.yPixel=t[3],a.button=t[4],a.status="press","undefined"!=dialog.klikkfunksjon&&dialog.klikkfunksjon(a)}function fuWebMouseDown(e){var t=fuWebGetMouseXYraw(e);tegn.musNed=!0,tegn.musOpp=!1,tegn.musDra=!0,tegn.musPosX=t[0],tegn.musPosY=t[1],tegn.musData=!0;var n={};n.x=t[0],n.y=t[1],n.xPixel=t[2],n.yPixel=t[3],n.button=t[4],n.status="down",n.down=!0,n.up=!1,n.move=!1,"undefined"!=dialog.movefunksjon&&dialog.movefunksjon(n)}function fuWebMouseUp(e){var t=fuWebGetMouseXYraw(e);tegn.musOpp=!0,tegn.musNed=!1,tegn.musDra=!1,tegn.musPosX=t[0],tegn.musPosY=t[1],tegn.musData=!1;var n={};n.x=t[0],n.y=t[1],n.xPixel=t[2],n.yPixel=t[3],n.button=t[4],n.status="up",n.down=!1,n.up=!0,n.move=!1,"undefined"!=dialog.movefunksjon&&dialog.movefunksjon(n)}function fuWebMouseMove(e){if(tegn.musDra){var t=fuWebGetMouseXYraw(e);tegn.musPosX=t[0],tegn.musPosY=t[1];var n={};n.x=Number(t[0]),n.y=Number(t[1]),n.xPixel=Number(t[2]),n.yPixel=Number(t[3]),n.button=Number(t[4]),n.status="move",n.move=!0,n.down=!0,n.up=!1,"undefined"!=dialog.movefunksjon&&dialog.movefunksjon(n)}}function fuWebKeyDown(e){e.target==id("tegning")?(tegn.tastNr=e.keyCode,tegn.tast=String.fromCharCode(e.keyCode),tegn.tastNed=!0,tegn.tastOpp=!1,tegn.tastData=!0):tegn.tastData}function fuWebKeyUp(e){tegn.tastNr=e.keyCode,tegn.tast=String.fromCharCode(e.keyCode),tegn.tastNed=!1,tegn.tastOpp=!0,tegn.tastData=!1}function fuWebGetMouseXY(e){var t=Number(e.offsetX),n=Number(e.offsetY),i=tegn.vxy(t,n);return[Number(avrund(i[0],dialog.avrundingX)),Number(avrund(i[1],dialog.avrundingY)),t,n,e.button]}function fuWebGetMouseXYraw(e){var t=Number(e.offsetX),n=Number(e.offsetY),i=tegn.vxy(t,n);return[Number(i[0]),Number(i[1]),t,n,e.button]}function fuWebDrawing(){if(dialog.debug&&console.log("Kaller opp fuWebDrawing"),"FusionKurs"!=appnavn){tegnBrukBakgrunn(dialog.lerretsfarge);var e=hentFeltD("_tegnVx1"),t=hentFeltD("_tegnVx2"),n=hentFeltD("_tegnVy1"),i=hentFeltD("_tegnVy2");tegnBrukOmråde(.1,.9,.1,.9),tegnBrukXområde(e,t),tegnBrukYområde(n,i),tegn.aksetegnet=!1,"undefined"!=dialog.tegnekjerne&&dialog.tegnekjerne(),tegn.aksetegnet||tegnAkser(dialog.tekstX,dialog.tekstY,dialog.avrundingX,dialog.avrundingY)}else dialog.tegnekjerne()}function id(e){return document.getElementById(e)}function fuWebConsoleClear(){id("meldinger").value=""}function fuWebResize(){resize=!0,fuWebCanvasResizeEnd()}var _GUI_Toggle=!0,_KON_Toggle=!0;function fuWebToggelGUI(){_GUI_Toggle?(idSynlighet("snarveier","av"),idSynlighet("verktøy","av"),idSynlighet("infotekst","av"),id("guiToggle").src="../fulibs/icons/fullscreen_close_48dp.png"):(idSynlighet("snarveier","på"),idSynlighet("verktøy","på"),idSynlighet("infotekst","på"),id("guiToggle").src="../fulibs/icons/fullscreen_open_48dp.png"),_GUI_Toggle=!_GUI_Toggle}function fuWebToggelKonsoll(){_KON_Toggle?(idSynlighet("header","av"),idSynlighet("snarveier","av"),idSynlighet("verktøy","av"),idSynlighet("infotekst","av"),idSynlighet("snarveier","av"),idSynlighet("konsoll","av"),idSynlighet("dialog","av"),id("konToggle").src="../fulibs/icons/fullscreen_close_48dp.png"):(idSynlighet("header","på"),idSynlighet("snarveier","på"),idSynlighet("verktøy","på"),idSynlighet("infotekst","på"),idSynlighet("snarveier","på"),idSynlighet("konsoll","på"),idSynlighet("dialog","på"),id("konToggle").src="../fulibs/icons/fullscreen_open_48dp.png"),_KON_Toggle=!_KON_Toggle}var canvasW,canvasH,resize=!1,filEndret,editorEndret;function fuWebCanvasResizeStart(){dialog.debug&&print("Start canvas resize"),resize=!0,canvasW=$("#konteinerTegning").width(),canvasH=$("#konteinerTegning").height()}function fuWebCanvasResizeEnd(){var e=$("#konteinerTegning").width(),t=$("#konteinerTegning").height();!resize||e==canvasW&&t==canvasH||(dialog.debug&&console.log("konteiner",e,t),tegn.canvas.width=$("#konteinerTegning").width(),tegn.canvas.height=$("#konteinerTegning").height(),fuWebDrawing(),canvasW=e,canvasH=t,resize=!1,dialog.debug&&(print("Avslutter canvas resize"),fuWebShowCanvas()))}function fuWebCanvasChange(e,t){var n=$("#konteinerTegning").width(),i=$("#konteinerTegning").height();(n<200||i<200)&&(n=dialog.lerret[0],i=dialog.lerret[1]),$("#konteinerTegning").width(n+e),$("#konteinerTegning").height(i+t),fuWebForceCanvasResize()}function fuWebCanvasSize(e,t){$("#konteinerTegning").width(e),$("#konteinerTegning").height(t),fuWebForceCanvasResize()}function fuWebCanvas1to1(){$("#konteinerTegning").width();var e=$("#konteinerTegning").height();$("#konteinerTegning").width(e),$("#konteinerTegning").height(e),fuWebForceCanvasResize()}function fuWebForceCanvasResize(){var e=$("#konteinerTegning").width(),t=$("#konteinerTegning").height();tegn.canvas.width=$("#konteinerTegning").width(),tegn.canvas.height=$("#konteinerTegning").height(),fuWebDrawing(),canvasW=e,canvasH=t,resize=!1,dialog.debug&&fuWebShowCanvas()}function fuWebShowCanvas(){print("jQ",$("#konteinerTegning").width(),$("#konteinerTegning").height(),"tegn",tegn.canvas.width,tegn.canvas.height)}function fuWebEditorChange(e,t){var n="#FusionEditor",i=$(n).width(),a=$(n).height();0!=e&&$(n).width(i+e),0!=t&&($(n).height(a+t),$("#meldinger").height(a+t))}function fuWebEditorPopChange(e,t){var n="#FusionEditor",i=$(n).width(),a=$(n).height();0!=e&&$(n).width(i+e),0!=t&&$(n).height(a+t)}function fuWebKonsollChange(e,t){var n=$("#meldinger").width(),i=$("#meldinger").height();0!=e&&$("#meldinger").width(n+e),0!=t&&($("#FusionEditor").height(i+t),$("#meldinger").height(i+t))}function roterskjerm(){$("#body").height();var e=$("#valgmeny").height(),t=($("#presentasjon").height(),$("#meldinger").height());$("#konteinerTegning").width(.8*window.innerWidth),$("#konteinerTegning").height(.75*(window.innerHeight-e-t)),id("meldinger").cols=.8*window.innerWidth/10,canvasW=$("#konteinerTegning").width(),canvasH=$("#konteinerTegning").height(),tegn.canvas.width=canvasW,tegn.canvas.height=canvasH,fuWebDrawing(),window.addEventListener("orientationchange",roterskjerm),location.reload()}function fuWebEditorInsert(e,t){var n="python";t.split("\n")[0].indexOf(":fujs")>0&&(n="javascript"),setEditorMode(n),e.session.setValue(t),e.resize()}function fuWebEditorInput(e){dialog.debug&&console.log("Action",e.action),filEndret=!0}function fuWebEditorResizeStart(){editorEndret=!0}function fuWebEditorResizeEnd(){fuWebEditorResize(),editorEndret=!1}function fuWebEditorResize(){editorEndret&&(editor.resize(),id("editor").style.width=id("FusionEditor").style.width,id("editor").style.height=id("FusionEditor").style.height,"FusionKurs"==appnavn&&meldingerResize(),dialog.debug&&console.log("Resize editor to ",id("editor").style.width))}function meldingerResize(){id("konsoll").style.height=id("editor").style.height,id("meldinger").style.height=id("editor").style.height;var e=$("#editor").width(),t=($("#editor").height(),$("#kurs2Cols").width()),n=Math.ceil(t-e-10);$("#konsoll").width(n/t*100+"%vh")}function infoframeResize(){}function startResize(){resize=!0}function avsluttResize(){var e=$("#tegnefar").width(),t=$("#tegnefar").height();!resize||e==canvasW&&t==canvasH||(e2d.canvas.width=$("#tegnefar").width(),e2d.canvas.height=$("#tegnefar").height(),sistePlott(),canvasw=e,canvasH=t,resize=!1)}function restart(){fuWebEditorInsert(editor,fuhead),viewer.session.setValue(" "),nyTegning();var e;(e=(new DataManager).getAppDataList(appnavn)).length>0?(kodesettIndeks=e.length-1,id("kodesett").value=e[kodesettIndeks],hentKode()):id("kodesett").value="standard"}function nyTegning(){fuWebDrawing()}function visFusionInfo(){idSynlighet("fusionInfo","på")}function lukkFusionInfo(){idSynlighet("fusionInfo","av")}function visLagring(){idSynlighet("webLager","av"),idSynlighet("filLager","av"),id("cbWeb").checked&&idSynlighet("webLager","på"),id("cbFil").checked&&idSynlighet("filLager","på")}function visKode(){jsSynlighet("av"),id("cbJS").checked&&jsSynlighet("på"),fusionSynlighet("av"),id("cbFU").checked&&fusionSynlighet("på")}function visTegneflate(){idSynlighet("tegneflate","av"),idSynlighet("dialog","av"),idSynlighet("FusionDialog","av"),idSynlighet("tegneflate","på"),idSynlighet("dialog","på"),idSynlighet("FusionDialog","på")}function visGUI(){idSynlighet("tegneflate","av"),idSynlighet("FusionDialog","av"),id("cbTegneflate").checked&&(idSynlighet("tegneflate","på"),idSynlighet("FusionDialog","på"))}function hentKode(){var e=(new DataManager).readAppData(appnavn,id("kodesett").value);if(e){var t=e.content;fuWebEditorInsert(editor,t);var n=t.split("\n")[0];n.indexOf(":fupy")>0&&setEditorMode("python"),n.indexOf(":fujs")>0&&setEditorMode("javascript"),n.indexOf(":fualgo")>0&&setEditorMode("python")}else alert("Fant ikke koden i nettlageret")}function nesteKode(){var e;(e=(new DataManager).getAppDataList(appnavn)).length>0?(kodesettIndeks+=1)>=e.length?(kodesettIndeks=0,id("kodesett").value=e[kodesettIndeks],hentKode()):(id("kodesett").value=e[kodesettIndeks],hentKode()):("FusionKurs"==appnavn&&alert("Ingen kode lagret på ditt nettlager"),"FusionProg"==appnavn&&skriv("Ingen kode lagret på ditt nettlager"))}function slettEditorkode(){var e=malFelles(id("fuw_spraak").selectedIndex);confirm(confTekst)&&fuWebEditorInsert(editor,e[0])}var confTekst="Koden i kodeeditoren din vil bli sletta. OK?";function kodemalTegning(){var e=malFelles(id("fuw_spraak").selectedIndex);confirm(confTekst)&&fuWebEditorInsert(editor,e[0]+'tegnBrukBakgrunn("white") \ntegnBrukXY(0,12,0,10)  \ntegnAkser()  \ntegnTittel("Tittel") \ntegnTekst("Se Funksjonene og kategoriene Tegning-*",2,4,"blue")  \n')}function kodemalGraftegner(){var e=id("fuw_spraak").selectedIndex,t=malFelles(e),n="graftegner(mittplot,-5,5,-5,25) # x1,x2,y1,y2\n";confirm(confTekst)&&(1==e?n='//\ngraftegner(mittplot,-5,5,-5,25); // x1,x2,y1,y2 \n// Modifiser algoritme etter eget behov\nfunction mittplot(){ \n\ttegnBrukBakgrunn("white");  \n\ttegnTittel("x*x - 3","green");  \n\ttegnGraf(f,"green");  \n}\nfunction f(x){ \n\treturn x*x-3; \n}\n':0==e?n='#\ngraftegner(mittplot,-5,5,-5,25) # x1,x2,y1,y2 \n# Modifiser algoritme etter eget behov\ndef mittplot(): \n\ttegnBrukBakgrunn("white")  \n\ttegnTittel("x*x - 3","green")\n\ttegnGraf(f,"green")\n\ndef f(x):\n\treturn x*x-3\n\n':2==e&&(n='#\ngraftegner(mittplot,-5,5,-5,25) # x1,x2,y1,y2 \n# Modifiser algoritme etter eget behov\nprosedyre mittplot(): \n\ttegnBrukBakgrunn("white")  \n\ttegnTittel("x*x - 3","green")\n\tegnGraf(f,"green")\n\nprosedyre f(x):\n\tretur x*x-3\n\n'),fuWebEditorInsert(editor,t[0]+n))}function malFelles(e){var t,n;return 1==e&&(t="// Fusion:fujs [Språk JavaScript - Koden kjøres i plattformen fulab.no ] \n",n="ace/mode/javascript",dialog.sistefil="fusionKode.fujs"),0==e&&(t="# Fusion:fupy [Språk Python - Koden kjøres i plattformen fulab.no ] \n",n="ace/mode/python",dialog.sistefil="fusionKode.fupy"),2==e&&(t="# Fusion:fualgo [Språk Algo - Koden kjøres i plattformen fulab.no ] \n",n="ace/mode/python",dialog.sistefil="fusionKode.fualgo"),[t,n]}function visListe(){var e=[];if((e=(new DataManager).getAppDataList(appnavn)).length>0){htmlMeldingSlett(),htmlMelding("Kode på lokalt nettlager:"),e=e.sort();for(var t=0;t<e.length;t++)"autosave"!=e[t]&&htmlMelding(e[t])}else"FusionKurs"==appnavn&&alert("Ingen kode lagret på ditt nettlager"),"FusionProg"==appnavn&&skriv("Ingen kode lagret på ditt nettlager")}function slettKodeNettlager(){var e=id("kodesett").value,t=new DataManager;bekreftboks("Sikker på at du vil slette koden med navn: "+e+"?")&&(t.removeAppData(appnavn,e),restart(),visListe())}function idSynlighet(e,t){document.getElementById(e)?"på"==t?(id(e).style.visibility="visible",id(e).style.display="inline"):(id(e).style.visibility="hidden",id(e).style.display="none"):console.log("ugyldig id",e)}function jsSynlighet(e){var t="kontainerViewer";"på"==e?(id(t).style.visibility="visible",id(t).style.display="inline"):(id(t).style.visibility="hidden",id(t).style.display="none")}function fusionSynlighet(e){var t="kontainerEditor";"på"==e?(id(t).style.visibility="visible",id(t).style.display="inline"):(id(t).style.visibility="hidden",id(t).style.display="none")}function konverter(){editor.session.getValue();var e=new PyJs,t=pyKode.split("\n");e.addFusionCode(t);var n=e.convertLanguage();viewer.session.setValue(n)}var kurshome="kodekurs/",kursNavn="",kursSpråk=".fupy",kursIndeks=-1,temaIndeks=-1,filIndeks=-1,temaNavn="",filEndret=!1,medTegning=!1,medDialog=!1;function visKurskatalog(){var e=[];e[0]="Velg";for(var t=0;t<kurskatalog.length;t++)dialog.debug&&console.log(kurskatalog[t].tittel),e[t+1]=kurskatalog[t].tittel;visSomValgliste("kursvelger",e)}function velgKurs(){dialog.debug&&console.log("Valgt kurs er",id("kursvelger").value),kursNavn=id("kursvelger").value,filEndret=!1,kursNavn.indexOf("tegning")>=0||kursNavn.indexOf("Tegning")>=0||kursNavn.indexOf("dialog")>=0?(visTegneflate(),tegnBrukBakgrunn("white"),htmlMeldingSlett(),htmlMelding('Klar for kurs "'+id("kursvelger").value+'"')):(idSynlighet("tegneflate","av"),idSynlighet("dialog","av"),idSynlighet("FusionDialog","av"),dialog.debug&&console.log("Skjuler tegneflata"));var e=["velge tema"];if((kursIndeks=id("kursvelger").selectedIndex-1)>=0){for(var t=0;t<kurskatalog[kursIndeks].temaliste.length;t++)e[t+1]=kurskatalog[kursIndeks].temaliste[t].tema;filIndeks=-1,temaIndeks=-1,visSomValgliste("temavelger",e),nesteKodesnutt(),medTegning=!1,medDialog=!1,"ja"==kurskatalog[kursIndeks].tegning&&(medTegning=!0),"ja"==kurskatalog[kursIndeks].dialog&&(medDialog=!0),idSynlighet("tegneflate","av"),idSynlighet("FusionDialog","av"),medTegning&&(idSynlighet("tegneflate","på"),tegnBrukBakgrunn()),medDialog&&(idSynlighet("dialog","på"),idSynlighet("FusionDialog","på")),kurskatalog[kursIndeks].forklaring}else visSomValgliste("temavelger",e),slettEditor(),temaIndeks=-1}function velgKursspråk(){kursSpråk=".fupy",0==id("kodespråk").selectedIndex&&(kursSpråk=".fupy"),1==id("kodespråk").selectedIndex&&(kursSpråk=".fujs"),2==id("kodespråk").selectedIndex&&(kursSpråk=".fualgo"),filIndeks>=0?(filIndeks-=1,temaIndeks-=1):(filIndeks=-1,temaIndeks=-1),nesteKodesnutt()}function velgKurstema(){dialog.debug&&console.log("Valgt kurstema er:",id("temavelger").value),temaIndeks=id("temavelger").selectedIndex-1,filEndret=!1,id("temavelger").selectedIndex>0?(temaIndeks=temaIndeks=id("temavelger").selectedIndex-1,filIndeks=temaIndeks,dialog.debug&&console.log("Kodefil:",kurskatalog[kursIndeks].temaliste[temaIndeks].fil),hentKodesnutt()):(slettEditor(),temaIndeks=-1)}function nesteKodesnutt(){if(kursIndeks<0)alert("Velg kategori først.");else{if((filIndeks+=1)==kurskatalog[kursIndeks].temaliste.length)return filIndeks-=1,void alert("Ikke flere kodesnutter i dette temaet.");hentKodesnutt(),id("temavelger").selectedIndex=filIndeks+1}}function forrigeKodesnutt(){kursIndeks<0?alert("Velg kurs først."):((filIndeks-=1)<=-1&&(filIndeks=0,alert("Dette er første kodesnutt i dette temaet.")),hentKodesnutt(),id("temavelger").selectedIndex=filIndeks+1)}function tilbakestillKodesnutt(){kursIndeks<0?alert("Velg kurs først."):(filIndeks=-1,nesteKodesnutt())}function hentKodesnutt(){filEndret=!1,id("brukMinKode").checked&&hentKodesnuttMin()||hentKodesnuttServer()}function hentKodesnuttServer(){var e=kurshome+kurskatalog[kursIndeks].mappe+"/"+kurskatalog[kursIndeks].temaliste[filIndeks].fil+kursSpråk;temaIndeks=filIndeks,sjekkFilServer(e)?(editor.session.setValue("#"),lesTekstfilServer(e,visKodesnutt)):(print("Finner ikke",e,"Filtype",kursSpråk),".fujs"==kursSpråk&&(e=e.replace(".fujs",".fupy"),print("Leser i stedet",e),sjekkFilServer(e)&&(editor.session.setValue("#"),lesTekstfilServer(e,konvertPy2Js))))}function konvertPy2Js(e){var t=new FusionJs;pyKode=e+"\n//end";var n=pyKode.split("\n");t.addFusionCode(n);var i=t.convertLanguage();editor.session.setValue(i),print("konvertPy2Js"),console.log(pyKode)}function hentKodesnuttMin(){var e=!1,t=new DataManager,n=kurskatalog[kursIndeks].mappe+"/"+kurskatalog[kursIndeks].temaliste[filIndeks].fil+kursSpråk,i=t.readAppData(appnavn,n);if(i){var a=i.content;fuWebEditorInsert(editor,a),e=!0}else;return e}function lagreKodesnuttMin(){var e=new DataManager;if(filEndret){var t={content:editor.session.getValue()},n=kurskatalog[kursIndeks].mappe+"/"+kurskatalog[kursIndeks].temaliste[filIndeks].fil+kursSpråk;e.writeAppData(appnavn,n,t),console.log("Lagrer kodesnutt:",n),filEndret=!1}}function lagreKodesnuttKurs(){if(filEndret){var e={content:editor.session.getValue()},t=new DataManager,n=kurskatalog[kursIndeks].mappe+"/"+kurskatalog[kursIndeks].temaliste[filIndeks].fil+kursSpråk;t.writeAppData(appnavn,n,e),dialog.debug&&console.log("Lagrer kodesnutt:",n),filEndret=!1}}function lagreKodesnuttIDE(){var e={content:editor.session.getValue()};(new DataManager).writeAppData(appnavn,id("kodesett").value,e)}function visKodesnutt(e){editor.session.setValue(e),fileEndret=!1}function visKodeStream(e){streamOldCode!=e&&(editor.session.setValue(e),streamOldCode=e)}function visKodeStream2(e){var t=editor.session.getValue().split("\n"),n=e.split("\n"),i=(n.length,!1);t.length!=n.length&&(i=!0);for(var a=0;a<t.length;a++){if(a>=n.length){i=!0;break}if(t[a]!=n[a]){a+1,i=!0;break}}i&&(editor.session.setValue(e),fileEndret=!1)}function visTemainfo(){-1==filIndeks?alert("Velg tema først. "):filIndeks>=0&&(""==kurskatalog[kursIndeks].mappe?alert("Sorry. Ingen info på dette temaet."):winPopup(kurshome+kurskatalog[kursIndeks].mappe+"/index.html"))}function winPopup(e,t=200,n=200,i=600,a=300,r="Kursinfo"){var o=(window.screenX||window.screenLeft||0)+(t||0),l=(window.screenY||window.screenTop||0)+(n||0);return window.open(e,r,"width="+i+" height="+a+" top="+l+",left="+o)}function visSomValgliste(e,t){for(var n="",i=0;i<t.length;i++)n+="<option id="+e+"_"+t[i]+">"+t[i]+"</option> ";id(e).innerHTML=n}function id(e){return document.getElementById(e)?document.getElementById(e):""}function finnesId(e){return!!document.getElementById(e)}var kopitavle="FusionCopyBoard";function lagreTilKopitavle(){var e={content:editor.session.getValue()};(new DataManager).writeAppData(kopitavle,"copyboard",e)}function hentFraKopitavle(){var e=dm.readAppData(kopitavle,"copyboard");if(e){var t=e.content;fuWebEditorInsert(editor,t)}else alert("Ingen kode å lime inn.")}function lagreKodesnuttFilIDE(){var e=editor.session.getValue(),t="fujs";e.indexOf("Fusion:fualgo")>0&&(t="fualgo"),e.indexOf("Fusion:fujs")>0&&(t="fujs"),e.indexOf("Fusion:fupy")>0&&(t="fupy");var n=new Blob([e],{type:"text/plain;charset=utf-8"}),i=prompt("Gi inn filnavn. Lagres i nedlastingsmappa di.","fusionKode."+t);i&&saveAs(n,i)}var wapp={},applets=[],editor;function urlSkole(e){return("localhost"==window.location.hostname?"http://localhost/fusion/":"https://fulab.no/")+"skolemappe/"+e+"/html/"}function urlApp(e,t){return urlSkole(e)+t+"/"}function viewCode(e,t="80%"){wapp.editorWidth=t,kodeId="viewCode_"+wapp.appnum,wapp.appnum++,viewApplet(kodeId,e,opt=6)}function viewConsole(e,t=550,n=350){kodeId="viewConsole_"+wapp.appnum,wapp.appnum++,viewApplet(kodeId,e,opt=7,t,n)}function viewFigure(e,t=550,n=350){kodeId="viewFigure_"+wapp.appnum,wapp.appnum++,viewApplet(kodeId,e,opt=1,t,n)}function viewRunner(e,t="90%",n=900,i=700,a=500){var r;r=(r=e.startsWith("http")?"url="+e:"url=../"+e)+"&&width="+i+"&&height="+a,kodeId="viewRunner_"+wapp.appnum,wapp.appnum++,viewFrame("fusionCoderun/indexIDE.html?"+r,t,n)}function viewFrame(e,t="90%",n=700){var i=document.createElement("iframe");kodeId="viewFrame_"+wapp.appnum,wapp.appnum++,i.id=kodeId+"iframe",i.className="appFrame",i.width=t,i.height=n,i.style.margin="auto",i.src=e,id(wapp.parent).appendChild(i)}function tryCode(e,t,n=550,i=350){viewApplet(e,t,opt=7,n,i)}function viewGraphics(e,t,n=550,i=350){viewApplet(e,t,opt=3,n,i)}function viewGraphicsWithDialog(e,t,n=550,i=350){viewApplet(e,t,opt=5,n,i)}function viewApplet(kodeId,fil,opt=1,canW="default",canH="default"){var etarea,ktarea;dialog.topp=wapp.parent,id("appBody")&&(wapp.parent="appBody");var applet={};function _createCanvas(){var e=document.createElement("div"),t=document.createElement("canvas");e.id=kodeId+"canvas_div",e.className="appCanvasFrame",t.id=kodeId+"canvas",t.className="appCanvas","default"==canW&&(t.width=wapp.cvWidth),"default"!=canW&&(t.width=canW),t.height=canH,"default"==canH&&(t.height=wapp.cvHeight),"default"!=canH&&(t.height=canH),t.style.margin="auto",t.style.cursor="crosshair",lagLinjeskift(1),id(wapp.parent).appendChild(e),e.appendChild(t),insertCode(fil,kodeId,!1),elOff(kodeId+"sc1"),elOff(kodeId+"sc2")}function _createEditor(){(etarea=document.createElement("textarea")).id=kodeId,etarea.cols=70,etarea.rows=wapp.minRows,etarea.style.margin=dialog.marg,id(wapp.parent).appendChild(etarea),applets[applets.length-1].edMode="textarea",applets[applets.length-1].edElement=etarea}function _createAceEditor(){var e=document.createElement("div");return e.id=kodeId+"acediv",e.className="appEditor",e.style.width=wapp.editWidth,id(wapp.parent).appendChild(e),(editor=createEditor(kodeId+"acediv","editor",wapp.editorLanguage)).resize(),applets[applets.length-1].edMode="ace",applets[applets.length-1].edElement=editor,e}function _createConsole(){(ktarea=document.createElement("textarea")).id=kodeId+"print",ktarea.rows=wapp.minRowsConsole,ktarea.className="appConsole",ktarea.style.margin=dialog.marg,id(wapp.parent).appendChild(ktarea)}function _linjeskift(e=1){for(var t=0;t<e;t++){var n=document.createElement("br");id(wapp.parent).appendChild(n)}}function _createDiv(e){var t;return(t=document.createElement("div")).id=e,id(wapp.parent).appendChild(t),t}function _btnTryCode(){lagKnapp(kodeId+"tc","Kjør",_runit),lagLinjeskift(1)}function _btnShowCode(){console.log("btnShowCode",kodeId),lagKnapp(kodeId+"vc","Vis kode",_showcode),lagKnapp(kodeId+"sc2","Skjul kode",_hidecode),lagLinjeskift(1)}function _createButton(e,t,n,i="auto"){var a=document.createElement("button");a.id=idNavn,a.innerHTML=t,a.style.margin=dialog.marg,a.style.width="udefinert"==i||"standard"==i?dialog.knappebredde:"auto"==i?"auto":i,a.style.height="auto",a.onclick=n,id(e).appendChild(a)}function _btnTryAgainCode(){console.log("btnTryAgainCode:"+kodeId+"tac"),lagLinjeskift(1),lagKnapp(kodeId+"tac","Oppdater",_showcode2),lagLinjeskift(1)}function _runit(){var editor,canvasId=kodeId+"canvas";konsollId=kodeId+"print",elGetId(canvasId)&&(elOn(canvasId),tegnBrukCanvas(canvasId),tegnBrukSynsfelt(.1,.9,.1,.9),tegnBrukBakgrunn("lightgrey")),elGetId(kodeId+"print")&&clearprint();for(var i=0;i<applets.length;i++)applets[i].appName==kodeId&&(editor=applets[i].edElement,console.log("Editor applet found",applets[i].appName));var fuKode=editor.session.getValue()+"\n//Fusion kode avsluttet",fuConv=new FusionJs,fuLines=fuKode.split("\n"),jsCode;fuConv.addFusionCode(fuLines),jsCode=fuConv.convertLanguage(),console.log("_runIt fra :",kodeId,"Output i konsoll:",konsollId),eval(jsCode)}function _hideit(){elOff(kodeId+"canvas"),elOff(kodeId+"print"),elOff(kodeId+"tac")}function _showcode(){console.log("showcode"),elOn(kodeId),elOn(kodeId+"print"),elOn(kodeId+"tac"),elOn(kodeId+"vc"),elOn(kodeId+"sc1"),elOn(kodeId+"sc2")}function _showcode2(){console.log("showcode2"),elOn(kodeId),elOn(kodeId+"print"),elOn(kodeId+"tac"),elOn(kodeId+"sc1"),elOn(kodeId+"sc2"),_runit()}function _hidecode(){console.log("hidecode"),elOff(kodeId),elOff(kodeId+"print"),elOff(kodeId+"tac"),elOff(kodeId+"sc1"),elOff(kodeId+"sc2")}applet.appName=kodeId,applet.fil=fil,applet.edMode="ace",applet.edElement="",applets.push(applet),1==opt?(_createAceEditor(),elOff(kodeId+"acediv"),_createCanvas(),_createConsole(),elOff(kodeId+"print"),insertCode(fil,kodeId,!0),elOff(kodeId+"sc1"),elOff(kodeId+"sc2"),ktarea.rows=wapp.minRowsConsole):2==opt?(_createAceEditor(),elOn(kodeId),applets[applets.length-1].edMode="ace",_linjeskift(),_btnTryCode(),_createCanvas(),elOff(kodeId+"canvas"),_createConsole(),elOff(kodeId+"print"),insertCode(fil,kodeId,!1),elOff(kodeId+"sc1"),elOff(kodeId+"sc2"),ktarea.rows=wapp.minRowsConsole):3==opt?(_createCanvas(),_linjeskift(),_btnShowCode(),_createEditor(),elOff(kodeId),insertCode(fil,kodeId,!0),_btnTryAgainCode(),elOff(kodeId+"tac"),elOff(kodeId+"sc1"),elOff(kodeId+"sc2")):4==opt?(_createAceEditor(),insertCode(fil,kodeId,!0),_createConsole(),ktarea.rows=wapp.minRowsConsole):5==opt?(_createDiv(kodeId+"dialog"),_createCanvas(),_createEditor(),elOff(kodeId),_createConsole(),elOff(kodeId+"print"),insertCode(fil,kodeId,!0),elOff(kodeId+"sc1"),elOff(kodeId+"sc2"),ktarea.rows=wapp.minRowsConsole,dialog.topp=kodeId+"dialog",insertCode(fil,kodeId,!0)):6==opt?(_createDiv(kodeId+"dialog"),_createAceEditor(),applets[applets.length-1].edMode="ace",insertCode(fil,kodeId,!1),elOn(kodeId),dialog.topp=kodeId+"dialog"):7==opt&&(_createDiv(kodeId+"dialog"),_createAceEditor(),_createConsole(),applets[applets.length-1].edMode="ace",insertCode(fil,kodeId,!0),dialog.topp=kodeId+"dialog",_btnTryCode())}function runCode(fil,editorId){elGetId(editorId+"canvas")&&(tegnBrukCanvas(editorId+"canvas"),tegnBrukSynsfelt(.1,.9,.1,.9),tegnBrukBakgrunn("lightgrey")),konsollId=editorId+"print",elGetId(konsollId)&&clearprint();var fuKode=fil+"\n//Fusion kode avsluttet",fuConv=new FusionJs,fuLines=fuKode.split("\n");fuConv.addFusionCode(fuLines);var jsCode=fuConv.convertLanguage(),loaded=fuConv.loadLibs();eval(jsCode)}function insertCode(e,t,n=!1){var i=new XMLHttpRequest;i.onreadystatechange=function(){var a;if(4===i.readyState&&200===i.status){a=i.responseText;for(var r=!1,o=0;o<applets.length;o++)applets[o].appName==t&&"ace"==applets[o].edMode&&(r=!0,editor=applets[o].edElement);if(r){var l=a.split("\n");rows=l.length,rows<wapp.minRows&&(rows=wapp.minRows),rows>wapp.maxRows&&(rows=wapp.maxRows),aceAtt.maxLines=rows,aceAtt.minLines=10,setAceOption(editor),setEditorMode("python"),editor.session.setValue(a),editor.resize()}else if(elGetId(t)){elGetId(t).value=a;for(var s,l=a.split("\n"),g=25,d=0;d<l.length;d++)l[d].length>g&&(g=l[d].length+2);s=g,rows=l.length,rows<wapp.minRows&&(rows=wapp.minRows),rows>wapp.maxRows&&(rows=wapp.maxRows),document.getElementById(t).rows=rows,document.getElementById(t).cols=s}else console.log("Id er ukjent:"+t);elGetId(t+"print")&&(elGetId(t+"print").rows=wapp.minRowsConsole),n&&runCode(a,t)}else 4===i.readyState&&404===i.status&&alert("Finner ikke "+e)};var a="?rand="+Math.floor(10001*Math.random());i.open("GET",e+a,!0),404===i.status&&print("Fant ikke filen."),i.send()}function elOn(e){elGetId(e)&&(elGetId(e).style.visibility="visible"),elGetId(e)&&(elGetId(e).style.display="inline")}function elOff(e){elGetId(e)&&(elGetId(e).style.visibility="hidden"),elGetId(e)&&(elGetId(e).style.display="none")}function elGetId(e){return document.getElementById(e)}wapp.appnum=1,wapp.parent="appBody",wapp.minRows=5,wapp.maxRows=100,wapp.minRowsConsole=5,wapp.cvWidth=700,wapp.cvHeight=500,wapp.editorWidth="80%",wapp.editorLanguage="python",dialog.topp=wapp.parent;var konsollId="meldinger";function print(){for(var e="",t=0;t<arguments.length;t++)e=e+" "+arguments[t];htmlMelding(e)}function clearprint(){htmlMeldingSlett()}function htmlMelding(e){var t;document.getElementById(konsollId)?(t=document.getElementById(konsollId).value).length<2?(document.getElementById(konsollId).value=e+"\n",elOn(konsollId)):(document.getElementById(konsollId).value=t+e+"\n",elOn(konsollId)):console.log("Print til konsoll: "+e)}function htmlMeldingSlett(){document.getElementById(konsollId)&&(document.getElementById(konsollId).value="")}